{"version":3,"file":"6402.a5d1b40b.js","mappings":"+PAkBMA,EAEF,SAAC,G,IAAEC,EAAQ,WAAEC,EAAc,iBAAEC,EAAK,QAAEC,EAAS,YACvCC,GAAM,IAAAC,kBAAgB,EACxBC,GAAO,IAAAC,WAESC,IAClB,IAAAC,cAAe,CAAEC,IAAK,KAAI,gBACtBC,IAAa,IAAAC,aAAc,IAAE,SAE/B,GAA4B,IAAAC,WAAkB,GAA7CC,EAAS,KAAEC,EAAY,KAExBC,EAAoB,WACxBb,KAwDF,OACE,kBAAC,KAAW,CACVc,aAAa,EACbD,kBAAmBA,EACnBd,MAAOA,EACPgB,mBAAoB,CAClBC,QAAS,WAAM,OA3DQ,SAC3BlB,GAAkD,uD,iFAGlD,QAAyBmB,KADnBC,EAAmBpB,MAAAA,OAAc,EAAdA,EAAgBqB,IAEvC,MAAM,IAAIC,MAAM,kCAEE,SAAMjB,MAAAA,OAAI,EAAJA,EAAMI,IAAIc,Y,YAA9BC,EAAc,UAChB,YACIC,EAAc,IAAI,EAAAC,YACtB,IAAI,EAAAC,cAAc,CAChBH,YAAW,EACXjB,SAAQ,KAGZO,GAAa,G,iBAGX,O,sBAAA,GAAMW,EACHG,yBAAyBR,GACzBS,MAAK,WACJd,IACAD,GAAa,GACbJ,GACEA,EAAS,CACPT,MAAOE,EACL,sDACA,CACE2B,KAAM9B,MAAAA,OAAc,EAAdA,EAAgB8B,OAG1BC,QAAS,EAAAC,aAAA,UAEbjC,GAAYA,Q,cAfhB,S,+BAkBIkC,OAAM,GACN,QAAkB,KACpBA,EAAuB,QAAd,IAAMC,gBAAQ,eAAEC,KAAKF,QAGhClB,IACAD,GAAa,GACbJ,GACEA,EAAS,CACPT,MAAOE,EAAE,+BACT4B,QAAS,EAAAC,aAAA,OACTI,YAAaH,I,8BAYFI,CAAqBrC,IACpCsC,MAAO,SACPzB,UAAS,IAGX,2BACE,2BAAIb,MAAAA,OAAc,EAAdA,EAAgB8B,M,IAAW3B,EAAE,qCAOzC","sources":["webpack://kas-ui/./src/app/modules/ServiceAccounts/dialogs/DeleteServiceAccount/DeleteServiceAccount.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { AlertVariant } from '@patternfly/react-core';\nimport { DeleteModal } from '@app/common';\nimport { isServiceApiError } from '@app/utils';\nimport {\n  Configuration,\n  SecurityApi,\n  ServiceAccountListItem,\n} from '@rhoas/kafka-management-sdk';\nimport {\n  BaseModalProps,\n  DeleteServiceAccountProps,\n  useAlert,\n  useAuth,\n  useConfig,\n} from '@rhoas/app-services-ui-shared';\n\nconst DeleteServiceAccount: React.FunctionComponent<\n  DeleteServiceAccountProps & BaseModalProps\n> = ({ onDelete, serviceAccount, title, hideModal }) => {\n  const { t } = useTranslation();\n  const auth = useAuth();\n  const {\n    kas: { apiBasePath: basePath },\n  } = useConfig() || { kas: {} };\n  const { addAlert } = useAlert() || {};\n\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n\n  const handleModalToggle = () => {\n    hideModal();\n  };\n\n  const deleteServiceAccount = async (\n    serviceAccount: ServiceAccountListItem | undefined\n  ) => {\n    const serviceAccountId = serviceAccount?.id;\n    if (serviceAccountId === undefined) {\n      throw new Error('service account id not defined');\n    }\n    const accessToken = await auth?.kas.getToken();\n    if (accessToken) {\n      const apisService = new SecurityApi(\n        new Configuration({\n          accessToken,\n          basePath,\n        })\n      );\n      setIsLoading(true);\n\n      try {\n        await apisService\n          .deleteServiceAccountById(serviceAccountId)\n          .then(() => {\n            handleModalToggle();\n            setIsLoading(false);\n            addAlert &&\n              addAlert({\n                title: t(\n                  'serviceAccount.service_account_successfully_deleted',\n                  {\n                    name: serviceAccount?.name,\n                  }\n                ),\n                variant: AlertVariant.success,\n              });\n            onDelete && onDelete();\n          });\n      } catch (error) {\n        let reason: string | undefined;\n        if (isServiceApiError(error)) {\n          reason = error.response?.data.reason;\n        }\n\n        handleModalToggle();\n        setIsLoading(false);\n        addAlert &&\n          addAlert({\n            title: t('common.something_went_wrong'),\n            variant: AlertVariant.danger,\n            description: reason,\n          });\n      }\n    }\n  };\n\n  return (\n    <DeleteModal\n      isModalOpen={true}\n      handleModalToggle={handleModalToggle}\n      title={title}\n      confirmButtonProps={{\n        onClick: () => deleteServiceAccount(serviceAccount),\n        label: 'Delete',\n        isLoading,\n      }}\n    >\n      <p>\n        <b>{serviceAccount?.name}</b> {t('serviceAccount.will_be_deleted')}\n      </p>\n    </DeleteModal>\n  );\n};\n\nexport { DeleteServiceAccount };\nexport default DeleteServiceAccount;\n"],"names":["DeleteServiceAccount","onDelete","serviceAccount","title","hideModal","t","useTranslation","auth","useAuth","basePath","useConfig","kas","addAlert","useAlert","useState","isLoading","setIsLoading","handleModalToggle","isModalOpen","confirmButtonProps","onClick","undefined","serviceAccountId","id","Error","getToken","accessToken","apisService","SecurityApi","Configuration","deleteServiceAccountById","then","name","variant","AlertVariant","reason","response","data","description","deleteServiceAccount","label"],"sourceRoot":""}