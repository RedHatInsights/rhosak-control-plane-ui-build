"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[1540],{51540:(e,t,n)=>{n.d(t,{L:()=>b});var a=n(70655),i=n(75418),r=n.n(i),o=n(98068),s=n(11593),l=n(56176),u=n.n(l),c=n(86369),d=n.n(c),v=n(84669),f=n(92550);function g(e,t){var n=(0,i.useRef)();(0,i.useEffect)((function(){n.current=e}),[e]),(0,i.useEffect)((function(){if(null!==t){var e=setTimeout((function(){n.current()}),t);return function(){clearInterval(e)}}}),[e,t])}var m=n(75381);function h(){return!document[(e=document,void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":"")];var e}function p(){var e=(0,i.useState)(h()),t=e[0],n=e[1],a=function(){return n(h())};return(0,i.useEffect)((function(){var e,t=void 0!==(e=document).hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":"";return document.addEventListener(t,a,!1),function(){document.removeEventListener(t,a)}}),[]),{isVisible:t,setIsVisible:n}}var _=n(54950),k=n(365),E=n(55277),S=n(95216),w=n(5569),P=n(13449),b=function(e){var t=e.preCreateInstance,n=e.tokenEndPointUrl;d().extend(u());var l=((0,P.S)()||{}).shouldOpenCreateModal,c=(0,S.useAuth)(),h=(((0,S.useConfig)()||{}).kas||{}).apiBasePath,b=p().isVisible,y=(0,o.useLocation)(),C=new URLSearchParams(y.search),I=(0,f.h0)()||{},T=I.page,D=void 0===T?1:T,V=I.perPage,O=void 0===V?10:V,A=C.has("user-testing"),N=(0,s.useTranslation)().t,R=((0,S.useAlert)()||{}).addAlert,x=(0,f.QK)().showModal,B=window.localStorage,L=r().useContext(_.QuickStartContext),U=(0,i.useState)(),F=U[0],K=U[1],H=(0,i.useState)({}),M=H[0],G=H[1],Q=(0,i.useState)([]),j=Q[0],q=Q[1],z=(0,i.useState)(!1),Z=z[0],W=z[1],Y=(0,i.useState)("created_at desc"),J=Y[0],X=Y[1],$=(0,i.useState)(),ee=$[0],te=$[1],ne=(0,i.useState)(0),ae=ne[0],ie=ne[1],re=(0,i.useState)(void 0),oe=re[0],se=re[1],le=(0,i.useState)("name"),ue=le[0],ce=le[1],de=(0,i.useState)([]),ve=de[0],fe=de[1],ge=(0,i.useState)(!1),me=ge[0],he=ge[1],pe=(0,i.useState)(!1),_e=pe[0],ke=pe[1],Ee=(0,i.useState)(!1),Se=Ee[0],we=Ee[1],Pe=(0,i.useState)(void 0),be=Pe[0],ye=Pe[1],Ce=(0,i.useState)(),Ie=Ce[0],Te=Ce[1],De=ee||{},Ve=De.activeTab,Oe=De.instanceDetail,Ae=null==Ie?void 0:Ie.some((function(e){return(null==e?void 0:e.instance_type)===(null===m.ik||void 0===m.ik?void 0:m.ik.eval)}));(0,i.useEffect)((function(){if((0,m.Qw)()&&B){var e=parseInt(B.getItem("openSessions")||"0"),t=e+1;e<1&&(B.setItem("openSessions",""+t),ke(!0))}}),[]);var Ne=function(){ke(!_e)};(0,i.useEffect)((function(){(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return(t=l)?[4,l()]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return(e=t)&&(null==j?void 0:j.length)<1&&Ke(),e&&(null==j?void 0:j.length)>0&&Re(),[2]}}))}))}),[l,j]);var Re=function(){x(f.Ng.CREATE_KAFKA_INSTANCE,{onCreate:Me,cloudProviders:j,mainToggle:A,refresh:He,hasUserTrialKafka:Ae})},xe=function(e){te({instanceDetail:e,activeTab:"Details"})},Be=function(e){te({instanceDetail:e,activeTab:"Connection"})},Le=function(e){var t,n,a,i,r;(0,m.G6)(e)&&(i=null===(t=e.response)||void 0===t?void 0:t.data.reason,r=null===(a=null===(n=e.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.code),r===m.SM.UNAUTHORIZED_USER?he(!0):R&&R({variant:v.AlertVariant.danger,title:N("common.something_went_wrong"),description:i})},Ue=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return i=[],ve.forEach((function(e){var t=e.filterKey,n=e.filterValue;if(n&&n.length>0){var a="(";a+=n.map((function(e){var n=e.value.trim();return n===m.Od.PROVISIONING?t+" = "+m.Od.PREPARING+" or "+t+" = "+m.Od.PROVISIONING:n===m.Od.DEPROVISION?t+" = "+m.Od.DEPROVISION+" or "+t+" = "+m.Od.DELETED:""!==n?t+" "+(!0===e.isExact?"= "+n:"like %"+n+"%"):""})).join(" or "),a+=")",i.push(a)}})),e=i.join(" and "),[4,null==c?void 0:c.kas.getToken()];case 1:if(!(t=a.sent())||!b)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new E.DefaultApi(new E.Configuration({accessToken:t,basePath:h})).getKafkas(null==D?void 0:D.toString(),null==O?void 0:O.toString(),J,e).then((function(e){var t=e.data,n=(null==t?void 0:t.items)||[];G(t),K(n),void 0!==(null==M?void 0:M.total)&&M.total>ae&&ie(M.total),Se&&ve.length<1&&0==(null==n?void 0:n.length)&&(se(!0),we(!1)),W(!0)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Le(n),[3,5];case 5:return[2]}var i}))}))};(0,i.useEffect)((function(){(!F||(null==F?void 0:F.length)<=1)&&(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==c?void 0:c.kas.getToken()];case 1:if(!(e=n.sent())||!b)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new E.DefaultApi(new E.Configuration({accessToken:e,basePath:h})).getKafkas("1","1").then((function(e){var t,n,a=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||void 0===n?void 0:n.length;se(!a||a<1)}))];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),Le(t),[3,5];case 5:return[2]}}))}))}),[F]);var Fe=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==c?void 0:c.kas.getToken()];case 1:if(e=a.sent(),t="owner = "+be,!e||!b)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new E.DefaultApi(new E.Configuration({accessToken:e,basePath:h})).getKafkas("","","",t).then((function(e){var t=e.data;Te(t.items)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Le(n),[3,5];case 5:return[2]}}))}))};(0,i.useEffect)((function(){be&&Fe()}),[be]),g((function(){return Fe()}),m.md);var Ke=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==c?void 0:c.kas.getToken()];case 1:if(!(e=a.sent()))return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new E.DefaultApi(new E.Configuration({accessToken:e,basePath:h})).getCloudProviders().then((function(e){var t,n=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||[],a=null==n?void 0:n.filter((function(e){return e.enabled}));q(a)}))];case 3:return a.sent(),[3,5];case 4:return t=a.sent(),n=void 0,(0,m.G6)(t)&&(n=null===(i=t.response)||void 0===i?void 0:i.data.reason),R&&R({variant:v.AlertVariant.danger,title:N("common.something_went_wrong"),description:n}),[3,5];case 5:return[2]}}))}))};(0,i.useEffect)((function(){W(!1),Ue()}),[c,D,O,ve,J]),(0,i.useEffect)((function(){Ke(),Ue()}),[]),(0,i.useEffect)((function(){!function(){if(F&&(null==F?void 0:F.length)>0){var e=null==F?void 0:F.filter((function(e){var t;return(null==e?void 0:e.id)===(null===(t=null==ee?void 0:ee.instanceDetail)||void 0===t?void 0:t.id)}))[0],t=(0,a.__assign)((0,a.__assign)({},ee),{instanceDetail:e});e&&te(t)}}()}),[F]),(0,i.useEffect)((function(){null==c||c.getUsername().then((function(e){return ye(e)}))}),[c]),g((function(){return Ue()}),m.md);var He=function(){F&&1===(null==F?void 0:F.length)?W(!0):W(!1),Ue()},Me=function(){ie(M.total+1)},Ge=function(){W(!1),ie(M.total-1)};if(me)return r().createElement(v.PageSection,{variant:v.PageSectionVariants.default,padding:{default:"noPadding"},isFilled:!0},r().createElement(f.C0,{titleProps:{title:N("access_permissions_needed"),headingLevel:"h2"},emptyStateIconProps:{icon:w.ZP},emptyStateBodyProps:{body:N("to_access_kafka_instances_contact_your_organization_administrators")}}));return r().createElement(r().Fragment,null,r().createElement(k.oY,{mainToggle:A,isExpanded:null!=ee,activeTab:Ve,isLoading:void 0===Oe,instanceDetail:Oe,onClose:function(){te(null)},"data-ouia-app-id":"controlPlane-streams",tokenEndPointUrl:n,notRequiredDrawerContentBackground:oe},r().createElement("main",{className:"pf-c-page__main"},r().createElement(v.PageSection,{variant:v.PageSectionVariants.light},r().createElement(v.Level,null,r().createElement(v.LevelItem,null,r().createElement(v.TextContent,null,r().createElement(v.Text,{component:"h1"},N("kafka_instances")))))),void 0===F?r().createElement(v.PageSection,{variant:v.PageSectionVariants.light,padding:{default:"noPadding"}},r().createElement(f.yR,null)):oe?r().createElement(v.PageSection,{padding:{default:"noPadding"},isFilled:!0},r().createElement(f.C0,{emptyStateProps:{variant:f.jU.NoItems},emptyStateBodyProps:{body:r().createElement(r().Fragment,null,N("create_a_kafka_instance_to_get_started")," ",r().createElement(v.Button,{variant:v.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:function(){return L.setActiveQuickStart&&L.setActiveQuickStart("getting-started")}},"quick start guide."))},titleProps:{title:N("no_kafka_instances_yet")}},r().createElement(v.Button,{"data-testid":"emptyStateStreams-buttonCreateKafka",variant:v.ButtonVariant.primary,onClick:function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return t?[4,t(!0)]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return e&&Re(),[2]}}))}))}},N("create_kafka_instance"))),")"):F&&void 0!==oe?r().createElement(v.PageSection,{className:"mk--main-page__page-section--table pf-m-padding-on-xl",variant:v.PageSectionVariants.default,padding:{default:"noPadding"}},r().createElement(v.Card,null,r().createElement(k.fw,{kafkaInstanceItems:F,mainToggle:A,onViewConnection:Be,onViewInstance:xe,refresh:He,kafkaDataLoaded:Z,setWaitingForDelete:we,onDelete:Ge,page:D,perPage:O,total:null==M?void 0:M.total,expectedTotal:ae,filteredValue:ve,setFilteredValue:fe,setFilterSelected:ce,filterSelected:ue,orderBy:J,setOrderBy:X,isDrawerOpen:null!==ee,loggedInUser:be,currentUserkafkas:Ie,onCreate:Me,cloudProviders:j}))):r().createElement(r().Fragment,null))),r().createElement(v.Modal,{variant:v.ModalVariant.small,title:"Mobile experience",isOpen:_e,onClose:function(){return Ne()},actions:[r().createElement(v.Button,{key:"confirm",variant:"primary",onClick:function(){return Ne()}},"Ok")]},"The mobile experience isn't fully optimized yet, so some items might not appear correctly."))}}}]);
//# sourceMappingURL=1540.8e46eb7c.js.map