"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[9861],{89861:(e,t,a)=>{a.r(t),a.d(t,{AlertProvider:()=>c,AppServicesAlertToastGroup:()=>o,AppServicesDrawer:()=>u,AppServicesLoading:()=>d,AppServicesPagination:()=>f,AppServicesTable:()=>T,AppServicesToolbar:()=>k,Metrics:()=>Fe,MetricsI18n:()=>C,ModalProvider:()=>h});var n=a(75418),i=a.n(n),r=a(70655),s=a(84669);const o=({alerts:e,onCloseAlert:t})=>i().createElement(s.AlertGroup,{isToast:!0},e.map((e=>{var{id:a,variant:n,title:o,description:l,dataTestId:c}=e,u=(0,r.__rest)(e,["id","variant","title","description","dataTestId"]);return i().createElement(s.Alert,Object.assign({key:a,isLiveRegion:!0,variant:s.AlertVariant[n],variantLabel:"",title:o,actionClose:i().createElement(s.AlertActionCloseButton,{title:o,onClose:()=>t(a)}),"data-testid":c},u),l)})));var l=a(46332);const c=({children:e})=>{const[t,a]=(0,n.useState)([]),[r,s]=(0,n.useState)([]);(0,n.useEffect)((()=>{const e=r.map((e=>e.key)),a=t.filter((t=>!e.includes(null==t?void 0:t.id))).map((e=>{const{id:t=""}=e,a=setTimeout((()=>c(t)),8e3);return{key:e.id,timeOut:a}}));return s([...r,...a]),()=>r.forEach((e=>(null==e?void 0:e.timeOut)&&clearTimeout(e.timeOut)))}),[t]);const c=e=>{a((t=>[...t.filter((t=>t.id!==e))])),s((t=>[...t.filter((t=>t.key===e))]))};return i().createElement(l.AlertContext.Provider,{value:{addAlert:e=>{const n=(new Date).getTime().toString();a([...t,Object.assign(Object.assign({},e),{id:n})])}}},i().createElement(o,{alerts:t,onCloseAlert:c}),e)},u=({onClose:e,isLoading:t=!1,drawerPanelContentProps:a,drawerHeaderProps:n,isExpanded:o,children:l,panelBodyContent:c,onExpand:u,notRequiredDrawerContentBackground:p,"data-ouia-app-id":m,inlineAlertMessage:h})=>{const g=a||{},{widths:f}=g,y=(0,r.__rest)(g,["widths"]),{text:E,title:v}=n||{},b=i().createElement(s.DrawerPanelContent,Object.assign({widths:f||{default:"width_50"}},y),t?i().createElement(d,null):i().createElement(i().Fragment,null,i().createElement(s.DrawerHead,null,i().createElement(s.TextContent,null,(null==E?void 0:E.label)&&i().createElement(s.Text,{component:(null==E?void 0:E.component)||s.TextVariants.small,className:(null==E?void 0:E.className)||"kafka-ui-appServices-drawer__top-label"},null==E?void 0:E.label),(null==v?void 0:v.value)&&i().createElement(s.Title,{headingLevel:(null==v?void 0:v.headingLevel)||"h2",size:(null==v?void 0:v.size)||s.TitleSizes.xl,className:(null==v?void 0:v.className)||"kafka-ui-appServices-drawer__title"},null==v?void 0:v.value)),i().createElement(s.DrawerActions,null,i().createElement(s.DrawerCloseButton,{onClick:e}))),i().createElement(s.DrawerPanelBody,null,h,c)));return i().createElement(s.Drawer,{isExpanded:o,onExpand:u,"data-ouia-app-id":m},i().createElement(s.DrawerContent,{panelContent:b,className:p?"pf-m-no-background":""},i().createElement(s.DrawerContentBody,{className:"kafka-ui-appServices-drawer__drawer-content-body"},l)))},d=({bullseyeProps:e,spinnerProps:t})=>i().createElement(s.Bullseye,Object.assign({},e),i().createElement(s.Spinner,Object.assign({},t))),p=({variant:e,hideModal:t,title:a})=>n.createElement(s.Modal,{id:"fallback-modal",variant:e,isOpen:!0,"aria-label":"fallback modal",showClose:!0,"aria-describedby":"modal-message",onClose:t,title:a,children:n.createElement(d,{bullseyeProps:{className:"pf-u-p-xl"}})}),m=({activeModal:e,hideModal:t,modalRegistry:a})=>{if(void 0===e)return n.createElement(n.Fragment,null);const i=a.current[e.modalType],r=i.lazyComponent;return n.createElement(n.Suspense,{fallback:n.createElement(p,{hideModal:t,variant:i.variant,title:i.title})},n.createElement(r,Object.assign({hideModal:t,title:i.title,variant:i.variant},e.modalProps)))},h=({children:e})=>{const[t,a]=(0,n.useState)(),i=(0,n.useRef)({}),r={registerModals:e=>{i.current=Object.assign(Object.assign({},i),e)},hideModal:()=>{a(void 0)},showModal:(e,t)=>{a({modalType:e,modalProps:t})}};return n.createElement(n.Fragment,null,n.createElement(m,{activeModal:t,hideModal:r.hideModal,modalRegistry:i}),n.createElement(l.ModalContext.Provider,{value:r},e))};var g=a(98068);const f=e=>{var{page:t,perPage:a=10,itemCount:o,variant:l=s.PaginationVariant.top,isCompact:c,titles:u}=e,d=(0,r.__rest)(e,["page","perPage","itemCount","variant","isCompact","titles"]);const p=(0,g.useHistory)(),m=(0,g.useLocation)(),h=new URLSearchParams(m.search),f=(0,n.useCallback)(((e,t)=>{h.set(e,t.toString())}),[h]),y=(0,n.useCallback)(((e,t)=>{f("page",t.toString()),p.push({search:h.toString()})}),[f,p,h]),E=(0,n.useCallback)(((e,t)=>{f("page","1"),f("perPage",t.toString()),p.push({search:h.toString()})}),[f,p,h]);return i().createElement(s.Pagination,Object.assign({itemCount:o,perPage:a,page:t,onSetPage:y,variant:l,onPerPageSelect:E,isCompact:c},d,{titles:u}))};var y=a(27577),E=a(52530);const v=(0,n.createContext)({activeRow:"",onRowClick:()=>"",loggedInUser:""}),b=v.Provider,_=e=>{const{activeRow:t,onRowClick:a,rowDataTestId:s}=(0,n.useContext)(v),o=e||{},{trRef:l,className:c,rowProps:u,row:d}=o,p=(0,r.__rest)(o,["trRef","className","rowProps","row"]),{rowIndex:m}=u||{rowIndex:1},{isExpanded:h,originalData:g}=d||{};return i().createElement("tr",Object.assign({"data-testid":s,tabIndex:0,ref:l,className:(0,E.css)(c,"pf-c-table-row__item",t&&t===(null==g?void 0:g.rowId)&&"pf-m-selected pf-m-selectable"),hidden:void 0!==h&&!h,onClick:e=>a&&a(e,m,d)},p))},T=({tableProps:e,tableHeaderProps:t,tableBodyProps:a,children:n,activeRow:s,onRowClick:o,rowDataTestId:l,loggedInUser:c})=>{const{cells:u,rows:d,actionResolver:p,onSort:m,sortBy:h,"aria-label":g,variant:f,className:v,shouldDefaultCustomRowWrapper:T=!1}=e,k=(0,r.__rest)(e,["cells","rows","actionResolver","onSort","sortBy","aria-label","variant","className","shouldDefaultCustomRowWrapper"]);return i().createElement(b,{value:{activeRow:s,onRowClick:o,rowDataTestId:l,loggedInUser:c}},i().createElement(y.Table,Object.assign({className:(0,E.css)(T&&"appServices--table-view__table",v),cells:u,variant:f,rows:d,"aria-label":g,actionResolver:p,onSort:m,sortBy:h,rowWrapper:T?e=>i().createElement(_,Object.assign({},e)):void 0},k),i().createElement(y.TableHeader,Object.assign({},t)),i().createElement(y.TableBody,Object.assign({},a)),n))},k=({toolbarProps:e,toggleGroupProps:t,toolbarItems:a,toggleGroupItems:n})=>{const{id:o,clearAllFilters:l,collapseListedFiltersBreakpoint:c="md",inset:u}=e,d=(0,r.__rest)(e,["id","clearAllFilters","collapseListedFiltersBreakpoint","inset"]);return i().createElement(i().Fragment,null,i().createElement(s.Toolbar,Object.assign({id:o,clearAllFilters:l,inset:u,collapseListedFiltersBreakpoint:c},d),i().createElement(s.ToolbarContent,null,t&&i().createElement(s.ToolbarToggleGroup,Object.assign({},t),n),null==a?void 0:a.map(((e,t)=>{const{key:a="appServices",variant:n,className:o,id:l,alignment:c,item:u}=e,d=(0,r.__rest)(e,["key","variant","className","id","alignment","item"]);return i().createElement(s.ToolbarItem,Object.assign({key:`${a}-${t}`,variant:n,className:o,id:l,alignment:c},d),u)})))))},C=JSON.parse('{"metrics":{"used_disk_space":"Used disk space","used_disk_space_popover_header":"Used disk space chart","used_disk_space_help_text":"Used disk space is the amount of disk space used by the Kafka broker in the instance. This metric enables you to assess available disk space relative to the limit. To reduce used disk space, you can adjust topic retention time or other topic properties as needed.","connection_attempt_rate":"Connection attempt rate","connection_attempt_rate_help_text":"Connection attempt rate is the number of attempted client connections per second for the Kafka instance over time. This metric enables you to review client activity spikes in the instance and to assess available connections per second relative to the limit.","log_size_per_partition":"Log size per partition","log_size_per_partition_help_text":"Topic partition size is the log size for each partition in a selected topic. This metric enables you to assess the amount of data used in one or more topic partitions. To reduce the topic partition size, you can decrease the retention time or the retention size, or modify the cleanup policy as needed. You can also increase the number of partitions for the topic.","incoming_bytes_per_topic":"Incoming bytes per topic","outgoing_bytes_per_topic":"Outgoing bytes per topic","total_bytes":"Total bytes","kafka_instance_metrics":"Kafka instance metrics","topic_partition_size":"Topic partition size","topic_metrics":"Topic metrics","total_bytes_popover_header":"Bytes incoming and outgoing chart","topic_metrics_help_text":"Bytes incoming and outgoing are the total bytes for all topics or total bytes for a selected topic in the Kafka instance. This metric enables you to assess data transfer in and out of your Kafka instance. To modify incoming and outgoing bytes, you can adjust topic message size or other topic properties as needed.","topic_partition_size_popover_header":"Topic partition size chart","topic_partition_size_help_text":"Topic partition size is the log size for each partition in a selected topic. This metric enables you to assess the amount of data used in one or more topic partitions. To reduce the topic partition size, you can decrease the retention time or the retention size, or modify the cleanup policy as needed. You can also increase the number of partitions for the topic.","empty_state_no_data_body":"Weâ€™re setting up your monitoring instance. Your metrics will appear shortly.","empty_state_no_data_title":"No metrics data","empty_state_no_topic_data_body":"Adjust your filters and try again.","empty_state_no_topic_data_title":"No topic data","empty_state_no_topics_body":"Data will appear shortly after you start using topics.","empty_state_no_topics_title":"No topic data","empty_state_no_topics_create_topic":"Create topic","empty_state_no_filter_body":"In the filter dropdown select a topic to see log size per topic partition.","empty_state_no_filter_title":"Filter by Topic"}}');var D=a(55795);const w=({title:e,description:t})=>i().createElement(s.Popover,{"aria-label":"Basic popover",headerContent:i().createElement("div",null,e),bodyContent:i().createElement("div",null,t)},i().createElement(D.ZP,null)),S=()=>i().createElement(s.EmptyState,{variant:s.EmptyStateVariant.xs},i().createElement(s.EmptyStateBody,null,i().createElement(d,null)));var L=a(70251),M=a(31521);const x=()=>{const{t:e}=(0,M.useTranslation)();return i().createElement(s.EmptyState,{variant:s.EmptyStateVariant.xs},i().createElement(s.EmptyStateIcon,{icon:L.TachometerAltIcon}),i().createElement(s.Title,{headingLevel:"h3",size:"lg"},e("metrics.empty_state_no_data_title")),i().createElement(s.EmptyStateBody,null,e("metrics.empty_state_no_data_body")))},F=()=>{const{t:e}=(0,M.useTranslation)();return i().createElement(s.EmptyState,{variant:s.EmptyStateVariant.xs},i().createElement(s.EmptyStateIcon,{icon:L.SearchIcon}),i().createElement(s.Title,{headingLevel:"h3",size:"lg"},e("metrics.empty_state_no_topic_data_title")),i().createElement(s.EmptyStateBody,null,e("metrics.empty_state_no_topic_data_body")))},R=({onCreateTopic:e})=>{const{t}=(0,M.useTranslation)();return i().createElement(s.EmptyState,{variant:s.EmptyStateVariant.xs},i().createElement(s.EmptyStateIcon,{icon:L.WrenchIcon}),i().createElement(s.Title,{headingLevel:"h3",size:"lg"},t("metrics.empty_state_no_topics_title")),i().createElement(s.EmptyStateBody,null,t("metrics.empty_state_no_topics_body")),i().createElement(s.Button,{variant:"primary",onClick:e},t("metrics.empty_state_no_topics_create_topic")))},P=()=>{const{t:e}=(0,M.useTranslation)();return i().createElement(s.EmptyState,{variant:s.EmptyStateVariant.xs},i().createElement(s.EmptyStateIcon,{icon:L.FilterIcon}),i().createElement(s.Title,{headingLevel:"h3",size:"lg"},e("metrics.empty_state_no_filter_title")),i().createElement(s.EmptyStateBody,null,e("metrics.empty_state_no_filter_body")))};var A;!function(e){e[e.Last5minutes=5]="Last5minutes",e[e.Last15minutes=15]="Last15minutes",e[e.Last30minutes=30]="Last30minutes",e[e.Last1hour=60]="Last1hour",e[e.Last3hours=180]="Last3hours",e[e.Last6hours=360]="Last6hours",e[e.Last12hours=720]="Last12hours",e[e.Last24hours=1440]="Last24hours",e[e.Last2days=2880]="Last2days",e[e.Last7days=10080]="Last7days"}(A||(A={}));const O={[A.Last5minutes]:"Last 5 minutes",[A.Last15minutes]:"Last 15 minutes",[A.Last30minutes]:"Last 30 minutes",[A.Last1hour]:"Last 1 hour",[A.Last3hours]:"Last 3 hours",[A.Last6hours]:"Last 6 hours",[A.Last12hours]:"Last 12 hours",[A.Last24hours]:"Last 24 hours",[A.Last2days]:"Last 2 days",[A.Last7days]:"Last 7 days"},I=({duration:e,keyText:t,disableToolbar:a,onDurationChange:r})=>{const[o,l]=(0,n.useState)(!1);return i().createElement(s.ToolbarItem,null,i().createElement(s.Select,{variant:s.SelectVariant.single,"aria-label":"Select Input",onToggle:e=>{l(e)},onSelect:(e,t)=>{const a=Object.entries(O).find((([e,a])=>a===t));a&&r(parseInt(a[0],10)),l(!1)},selections:O[e],isOpen:o,isDisabled:a,placeholderText:"Last 6 hours"},(e=>[i().createElement(s.SelectGroup,{label:"Relative time ranges",key:`${e}-group`},Object.values(O).map(((t,a)=>i().createElement(s.SelectOption,{key:`${e}-${a}`,value:t}))))])(t)))};var j=a(8755);const Z={default:"100px",sm:"80px",md:"150px",lg:"200px",xl:"250px","2xl":"300px"},B=({selectedTopic:e,topicList:t=[],disableToolbar:a,onSetSelectedTopic:r})=>{const{t:o}=(0,M.useTranslation)(),[l,c]=(0,n.useState)(!1),u=o("All topics"),d=e=>[i().createElement(s.SelectOption,{key:"topic-filter-0",value:u}),i().createElement(s.SelectGroup,{label:"Filter by topic",key:"topic-filter-group"},e.map(((e,t)=>i().createElement(s.SelectOption,{key:`topic-filter-${t+1}`,value:e}))))],p=a||0===t.length;return i().createElement(s.ToolbarItem,{widths:Z},i().createElement(s.Select,{variant:s.SelectVariant.single,onToggle:e=>{c(e)},onSelect:(e,t)=>{r("All topics"!==t?t:void 0)},selections:e||u,isOpen:l,placeholderText:i().createElement(i().Fragment,null,i().createElement(j.ZP,null)," All topics"),"aria-label":o("Select a topic"),onFilter:(e,a)=>{const n=t.filter((e=>-1!=e.indexOf(a)))||[];return d(n)},isGrouped:!0,hasInlineFilter:!0,isDisabled:p,style:{width:"100%"}},d(t)))};var N=a(62482),z=a(84076),V=a(72021),U=a(84103),$=a.n(U);const G={[A.Last5minutes]:{interval:60,ticks:5,showDate:!1},[A.Last15minutes]:{interval:180,ticks:5,showDate:!1},[A.Last30minutes]:{interval:300,ticks:6,showDate:!1},[A.Last1hour]:{interval:600,ticks:6,showDate:!1},[A.Last3hours]:{interval:1800,ticks:6,showDate:!1},[A.Last6hours]:{interval:3600,ticks:6,showDate:!1},[A.Last12hours]:{interval:7200,ticks:6,showDate:!1},[A.Last24hours]:{interval:14400,ticks:6,showDate:!0},[A.Last2days]:{interval:28800,ticks:6,showDate:!0},[A.Last7days]:{interval:86400,ticks:7,showDate:!0}};function W(e){return $()(e,{units:"iec"}).toString()}const H=e=>G[e].showDate,K=(e,{showDate:t}={showDate:!1})=>{const[a,n]=e.toISOString().split("T");return t?n.slice(0,5)+"\n"+a:n.slice(0,5)};var Y=a(30734);const q=[V.ZP.value,z.ZP.value],X=({partitions:e,duration:t})=>{const{t:a}=(0,M.useTranslation)(),r=(0,n.useRef)(null),[s,o]=(0,n.useState)(),l=()=>r.current&&o(r.current.clientWidth),c=s&&s>650?6:3;(0,n.useEffect)((()=>{l(),window.addEventListener("resize",l)}),[s]);const{chartData:u,legendData:d,tickValues:p}=function(e,t){const a=[],n=[];Object.entries(e).map((([e,t],i)=>{const r=q[i];a.push({name:e});const s=[];Object.entries(t).map((([t,a])=>{s.push({name:e,x:parseInt(t,10),y:a})})),n.push({color:r,area:s})}));const i=Object.values(e).flatMap((e=>Object.keys(e))),r=parseInt(i[0]),s=new Array(G[t].ticks).fill(r).map(((e,a)=>(0,Y.Z)(new Date(e),{seconds:G[t].interval*a}).getTime()));return{legendData:a,chartData:n,tickValues:s}}(e,t);return i().createElement("div",{ref:r},i().createElement(N.Chart,{ariaTitle:a("metrics.log_size_per_partition"),containerComponent:i().createElement(N.ChartVoronoiContainer,{labels:({datum:e})=>`${e.name}: ${W(e.y)}`,constrainToVisibleArea:!0}),legendPosition:"bottom-left",legendComponent:i().createElement(N.ChartLegend,{data:d,itemsPerRow:c}),height:350,padding:{bottom:110,left:120,right:40,top:40},themeColor:N.ChartThemeColor.multiUnordered,width:s,legendAllowWrap:!0},i().createElement(N.ChartAxis,{label:"\nTime",tickValues:p,tickFormat:e=>K(new Date(e),{showDate:H(t)})}),i().createElement(N.ChartAxis,{label:"\n\n\n\n\nBytes",dependentAxis:!0,tickFormat:W}),i().createElement(N.ChartGroup,null,u.map(((e,t)=>i().createElement(N.ChartArea,{key:`chart-area-${t}`,data:e.area,interpolation:"monotoneX"}))))))};const J=({diskSpaceMetrics:e,topicMetrics:t})=>i().createElement(s.PageSection,null,i().createElement(s.Grid,{hasGutter:!0},i().createElement(s.GridItem,{lg:6},e),i().createElement(s.GridItem,{lg:6},t)));var Q=a(66095);const ee=({title:e,selectedTopic:t,topicList:a,duration:n,isDisabled:r,isRefreshing:o,onSetTimeDuration:l,onRefresh:c,onSetSelectedTopic:u})=>i().createElement(i().Fragment,null,i().createElement(s.CardHeader,null,i().createElement(s.CardTitle,{component:"h2"},e),i().createElement(s.CardActions,null,i().createElement(s.Toolbar,null,i().createElement(s.ToolbarContent,null,i().createElement(B,{selectedTopic:t,onSetSelectedTopic:u,topicList:a,disableToolbar:r}),i().createElement(I,{duration:n,onDurationChange:l,disableToolbar:r,keyText:"topic-metrics-time-filter"}),i().createElement(s.ToolbarItem,null,i().createElement(s.Button,{isLoading:o,variant:"plain","aria-label":"sync",onClick:c},!o&&i().createElement(Q.ZP,null))))))),i().createElement(s.Divider,null)),te=()=>i().createElement(s.CardBody,null,i().createElement(s.Bullseye,null,i().createElement(s.Spinner,{isSVG:!0}))),ae=({topics:e,incomingTopicsData:t,outgoingTopicsData:a,selectedTopic:n,duration:r,partitions:o,backendUnavailable:l,metricsDataUnavailable:c,isLoading:u,isRefreshing:d,onCreateTopic:p,onRefresh:m,onSelectedTopic:h,onDurationChange:g})=>{const{t:f}=(0,M.useTranslation)(),y=0===e.length;return i().createElement(s.Card,null,i().createElement(ee,{title:f("metrics.topic_metrics"),duration:r,onSetTimeDuration:g,isDisabled:l||y,isRefreshing:d,selectedTopic:n,onSetSelectedTopic:h,onRefresh:m,topicList:e}),(()=>{switch(!0){case u&&void 0===n:return i().createElement(s.CardBody,null,i().createElement(s.Bullseye,null,i().createElement(s.Spinner,{isSVG:!0})));case u:return i().createElement(i().Fragment,null,i().createElement(ne,null),i().createElement(te,null),i().createElement(s.Divider,null),i().createElement(ie,null),i().createElement(te,null));case l:return i().createElement(s.CardBody,null,i().createElement(x,null));case c:return i().createElement(s.CardBody,null,i().createElement(F,null));case y:return i().createElement(s.CardBody,null,i().createElement(R,{onCreateTopic:p}));case void 0!==n:return i().createElement(i().Fragment,null,i().createElement(ne,null),i().createElement(s.CardBody,null,i().createElement(se,{incomingTopicsData:t,outgoingTopicsData:a,selectedTopic:n,duration:r})),i().createElement(s.Divider,null),i().createElement(ie,null),i().createElement(s.CardBody,null,i().createElement(X,{partitions:o,duration:r})));default:return i().createElement(i().Fragment,null,i().createElement(ne,null),i().createElement(s.CardBody,null,i().createElement(se,{incomingTopicsData:t,outgoingTopicsData:a,selectedTopic:n,duration:r})),i().createElement(s.Divider,null),i().createElement(ie,null),i().createElement(s.CardBody,null,i().createElement(P,null)))}})())},ne=()=>{const{t:e}=(0,M.useTranslation)();return i().createElement(s.CardTitle,{component:"h3"},e("metrics.total_bytes")," ",i().createElement(w,{title:e("metrics.total_bytes_popover_header"),description:e("metrics.topic_metrics_help_text")}))},ie=()=>{const{t:e}=(0,M.useTranslation)();return i().createElement(s.CardTitle,{component:"h3"},e("metrics.topic_partition_size")," ",i().createElement(w,{title:e("metrics.topic_partition_size_popover_header"),description:e("metrics.topic_partition_size_help_text")}))};var re=a(82874);const se=({incomingTopicsData:e,outgoingTopicsData:t,selectedTopic:a,duration:r})=>{const{t:s}=(0,M.useTranslation)(),o=(0,n.useRef)(null),[l,c]=(0,n.useState)(),u=()=>o.current&&c(o.current.clientWidth),d=l&&l>650?6:3;(0,n.useEffect)((()=>{u(),window.addEventListener("resize",u)}),[l]);const{chartData:p,legendData:m,tickValues:h}=function(e,t,a,n,i){const r=[],s=[],o=oe(e,n);if(o){const e=z.ZP.value;s.push({color:e,line:o}),r.push({name:n,symbol:{fill:e}})}const l=oe(t,i);if(l){const e=re.ZP.value;s.push({color:e,line:l}),r.push({name:i,symbol:{fill:e}})}const c=[...Object.keys(e),...Object.keys(t)];c.sort();const u=parseInt(c[c.length-1]),d=new Array(G[a].ticks).fill(u).map(((e,t)=>(0,Y.Z)(new Date(e),{seconds:G[a].interval*t}).getTime()));return{legendData:r,chartData:s,tickValues:d}}(e,t,r,s("{{topic}} incoming bytes",{topic:a||s("Total")}),s("{{topic}} outgoing bytes",{topic:a||s("Total")}));return i().createElement("div",{ref:o},i().createElement(N.Chart,{ariaTitle:s("metrics.total_bytes"),containerComponent:i().createElement(N.ChartVoronoiContainer,{labels:({datum:e})=>`${e.name}: ${W(e.y)}`,constrainToVisibleArea:!0}),legendAllowWrap:!0,legendPosition:"bottom-left",legendComponent:i().createElement(N.ChartLegend,{data:m,itemsPerRow:d}),height:300,padding:{bottom:110,left:120,right:40,top:40},themeColor:N.ChartThemeColor.multiUnordered,width:l},i().createElement(N.ChartAxis,{label:"\nTime",tickValues:h,tickCount:G[r].ticks,tickFormat:e=>K(new Date(e),{showDate:H(r)})}),i().createElement(N.ChartAxis,{label:"\n\n\n\n\nBytes",dependentAxis:!0,tickFormat:W}),i().createElement(N.ChartGroup,null,p.map(((e,t)=>i().createElement(N.ChartLine,{key:`chart-line-${t}`,data:e.line,style:{data:{stroke:e.color}}}))))))};function oe(e,t){const a=[];return Object.entries(e).map((([e,n])=>{a.push({name:t,x:parseInt(e,10),y:n})})),a}var le=a(9914);const ce=({metrics:e,duration:t,chartName:a,usageLimit:r,formatValue:s=(e=>`${e}`)})=>{const o=(0,n.useRef)(null),{t:l}=(0,M.useTranslation)(),[c,u]=(0,n.useState)(),d=()=>o.current&&u(o.current.clientWidth),p=c&&c>650?6:3;(0,n.useEffect)((()=>{d(),window.addEventListener("resize",d)}),[c]);const{chartData:m,legendData:h,tickValues:g}=function(e,t,a,n,i){const r=[i?{name:n,symbol:{fill:le.ZP.value,type:"threshold"}}:void 0,{name:a,symbol:{fill:z.ZP.value}}].filter((e=>!!e)),s=z.ZP.value,o=le.ZP.value,l=[],c=[],u=[];Object.entries(e).map((([e,t])=>{c.push({name:a,x:parseInt(e,10),y:t}),i&&u.push({name:n,x:parseInt(e,10),y:i})})),l.push({areaColor:s,softLimitColor:o,area:c,softLimit:u});const d=Object.keys(e),p=parseInt(d[0]),m=new Array(G[t].ticks).fill(p).map(((e,a)=>(0,Y.Z)(new Date(e),{seconds:G[t].interval*a}).getTime()));return{legendData:r,chartData:l,tickValues:m}}(e,t,a,l("Limit"),r);return i().createElement("div",{ref:o},i().createElement(N.Chart,{ariaTitle:l("metrics.used_disk_space"),containerComponent:i().createElement(N.ChartVoronoiContainer,{labels:({datum:e})=>`${e.name}: ${s(e.y)}`,constrainToVisibleArea:!0}),legendPosition:"bottom-left",legendComponent:i().createElement(N.ChartLegend,{orientation:"horizontal",data:h,itemsPerRow:p}),height:350,padding:{bottom:110,left:120,right:40,top:40},themeColor:N.ChartThemeColor.multiUnordered,width:c,legendAllowWrap:!0},i().createElement(N.ChartAxis,{label:"\nTime",tickValues:g,tickFormat:e=>K(new Date(e),{showDate:H(t)})}),i().createElement(N.ChartAxis,{label:"\n\n\n\n\n"+a,dependentAxis:!0,tickFormat:s}),i().createElement(N.ChartGroup,null,m.map(((e,t)=>i().createElement(N.ChartArea,{key:`chart-area-${t}`,data:e.area,interpolation:"monotoneX",style:{data:{}}})))),i().createElement(N.ChartThreshold,{key:"chart-softlimit",data:m[0].softLimit,style:{data:{stroke:m[0].softLimitColor}}})))};const ue=({title:e,isDisabled:t,isRefreshing:a,duration:n,onSetTimeDuration:r,onRefresh:o})=>i().createElement(i().Fragment,null,i().createElement(s.CardHeader,null,i().createElement(s.CardTitle,{component:"h2"},e),i().createElement(s.CardActions,null,i().createElement(s.Toolbar,null,i().createElement(s.ToolbarContent,null,i().createElement(I,{duration:n,onDurationChange:r,keyText:"kafka-metrics-time-filter",disableToolbar:t}),i().createElement(s.ToolbarItem,null,i().createElement(s.Button,{isLoading:a,variant:"plain","aria-label":"sync",onClick:o},!a&&i().createElement(Q.ZP,null))))))),i().createElement(s.Divider,null)),de=({usedDiskMetrics:e,connectionAttemptRateMetrics:t,duration:a,metricsDataUnavailable:n,isLoading:r,isRefreshing:o,onRefresh:l,onDurationChange:c})=>{const{t:u}=(0,M.useTranslation)();return i().createElement(s.Card,null,i().createElement(ue,{title:u("metrics.kafka_instance_metrics"),duration:a,onSetTimeDuration:c,isDisabled:n,isRefreshing:o,onRefresh:l}),(()=>{switch(!0){case r:return i().createElement(i().Fragment,null,i().createElement(pe,{title:"used_disk_space",helperText:"used_disk_space_help_text"}),i().createElement(te,null));case n:return i().createElement(s.CardBody,null,i().createElement(x,null));default:return i().createElement(i().Fragment,null,i().createElement(pe,{title:"used_disk_space",helperText:"used_disk_space_help_text"}),i().createElement(s.CardBody,null,i().createElement(ce,{chartName:u("metrics.used_disk_space"),metrics:e,duration:a,formatValue:W,usageLimit:1e3*Math.pow(1024,3)})),i().createElement(s.Divider,null),i().createElement(pe,{title:"connection_attempt_rate",helperText:"connection_attempt_rate_help_text"}),i().createElement(s.CardBody,null,i().createElement(ce,{chartName:u("metrics.connection_attempt_rate"),metrics:t,duration:a,usageLimit:100})))}})())},pe=({title:e,helperText:t})=>{const{t:a}=(0,M.useTranslation)();return i().createElement(s.CardTitle,{component:"h3"},a(`metrics.${e}`)," ",i().createElement(w,{title:a(`metrics.${e}`),description:a(`metrics.${t}`)}))};var me=a(38801),he=a(66310);const ge=(0,he.createModel)({duration:60,usedDiskSpaceMetrics:{},clientConnectionsMetrics:{},connectionAttemptRateMetrics:{},fetchFailures:0},{events:{fetch:()=>({}),fetchSuccess:e=>Object.assign({},e),fetchFail:()=>({}),refresh:()=>({}),selectTopic:e=>({selectedTopic:e}),selectDuration:e=>({duration:e})}}),fe=ge.assign(((e,t)=>{const{usedDiskSpaceMetrics:a,clientConnectionsMetrics:n,connectionAttemptRateMetrics:i}=t;return{usedDiskSpaceMetrics:a,clientConnectionsMetrics:n,connectionAttemptRateMetrics:i}}),"fetchSuccess"),ye=ge.assign({fetchFailures:e=>e.fetchFailures+1},"fetchFail"),Ee=ge.assign({fetchFailures:()=>0},"refresh"),ve=ge.assign({duration:(e,t)=>t.duration},"selectDuration"),be=ge.createMachine({id:"diskSpace",context:ge.initialContext,initial:"callApi",states:{callApi:{tags:"loading",initial:"loading",states:{loading:{invoke:{src:"api"},on:{fetchSuccess:{actions:fe,target:"#diskSpace.verifyData"},fetchFail:{actions:ye,target:"failure"}}},failure:{after:{1e3:[{cond:"canRetryFetching",target:"loading"},{target:"#diskSpace.criticalFail"}]}}}},criticalFail:{tags:"failed",on:{refresh:{actions:Ee,target:"callApi"}}},verifyData:{always:[{cond:"hasMetrics",target:"withMetrics"},{target:"noData"}]},noData:{tags:"no-data",on:{refresh:{actions:Ee,target:"callApi"},selectDuration:{actions:ve,target:"refreshing"}}},withMetrics:{on:{refresh:{target:"refreshing"},selectDuration:{actions:ve,target:"refreshing"}}},refreshing:{tags:"refreshing",invoke:{src:"api"},on:{fetchSuccess:{actions:fe,target:"verifyData"},fetchFail:{target:"verifyData"}}}}},{guards:{canRetryFetching:e=>e.fetchFailures<3,hasMetrics:e=>Object.keys(e.usedDiskSpaceMetrics).length>0}}),_e=(0,he.createModel)({selectedTopic:void 0,duration:60,kafkaTopics:[],metricsTopics:[],bytesOutgoing:{},bytesIncoming:{},bytesPerPartition:{},incomingMessageRate:{},fetchFailures:0},{events:{fetch:()=>({}),fetchSuccess:e=>Object.assign({},e),fetchFail:()=>({}),refresh:()=>({}),selectTopic:e=>({selectedTopic:e}),selectDuration:e=>({duration:e})}}),Te=_e.assign(((e,t)=>{const{kafkaTopics:a,metricsTopics:n,bytesPerPartition:i,bytesIncoming:r,bytesOutgoing:s,incomingMessageRate:o}=t;return{kafkaTopics:a,metricsTopics:n,bytesPerPartition:i,bytesIncoming:r,bytesOutgoing:s,incomingMessageRate:o}}),"fetchSuccess"),ke=_e.assign({fetchFailures:e=>e.fetchFailures+1},"fetchFail"),Ce=_e.assign({fetchFailures:()=>0},"refresh"),De=_e.assign({selectedTopic:(e,t)=>t.selectedTopic},"selectTopic"),we=_e.assign({duration:(e,t)=>t.duration},"selectDuration"),Se=_e.createMachine({id:"topics",context:_e.initialContext,initial:"callApi",states:{callApi:{tags:"loading",initial:"loading",states:{loading:{invoke:{src:"api"},on:{fetchSuccess:{actions:Te,target:"#topics.verifyData"},fetchFail:{actions:ke,target:"failure"}}},failure:{after:{1e3:[{cond:"canRetryFetching",target:"loading"},{target:"#topics.criticalFail"}]}}}},criticalFail:{tags:"failed",on:{refresh:{actions:Ce,target:"callApi"}}},verifyData:{always:[{cond:"hasMetrics",target:"withTopics"},{target:"noData"}]},noData:{tags:"no-data",initial:"idle",states:{idle:{},refreshing:{tags:"refreshing",invoke:{src:"api"},on:{fetchSuccess:{actions:Te,target:"#topics.verifyData"},fetchFail:{target:"#topics.noData"}}}},on:{refresh:{target:"#topics.noData.refreshing"},selectTopic:{actions:De,target:"#topics.noData.refreshing"},selectDuration:{actions:we,target:"#topics.noData.refreshing"}}},withTopics:{initial:"idle",states:{idle:{},refreshing:{tags:"refreshing",invoke:{src:"api"},on:{fetchSuccess:{actions:Te,target:"#topics.verifyData"},fetchFail:{target:"#topics.withTopics"}}}},on:{refresh:{target:"#topics.withTopics.refreshing"},selectTopic:{actions:De,target:"#topics.withTopics.refreshing"},selectDuration:{actions:we,target:"#topics.withTopics.refreshing"}}}}},{guards:{canRetryFetching:e=>e.fetchFailures<3,hasMetrics:e=>{const t=e.kafkaTopics.length>0||e.metricsTopics.length>0,a=Object.keys(e.bytesIncoming).length>0||Object.keys(e.bytesOutgoing).length>0;return t&&a}}}),Le=(0,n.createContext)(null),Me=({children:e,getDiskSpaceMetrics:t,getTopicsMetrics:a})=>{const n=function({getTopicsMetrics:e}){return(0,me.useInterpret)(Se.withConfig({services:{api:t=>a=>{e({selectedTopic:t.selectedTopic,duration:t.duration,interval:G[t.duration].interval}).then((e=>a(_e.events.fetchSuccess(e)))).catch((e=>{console.error("Failed fetching data",e),a(_e.events.fetchFail())}))}}}),{devTools:!0})}({getTopicsMetrics:a}),r=function({getDiskSpaceMetrics:e}){return(0,me.useInterpret)(be.withConfig({services:{api:t=>a=>{e({duration:t.duration,interval:G[t.duration].interval}).then((e=>a(ge.events.fetchSuccess(e)))).catch((e=>{console.error("Failed fetching data",e),a(ge.events.fetchFail())}))}}}),{devTools:!0})}({getDiskSpaceMetrics:t});return i().createElement(Le.Provider,{value:{kafkaInstanceMetricsMachineService:r,topicsMetricsMachineService:n}},e)};function xe(){const{kafkaInstanceMetricsMachineService:e}=(0,n.useContext)(Le),t=(0,n.useCallback)((e=>Object.assign(Object.assign({},e.context),{isRefreshing:e.hasTag("refreshing"),isLoading:e.hasTag("loading"),isFailed:e.hasTag("failed"),isDataUnavailable:e.hasTag("no-data")})),[]),{usedDiskSpaceMetrics:a,connectionAttemptRateMetrics:i,duration:r,isLoading:s,isRefreshing:o,isDataUnavailable:l,isFailed:c}=(0,me.useSelector)(e,t),u=(0,n.useCallback)((t=>e.send(ge.events.selectDuration(t))),[e]);return{usedDiskSpaceMetrics:a,connectionAttemptRateMetrics:i,isLoading:s,isRefreshing:o,isFailed:c,isDataUnavailable:l,duration:r,onDurationChange:u,onRefresh:(0,n.useCallback)((()=>e.send(ge.events.refresh())),[e])}}const Fe=({getDiskSpaceMetrics:e,getTopicsMetrics:t,onCreateTopic:a})=>i().createElement(Me,{getDiskSpaceMetrics:e,getTopicsMetrics:t},i().createElement(Re,{onCreateTopic:a})),Re=({onCreateTopic:e})=>{const{isLoading:t,isFailed:a}=xe();switch(!0){case t:return i().createElement(S,null);case a:return i().createElement(x,null)}return i().createElement(J,{diskSpaceMetrics:i().createElement(Pe,null),topicMetrics:i().createElement(Ae,{onCreateTopic:e})})},Pe=()=>{const{isLoading:e,isRefreshing:t,isDataUnavailable:a,isFailed:n,duration:r,usedDiskSpaceMetrics:s,connectionAttemptRateMetrics:o,onDurationChange:l,onRefresh:c}=xe();return i().createElement(de,{usedDiskMetrics:s,connectionAttemptRateMetrics:o,duration:r,metricsDataUnavailable:a||n,isLoading:e,isRefreshing:t,onRefresh:c,onDurationChange:l})},Ae=({onCreateTopic:e})=>{const{isLoading:t,isRefreshing:a,isFailed:r,isDataUnavailable:s,selectedTopic:o,duration:l,topics:c,bytesIncoming:u,bytesOutgoing:d,bytesPerPartition:p,onDurationChange:m,onTopicChange:h,onRefresh:g}=function(){const{topicsMetricsMachineService:e}=(0,n.useContext)(Le),t=(0,n.useCallback)((e=>Object.assign(Object.assign({},e.context),{isRefreshing:e.hasTag("refreshing"),isLoading:e.hasTag("loading"),isFailed:e.hasTag("failed"),isDataUnavailable:e.hasTag("no-data")})),[]),{selectedTopic:a,duration:i,kafkaTopics:r,metricsTopics:s,bytesIncoming:o,bytesOutgoing:l,bytesPerPartition:c,isLoading:u,isRefreshing:d,isDataUnavailable:p,isFailed:m}=(0,me.useSelector)(e,t),h=(0,n.useCallback)((t=>e.send(_e.events.selectTopic(t))),[e]),g=(0,n.useCallback)((t=>e.send(_e.events.selectDuration(t))),[e]),f=(0,n.useCallback)((()=>e.send(_e.events.refresh())),[e]);return{isLoading:u,isRefreshing:d,isFailed:m,isDataUnavailable:p,topics:(0,n.useMemo)((()=>{const e=Array.from(new Set([...r,...s]));return e.sort(((e,t)=>e.localeCompare(t))),e}),[r,s]),selectedTopic:a,duration:i,bytesIncoming:o,bytesOutgoing:l,bytesPerPartition:c,onTopicChange:h,onDurationChange:g,onRefresh:f}}();return i().createElement(ae,{backendUnavailable:r,metricsDataUnavailable:s,topics:c,incomingTopicsData:u,outgoingTopicsData:d,partitions:p,duration:l,isLoading:t,isRefreshing:a,selectedTopic:o,onRefresh:g,onSelectedTopic:h,onDurationChange:m,onCreateTopic:e})}},13882:(e,t,a)=>{function n(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}a.d(t,{Z:()=>n})},83946:(e,t,a)=>{function n(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}a.d(t,{Z:()=>n})},77349:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(83946),i=a(19013),r=a(13882);function s(e,t){(0,r.Z)(2,arguments);var a=(0,i.Z)(e),s=(0,n.Z)(t);return isNaN(s)?new Date(NaN):s?(a.setDate(a.getDate()+s),a):a}},11640:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(83946),i=a(19013),r=a(13882);function s(e,t){(0,r.Z)(2,arguments);var a=(0,i.Z)(e),s=(0,n.Z)(t);if(isNaN(s))return new Date(NaN);if(!s)return a;var o=a.getDate(),l=new Date(a.getTime());l.setMonth(a.getMonth()+s+1,0);var c=l.getDate();return o>=c?l:(a.setFullYear(l.getFullYear(),l.getMonth(),o),a)}},30734:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7069),i=a(54559),r=a(13882),s=a(83946);function o(e,t){if((0,r.Z)(2,arguments),!t||"object"!=typeof t)return new Date(NaN);var a=t.years?(0,s.Z)(t.years):0,o=t.months?(0,s.Z)(t.months):0,l=t.weeks?(0,s.Z)(t.weeks):0,c=t.days?(0,s.Z)(t.days):0,u=t.hours?(0,s.Z)(t.hours):0,d=t.minutes?(0,s.Z)(t.minutes):0,p=t.seconds?(0,s.Z)(t.seconds):0,m=(0,i.Z)(e,o+12*a),h=(0,n.Z)(m,c+7*l),g=d+60*u,f=p+60*g,y=1e3*f,E=new Date(h.getTime()-y);return E}},7069:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(83946),i=a(77349),r=a(13882);function s(e,t){(0,r.Z)(2,arguments);var a=(0,n.Z)(t);return(0,i.Z)(e,-a)}},54559:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(83946),i=a(11640),r=a(13882);function s(e,t){(0,r.Z)(2,arguments);var a=(0,n.Z)(t);return(0,i.Z)(e,-a)}},19013:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(13882);function i(e){(0,n.Z)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}}}]);
//# sourceMappingURL=9861.9531d4b3.js.map