"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[4611],{27081:()=>{},54930:(e,t,n)=>{n.d(t,{R:()=>b});var s=n(87967),a=n(85893),i=n(93264),r=(n(27081),n(70959)),c=n(49626),o=n(81548),d=n(63286),u=n(13449),l=n(97644),f=n(55140);var k=n(15847);function m(){const e=function(){const e=document;return void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":void 0}();return void 0!==e&&!document[e]}function p(){const[e,t]=(0,i.useState)(m()),n=()=>t(m());return(0,i.useEffect)((()=>{const e=function(){const e=document;return void 0!==e.hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":""}();return document.addEventListener(e,n,!1),()=>{document.removeEventListener(e,n)}}),[]),{isVisible:e,setIsVisible:t}}var v=n(75381),C=n(90154);function g(){const{t:e}=(0,k.useTranslation)(["kasTemporaryFixMe"]),{addAlert:t}=(0,l.useAlert)()||{},{isVisible:n}=p(),s=(0,i.useRef)(),r=(0,i.useRef)([]),c=(0,i.useRef)([]),o=(0,i.useCallback)((n=>{t({title:e("kafka_successfully_created"),variant:C.AlertVariant.success,description:(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:e("kafka_success_message",{name:n})}}),dataTestId:"toastCreateKafka-success"})}),[t,e]),d=(0,i.useCallback)((n=>{t({title:e("kafka_successfully_deleted",{name:n}),variant:C.AlertVariant.success})}),[t,e]),u=(0,i.useCallback)((n=>{t({title:e("kafka_not_created"),variant:C.AlertVariant.danger,description:(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:e("kafka_failed_message",{name:n})}}),dataTestId:"toastCreateKafka-failed"})}),[t,e]);return function(e,t){const n=(0,i.useRef)();(0,i.useEffect)((()=>{n.current=e}),[e]),(0,i.useEffect)((()=>{if(null!==t){const e=setInterval((function(){n.current&&n.current()}),t);return()=>{clearInterval(e)}}}),[t])}((0,i.useCallback)((function(){if(n)for(;c.current.length>0;){const e=c.current.shift();switch(e.status){case v.Od.READY:o(e.name);break;case v.Od.FAILED:u(e.name);break;case v.Od.DEPROVISION:case v.Od.DELETED:d(e.name)}}}),[n,d,u,o]),1e3),function(e){if(e){const t=void 0===s.current,n=s.current||[],a=n.map((e=>`${e.id}:${e.status}`)),i=e.map((e=>`${e.id}:${e.status}`));if(JSON.stringify(a)!==JSON.stringify(i)){const a=(e,s)=>t?[]:e.filter((e=>{const t=n.find((t=>t.id===e.id));return!!t&&(e.status===s&&t.status!==s)})),i=a(e,v.Od.READY),o=a(e,v.Od.FAILED),[d,u]=r.current.reduce((([t,n],s)=>void 0===e.find((e=>e.id===s.id))?[[...t,s],n]:[t,[...n,s]]),[[],[]]),l=e.filter((e=>[v.Od.DELETED,v.Od.DEPROVISION].includes(e.status)&&void 0===u.find((t=>t.id===e.id))));r.current=[...u,...l],c.current=[...c.current,...i.map(h),...o.map(h),...d.map(h)],s.current=e}}}}function h(e){return{name:e.name,status:e.status}}var O=n(10069);const I=({preCreateInstance:e,currentUser:t,isCurrentUserOrgAdmin:n})=>{const k=(0,c.a)(),{openCreateModal:m}=function(e=(()=>Promise.resolve(!0))){const{analytics:t}=(0,f.Z)(),{shouldOpenCreateModal:n}=(0,u.S)(),{showModal:a}=(0,l.useModal)(),{update:c,query:o}=(0,r.useURLSearchParams)(),d=(0,i.useCallback)((n=>(0,s.__awaiter)(this,void 0,void 0,(function*(){t.track("RHOSAK Create Instance",{status:"prompt"}),(yield e(!0))?a(l.ModalType.KasCreateInstance,{onCreate:()=>{t.track("RHOSAK Create Instance",{status:"success"}),n()}}):t.track("RHOSAK Create Instance",{status:"failure-tos-refused"})}))),[t,e,a]);return(0,i.useEffect)((()=>{!function(){(0,s.__awaiter)(this,void 0,void 0,(function*(){(yield n())&&(o.delete("create"),c(o),(yield e(!0))&&a(l.ModalType.KasCreateInstance,{onCreate:()=>{}}))}))}()}),[d,e,o,n,a,c]),{openCreateModal:d}}(e),{openDeleteDialog:p}=function(){const{analytics:e}=(0,f.Z)(),{showModal:t}=(0,l.useModal)();return{openDeleteDialog:(0,i.useCallback)(((n,s)=>{e.track("RHOSAK Delete Instance",{status:"prompt",entityId:n.id}),t(l.ModalType.KasDeleteInstance,{onDelete:()=>{e.track("RHOSAK Delete Instance",{status:"success",entityId:n.id}),s()},kafka:n.request})}),[e,t])}}(),{openChangeOwnerDialog:C}=function(){const{showModal:e}=(0,l.useModal)();return{openChangeOwnerDialog:(0,i.useCallback)(((t,n)=>{e(l.ModalType.KasTransferOwnership,{kafka:t.request,refreshKafkas:n})}),[e])}}(),h=g(),{setActiveQuickStart:I}=(0,i.useContext)(O.QuickStartContext),{isDrawerOpen:b,drawerInstance:w,closeDrawer:D,openDrawer:y,setDrawerActiveTab:S,setDrawerInstance:E}=(0,o.gD)(),_=(0,i.useCallback)(((...e)=>(0,s.__awaiter)(void 0,void 0,void 0,(function*(){const n=yield k(...e);if(w){const e=n.instances.find((e=>e.id===w.id));e?JSON.stringify(e)!==JSON.stringify(w)&&E(e):D()}return h(n.instances.filter((e=>e.owner==t))),n}))),[D,t,w,k,h,E]),A=e=>{E(e),S(d.Z.CONNECTION),y()},T=(0,i.useCallback)((({owner:e})=>e===t||n),[t,n]),x=(0,i.useCallback)((({owner:e,status:s})=>e===t||n&&s!==v.Od.SUSPENDED),[t,n]),M=(0,i.useCallback)((()=>I&&I("getting-started")),[I]);return(0,a.jsx)(r.KafkaInstances,{isRowSelected:({row:e})=>b&&e.id===(null==w?void 0:w.id),getInstances:_,getUrlForInstance:({id:e})=>`./kafkas/${e}/dashboard`,onCreate:m,onDetails:e=>{E(e),S(d.Z.DETAILS),y()},onConnection:A,onChangeOwner:C,onDelete:p,onClickConnectionTabLink:A,onClickSupportLink:()=>{window.insights.chrome.createCase()},onInstanceLinkClick:D,onQuickstartGuide:M,canChangeOwner:x,canDelete:T,canHaveInstanceLink:e=>e.status===v.Od.READY,canOpenConnection:e=>e.status!==v.Od.SUSPENDED})},b=({preCreateInstance:e})=>{const{getUsername:t,isOrgAdmin:n}=(0,l.useAuth)(),[r,c]=(0,i.useState)(void 0);return(0,i.useEffect)((()=>{!function(){(0,s.__awaiter)(this,void 0,void 0,(function*(){const e=yield t(),s=yield n();void 0!==e&&void 0!==s&&c({currentUser:e,isCurrentUserOrgAdmin:s})}))}()}),[t,n]),(0,a.jsx)(I,{preCreateInstance:e,currentUser:null==r?void 0:r.currentUser,isCurrentUserOrgAdmin:(null==r?void 0:r.isCurrentUserOrgAdmin)||!1})}},35831:(e,t,n)=>{n.d(t,{LF:()=>o});var s=n(85893),a=n(15847),i=n(90154);n(52648);var r=n(93264),c=(n(3433),n(75381));n(10069);const o=({children:e})=>{const{t}=(0,a.useTranslation)(["kasTemporaryFixMe"]),[n,o]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if((0,c.Qw)()){const e=window.localStorage;if(e){const t=parseInt(e.getItem("openSessions")||"0"),n=t+1;t<1&&(e.setItem("openSessions",`${n}`),o(!0))}}}),[]);const d=()=>{o(!n)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("main",Object.assign({className:"pf-c-page__main"},{children:[(0,s.jsx)(i.PageSection,Object.assign({variant:i.PageSectionVariants.light},{children:(0,s.jsx)(i.Level,{children:(0,s.jsx)(i.LevelItem,{children:(0,s.jsx)(i.TextContent,{children:(0,s.jsx)(i.Text,Object.assign({component:"h1"},{children:t("kafka_instances")}))})})})})),e]})),(0,s.jsx)(i.Modal,Object.assign({variant:i.ModalVariant.small,title:"Mobile experience",isOpen:n,onClose:()=>d(),actions:[(0,s.jsx)(i.Button,Object.assign({variant:"primary",onClick:()=>d()},{children:"Ok"}),"confirm")]},{children:"The mobile experience isn't fully optimized yet, so some items might not appear correctly."}))]})}}}]);
//# sourceMappingURL=4611.498db0b7.js.map