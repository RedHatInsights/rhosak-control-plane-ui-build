"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[4538],{27081:()=>{},54930:(e,n,t)=>{t.d(n,{R:()=>b});var s=t(42695),a=t(85893),i=t(93264),r=(t(27081),t(32173)),c=t(49626),o=t(81548),d=t(63286),u=t(13449),l=t(97644);var f=t(15847);function k(){const e=function(){const e=document;return void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":void 0}();return void 0!==e&&!document[e]}function m(){const[e,n]=(0,i.useState)(k()),t=()=>n(k());return(0,i.useEffect)((()=>{const e=function(){const e=document;return void 0!==e.hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":""}();return document.addEventListener(e,t,!1),()=>{document.removeEventListener(e,t)}}),[]),{isVisible:e,setIsVisible:n}}var v=t(75381),p=t(54653);function C(){const{t:e}=(0,f.useTranslation)(["kasTemporaryFixMe"]),{addAlert:n}=(0,l.useAlert)()||{},{isVisible:t}=m(),s=(0,i.useRef)(),r=(0,i.useRef)([]),c=(0,i.useRef)([]),o=(0,i.useCallback)((t=>{n({title:e("kafka_successfully_created"),variant:p.AlertVariant.success,description:(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:e("kafka_success_message",{name:t})}}),dataTestId:"toastCreateKafka-success"})}),[n,e]),d=(0,i.useCallback)((t=>{n({title:e("kafka_successfully_deleted",{name:t}),variant:p.AlertVariant.success})}),[n,e]),u=(0,i.useCallback)((t=>{n({title:e("kafka_not_created"),variant:p.AlertVariant.danger,description:(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:e("kafka_failed_message",{name:t})}}),dataTestId:"toastCreateKafka-failed"})}),[n,e]);return function(e,n){const t=(0,i.useRef)();(0,i.useEffect)((()=>{t.current=e}),[e]),(0,i.useEffect)((()=>{if(null!==n){const e=setInterval((function(){t.current&&t.current()}),n);return()=>{clearInterval(e)}}}),[n])}((0,i.useCallback)((function(){if(t)for(;c.current.length>0;){const e=c.current.shift();switch(e.status){case v.Od.READY:o(e.name);break;case v.Od.FAILED:u(e.name);break;case v.Od.DEPROVISION:case v.Od.DELETED:d(e.name)}}}),[t,d,u,o]),1e3),function(e){if(e){const n=void 0===s.current,t=s.current||[],a=t.map((e=>`${e.id}:${e.status}`)),i=e.map((e=>`${e.id}:${e.status}`));if(JSON.stringify(a)!==JSON.stringify(i)){const a=(e,s)=>n?[]:e.filter((e=>{const n=t.find((n=>n.id===e.id));return!!n&&(e.status===s&&n.status!==s)})),i=a(e,v.Od.READY),o=a(e,v.Od.FAILED),[d,u]=r.current.reduce((([n,t],s)=>void 0===e.find((e=>e.id===s.id))?[[...n,s],t]:[n,[...t,s]]),[[],[]]),l=e.filter((e=>[v.Od.DELETED,v.Od.DEPROVISION].includes(e.status)&&void 0===u.find((n=>n.id===e.id))));r.current=[...u,...l],c.current=[...c.current,...i.map(g),...o.map(g),...d.map(g)],s.current=e}}}}function g(e){return{name:e.name,status:e.status}}var h=t(10069);const O=({preCreateInstance:e,currentUser:n,isCurrentUserOrgAdmin:t})=>{const f=(0,c.a)(),{openCreateModal:k}=function(e=(()=>Promise.resolve(!0))){const{shouldOpenCreateModal:n}=(0,u.S)(),{showModal:t}=(0,l.useModal)(),{update:a,query:c}=(0,r.useURLSearchParams)(),o=(0,i.useCallback)((n=>(0,s.__awaiter)(this,void 0,void 0,(function*(){(yield e(!0))&&t(l.ModalType.KasCreateInstance,{onCreate:n})}))),[e,t]);return(0,i.useEffect)((()=>{!function(){(0,s.__awaiter)(this,void 0,void 0,(function*(){(yield n())&&(c.delete("create"),a(c),(yield e(!0))&&t(l.ModalType.KasCreateInstance,{onCreate:()=>{}}))}))}()}),[o,e,c,n,t,a]),{openCreateModal:o}}(e),{openDeleteDialog:m}=function(){const{showModal:e}=(0,l.useModal)();return{openDeleteDialog:(0,i.useCallback)(((n,t)=>{e(l.ModalType.KasDeleteInstance,{onDelete:t,kafka:n.request})}),[e])}}(),{openChangeOwnerDialog:p}=function(){const{showModal:e}=(0,l.useModal)();return{openChangeOwnerDialog:(0,i.useCallback)(((n,t)=>{e(l.ModalType.KasTransferOwnership,{kafka:n.request,refreshKafkas:t})}),[e])}}(),g=C(),{setActiveQuickStart:O}=(0,i.useContext)(h.QuickStartContext),{isDrawerOpen:b,drawerInstance:w,closeDrawer:D,openDrawer:I,setDrawerActiveTab:y,setDrawerInstance:E}=(0,o.gD)(),S=(0,i.useCallback)(((...e)=>(0,s.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield f(...e);if(w){const e=t.instances.find((e=>e.id===w.id));e?JSON.stringify(e)!==JSON.stringify(w)&&E(e):D()}return g(t.instances.filter((e=>e.owner==n))),t}))),[D,n,w,f,g,E]),_=e=>{E(e),y(d.Z.CONNECTION),I()},T=(0,i.useCallback)((({owner:e})=>e===n||t),[n,t]),x=(0,i.useCallback)((({owner:e,status:s})=>e===n||t&&s!==v.Od.SUSPENDED),[n,t]),M=(0,i.useCallback)((()=>O&&O("getting-started")),[O]);return(0,a.jsx)(r.KafkaInstances,{isRowSelected:({row:e})=>b&&e.id===(null==w?void 0:w.id),getInstances:S,getUrlForInstance:({id:e})=>`./kafkas/${e}/dashboard`,onCreate:k,onDetails:e=>{E(e),y(d.Z.DETAILS),I()},onConnection:_,onChangeOwner:p,onDelete:m,onClickConnectionTabLink:_,onClickSupportLink:()=>{window.insights.chrome.createCase()},onInstanceLinkClick:D,onQuickstartGuide:M,canChangeOwner:x,canDelete:T,canHaveInstanceLink:e=>e.status===v.Od.READY,canOpenConnection:e=>e.status!==v.Od.SUSPENDED})},b=({preCreateInstance:e})=>{const{getUsername:n,isOrgAdmin:t}=(0,l.useAuth)(),[r,c]=(0,i.useState)(void 0);return(0,i.useEffect)((()=>{!function(){(0,s.__awaiter)(this,void 0,void 0,(function*(){const e=yield n(),s=yield t();void 0!==e&&void 0!==s&&c({currentUser:e,isCurrentUserOrgAdmin:s})}))}()}),[n,t]),(0,a.jsx)(O,{preCreateInstance:e,currentUser:null==r?void 0:r.currentUser,isCurrentUserOrgAdmin:(null==r?void 0:r.isCurrentUserOrgAdmin)||!1})}},35831:(e,n,t)=>{t.d(n,{LF:()=>o});var s=t(85893),a=t(15847),i=t(54653);t(52648);var r=t(93264),c=(t(3433),t(75381));t(10069);const o=({children:e})=>{const{t:n}=(0,a.useTranslation)(["kasTemporaryFixMe"]),[t,o]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if((0,c.Qw)()){const e=window.localStorage;if(e){const n=parseInt(e.getItem("openSessions")||"0"),t=n+1;n<1&&(e.setItem("openSessions",`${t}`),o(!0))}}}),[]);const d=()=>{o(!t)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("main",Object.assign({className:"pf-c-page__main"},{children:[(0,s.jsx)(i.PageSection,Object.assign({variant:i.PageSectionVariants.light},{children:(0,s.jsx)(i.Level,{children:(0,s.jsx)(i.LevelItem,{children:(0,s.jsx)(i.TextContent,{children:(0,s.jsx)(i.Text,Object.assign({component:"h1"},{children:n("kafka_instances")}))})})})})),e]})),(0,s.jsx)(i.Modal,Object.assign({variant:i.ModalVariant.small,title:"Mobile experience",isOpen:t,onClose:()=>d(),actions:[(0,s.jsx)(i.Button,Object.assign({variant:"primary",onClick:()=>d()},{children:"Ok"}),"confirm")]},{children:"The mobile experience isn't fully optimized yet, so some items might not appear correctly."}))]})}}}]);
