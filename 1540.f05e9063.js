"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[1540],{80516:(e,t,n)=>{t.Jk={name:"BanIcon",height:512,width:512,svgPath:"M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z",yOffset:0,xOffset:0},t.SC=n(35183).createIcon(t.Jk),t.ZP=t.SC},44535:(e,t,n)=>{t.de={name:"CheckIcon",height:512,width:512,svgPath:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z",yOffset:0,xOffset:0},t.nQ=n(35183).createIcon(t.de),t.ZP=t.nQ},51540:(e,t,n)=>{n.d(t,{L:()=>I});var a=n(70655),i=n(75418),r=n.n(i),o=n(76007),l=n(54532),s=n(56176),c=n.n(s),u=n(97012),d=n.n(u),v=n(54804),f=n(35451),m=n(80516),g=n(44535),p=n(45024);function h(e,t){var n=(0,i.useRef)();(0,i.useEffect)((function(){n.current=e}),[e]),(0,i.useEffect)((function(){if(null!==t){var e=setTimeout((function(){n.current()}),t);return function(){clearInterval(e)}}}),[e,t])}var k=n(75381);function S(){return!document[(e=document,void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":"")];var e}function E(){var e=(0,i.useState)(S()),t=e[0],n=e[1],a=function(){return n(S())};return(0,i.useEffect)((function(){var e,t=void 0!==(e=document).hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":"";return document.addEventListener(t,a,!1),function(){document.removeEventListener(t,a)}}),[]),{isVisible:t,setIsVisible:n}}var _=n(54950),b=n(365),w=n(92717),P=n(95216),y=n(5569),C=n(95368),I=function(e){var t=e.preCreateInstance,n=e.tokenEndPointUrl;d().extend(c());var s=((0,C.SP)()||{}).shouldOpenCreateModal,u=(0,P.useAuth)(),S=((0,P.useConfig)()||{}).kas.apiBasePath,I=E().isVisible,T=(0,o.useLocation)(),D=new URLSearchParams(T.search),V=parseInt(D.get("page")||"",10)||1,O=parseInt(D.get("perPage")||"",10)||10,L=D.has("user-testing"),A=(0,l.useTranslation)().t,x=((0,P.useAlert)()||{}).addAlert,B=(0,p.QK)().showModal,N=window.localStorage,R=r().useContext(_.QuickStartContext),F=(0,i.useState)(),K=F[0],z=F[1],M=(0,i.useState)(),U=M[0],Z=M[1],H=(0,i.useState)({}),Q=H[0],G=H[1],Y=(0,i.useState)([]),j=Y[0],q=Y[1],J=(0,i.useState)(!1),W=J[0],X=J[1],$=(0,i.useState)("created_at desc"),ee=$[0],te=$[1],ne=(0,i.useState)(),ae=ne[0],ie=ne[1],re=(0,i.useState)(0),oe=re[0],le=re[1],se=(0,i.useState)(void 0),ce=se[0],ue=se[1],de=(0,i.useState)("name"),ve=de[0],fe=de[1],me=(0,i.useState)([]),ge=me[0],pe=me[1],he=(0,i.useState)(!1),ke=he[0],Se=he[1],Ee=(0,i.useState)(!1),_e=Ee[0],be=Ee[1],we=(0,i.useState)(!1),Pe=we[0],ye=we[1],Ce=(0,i.useState)(void 0),Ie=Ce[0],Te=Ce[1],De=(0,i.useState)(void 0),Ve=De[0],Oe=De[1],Le=(0,i.useState)(),Ae=Le[0],xe=Le[1],Be=ae||{},Ne=Be.activeTab,Re=Be.instanceDetail;(0,i.useEffect)((function(){if((0,k.Qw)()&&N){var e=parseInt(N.getItem("openSessions")||"0"),t=e+1;e<1&&(N.setItem("openSessions",""+t),be(!0))}}),[]);var Fe=function(){be(!_e)};(0,i.useEffect)((function(){(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,s()];case 1:return(e=t.sent())&&(null==j?void 0:j.length)<1&&Ye(),e&&(null==j?void 0:j.length)>0&&Ke(),[2]}}))}))}),[s,j]);var Ke=function(){B(p.Ny.CREATE_KAFKA_INSTANCE,{onCreate:qe,cloudProviders:j,mainToggle:L,refresh:je})},ze=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return t?[4,t(!0)]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return e&&Ke(),[2]}}))}))},Me=function(e){ie({instanceDetail:e,activeTab:"Details"})},Ue=function(e){ie({instanceDetail:e,activeTab:"Connection"})},Ze=function(e){var t,n,a,i,r;(0,k.G6)(e)&&(i=null===(t=e.response)||void 0===t?void 0:t.data.reason,r=null===(a=null===(n=e.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.code),r===k.SM.UNAUTHORIZED_USER?Se(!0):x({variant:v.AlertVariant.danger,title:A("common.something_went_wrong"),description:i})},He=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return i=[],ge.forEach((function(e){var t=e.filterKey,n=e.filterValue;if(n&&n.length>0){var a="(";a+=n.map((function(e){var n=e.value.trim();return n===k.Od.PROVISIONING?t+" = "+k.Od.PREPARING+" or "+t+" = "+k.Od.PROVISIONING:n===k.Od.DEPROVISION?t+" = "+k.Od.DEPROVISION+" or "+t+" = "+k.Od.DELETED:""!==n?t+" "+(!0===e.isExact?"= "+n:"like %"+n+"%"):""})).join(" or "),a+=")",i.push(a)}})),e=i.join(" and "),[4,null==u?void 0:u.kas.getToken()];case 1:if(!(t=a.sent())||!I)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:t,basePath:S})).getKafkas(null==V?void 0:V.toString(),null==O?void 0:O.toString(),ee,e).then((function(e){var t=e.data,n=(null==t?void 0:t.items)||[];G(t),z(n),void 0!==(null==Q?void 0:Q.total)&&Q.total>oe&&le(Q.total),Pe&&ge.length<1&&0==(null==n?void 0:n.length)&&(ue(!0),ye(!1)),X(!0)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Ze(n),[3,5];case 5:return[2]}var i}))}))};(0,i.useEffect)((function(){(!K||(null==K?void 0:K.length)<=1)&&(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==u?void 0:u.kas.getToken()];case 1:if(!(e=n.sent())||!I)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:S})).getKafkas("1","1").then((function(e){var t,n,a=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||void 0===n?void 0:n.length;ue(!a||a<1)}))];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),Ze(t),[3,5];case 5:return[2]}}))}))}),[K]);var Qe=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==u?void 0:u.kas.getToken()];case 1:if(e=a.sent(),t="owner = "+Ve,!e||!I)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:S})).getKafkas("","","",t).then((function(e){var t=e.data;xe(t.items)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Ze(n),[3,5];case 5:return[2]}}))}))};(0,i.useEffect)((function(){Ve&&Qe()}),[Ve]),h((function(){return Qe()}),k.md);var Ge=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==u?void 0:u.kas.getToken()];case 1:if(e=a.sent(),t=Ve?"owner = "+Ve:"",!e||!I)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:S})).getKafkas("1","1","",t).then((function(e){var t=e.data;Z(t.items)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Ze(n),[3,5];case 5:return[2]}}))}))},Ye=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==u?void 0:u.kas.getToken()];case 1:if(!(e=a.sent()))return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:S})).getCloudProviders().then((function(e){var t,n=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||[],a=null==n?void 0:n.filter((function(e){return e.enabled}));q(a)}))];case 3:return a.sent(),[3,5];case 4:return t=a.sent(),n=void 0,(0,k.G6)(t)&&(n=null===(i=t.response)||void 0===i?void 0:i.data.reason),x({variant:v.AlertVariant.danger,title:A("common.something_went_wrong"),description:n}),[3,5];case 5:return[2]}}))}))};(0,i.useEffect)((function(){X(!1),He()}),[u,V,O,ge,ee]),(0,i.useEffect)((function(){Ye(),He()}),[]),(0,i.useEffect)((function(){Ge()}),[]),(0,i.useEffect)((function(){!function(){if(K&&(null==K?void 0:K.length)>0){var e=null==K?void 0:K.filter((function(e){var t;return(null==e?void 0:e.id)===(null===(t=null==ae?void 0:ae.instanceDetail)||void 0===t?void 0:t.id)}))[0],t=(0,a.__assign)((0,a.__assign)({},ae),{instanceDetail:e});e&&ie(t)}}()}),[K]),(0,i.useEffect)((function(){null==u||u.getUsername().then((function(e){return Oe(e)}))}),[u]),(0,i.useEffect)((function(){(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==u?void 0:u.kas.getToken()];case 1:if(!(e=n.sent()))return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:S})).getServiceStatus().then((function(e){var t,n,a=(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.kafkas)||void 0===n?void 0:n.max_capacity_reached)||L;Te(a)}))];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),Ze(t),[3,5];case 5:return[2]}}))}))}),[]),h((function(){return Ge()}),k.md),h((function(){return He()}),k.md);var je=function(){K&&1===(null==K?void 0:K.length)?X(!0):X(!1),He()},qe=function(){le(Q.total+1)},Je=function(){X(!1),le(Q.total-1)};if(ke)return r().createElement(v.PageSection,{variant:v.PageSectionVariants.default,padding:{default:"noPadding"},isFilled:!0},r().createElement(p.C0,{titleProps:{title:A("access_permissions_needed"),headingLevel:"h2"},emptyStateIconProps:{icon:y.ZP},emptyStateBodyProps:{body:A("to_access_kafka_instances_contact_your_organization_administrators")}}));var We,Xe=function(){var e=null==K?void 0:K.filter((function(e){return e.owner===Ve}))[0];return e||(e=null==U?void 0:U.filter((function(e){return e.owner===Ve}))[0]),e},$e=function(){var e=void 0!==Xe(),t="";return(e||Ie)&&(t=Ie&&e?"You can deploy 1 preview instance at a time.":Ie?"Development preview instances are currently unavailable for creation.":"You can deploy 1 preview instance at a time."),t},et=function(){var e=Ie?"Development preview instances are currently unavailable for creation.":"Development preview instances are available for creation. You can deploy 1 preview instance at a time.";return Ie?r().createElement(v.Tooltip,{content:e},r().createElement(v.Label,{icon:r().createElement(m.ZP,null),className:"pf-u-ml-md",tabIndex:0},"No instances available")):r().createElement(v.Tooltip,{content:e},r().createElement(v.Label,{color:"green",icon:r().createElement(g.ZP,null),className:"pf-u-ml-md",tabIndex:0},"Instances available"))};return r().createElement(r().Fragment,null,r().createElement(b.oY,{mainToggle:L,isExpanded:null!=ae,activeTab:Ne,isLoading:void 0===Re,instanceDetail:Re,onClose:function(){ie(null)},"data-ouia-app-id":"controlPlane-streams",tokenEndPointUrl:n,notRequiredDrawerContentBackground:ce},r().createElement("main",{className:"pf-c-page__main"},r().createElement(v.PageSection,{variant:v.PageSectionVariants.light},r().createElement(v.Level,null,r().createElement(v.LevelItem,null,r().createElement(v.TextContent,null,r().createElement(v.Text,{component:"h1"},A("kafka_instances"))))),(We=Xe())?r().createElement(v.Alert,{variant:"info",isInline:!0,title:(null==We?void 0:We.name)+" was created on "+d()(null==We?void 0:We.created_at).format("LLLL"),className:"pf-u-mt-lg"},"This preview instance will expire 48 hours after creation."):r().createElement(r().Fragment,null)),void 0===K?r().createElement(v.PageSection,{variant:v.PageSectionVariants.light,padding:{default:"noPadding"}},r().createElement(p.yR,null)):ce?r().createElement(v.PageSection,{padding:{default:"noPadding"},isFilled:!0},Ie?r().createElement(p.C0,{emptyStateProps:{variant:v.EmptyStateVariant.large},emptyStateIconProps:{icon:m.ZP},emptyStateBodyProps:{body:r().createElement(r().Fragment,null,"Development preview instances are currently unavailable for creation, so check back later. In the meantime,"," ",r().createElement(v.Button,{variant:v.ButtonVariant.link,isSmall:!0,isInline:!0,"data-testid":"emptyState-actionTour"},"take a tour")," ","to learn more about the service.")},titleProps:{title:"Kafka instances unavailable",size:v.TitleSizes.xl,headingLevel:"h2"}}):r().createElement(p.C0,{emptyStateProps:{variant:v.EmptyStateVariant.large},emptyStateIconProps:{icon:f.ZP,color:"green"},emptyStateBodyProps:{body:r().createElement(r().Fragment,null,"Development preview instances are available for creation. For help getting started, access the"," ",r().createElement(v.Button,{variant:v.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:function(){return R.setActiveQuickStart&&R.setActiveQuickStart("getting-started")}},"quick start guide."))},titleProps:{title:"Kafka instances available",size:v.TitleSizes.xl,headingLevel:"h2"}},function(){var e=void 0!==Xe()||Ie;if(e){var t=$e();return r().createElement(v.Tooltip,{content:t},r().createElement(v.Button,{"data-testid":"emptyStateStreams-buttonCreateKafka",variant:v.ButtonVariant.primary,onClick:ze,isAriaDisabled:e},A("create_kafka_instance")))}return r().createElement(v.Button,{"data-testid":"emptyStateStreams-buttonCreateKafka",variant:v.ButtonVariant.primary,onClick:ze},A("create_kafka_instance"))}())):K&&void 0!==ce?r().createElement(v.PageSection,{className:"mk--main-page__page-section--table pf-m-padding-on-xl",variant:v.PageSectionVariants.default,padding:{default:"noPadding"}},r().createElement(v.Card,null,r().createElement(b.fw,{kafkaInstanceItems:K,mainToggle:L,onViewConnection:Ue,onViewInstance:Me,refresh:je,kafkaDataLoaded:W,setWaitingForDelete:ye,onDelete:Je,page:V,perPage:O,total:null==Q?void 0:Q.total,expectedTotal:oe,filteredValue:ge,setFilteredValue:pe,setFilterSelected:fe,filterSelected:ve,orderBy:ee,setOrderBy:te,isDrawerOpen:null!==ae,loggedInUser:Ve,isMaxCapacityReached:Ie,buttonTooltipContent:$e(),isDisabledCreateButton:void 0!==Xe()||Ie,labelWithTooltip:et(),currentUserkafkas:Ae,onCreate:qe,cloudProviders:j}))):r().createElement(r().Fragment,null))),r().createElement(v.Modal,{variant:v.ModalVariant.small,title:"Mobile experience",isOpen:_e,onClose:function(){return Fe()},actions:[r().createElement(v.Button,{key:"confirm",variant:"primary",onClick:function(){return Fe()}},"Ok")]},"The mobile experience isn't fully optimized yet, so some items might not appear correctly."))}}}]);
//# sourceMappingURL=1540.f05e9063.js.map