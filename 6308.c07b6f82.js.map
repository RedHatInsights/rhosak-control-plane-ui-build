{"version":3,"file":"6308.c07b6f82.js","mappings":"yQAcMA,EAA+C,WAC3C,IAAAC,GAAM,IAAAC,kBAAgB,EACxBC,GAAO,IAAAC,WAESC,GAClB,IAAAC,aAAW,gBACPC,GAAa,IAAAC,YAAU,SACzB,GAAkC,UAAhCC,EAAK,QAAEC,EAAS,YAAEC,EAAS,YAC3BC,IAA0BH,MAAAA,OAAK,EAALA,EAAOI,aAAc,IAAE,sBAEnD,GAAsC,IAAAC,WAAS,GAA9CC,EAAc,KAAEC,EAAiB,KAclCC,EAAsB,SAAOC,GAAc,uD,2EAE3B,OADdC,EAAmBD,MAAAA,OAAc,EAAdA,EAAgBE,GACrB,GAAMjB,MAAAA,OAAI,EAAJA,EAAMkB,IAAIC,Y,YAA9BC,EAAc,UAChB,Y,iBASA,O,sBAPMC,EAAc,IAAI,EAAAC,YACtB,IAAI,EAAAC,cAAc,CAChBH,YAAW,EACXlB,SAAQ,KAGZW,GAAkB,GAClB,GAAMQ,EACHG,yBAAyBR,GACzBS,MAAK,SAACC,GACL,IAAMC,EAAaD,MAAAA,OAAQ,EAARA,EAAUE,KAC7BpB,IACAK,GAAkB,GAClBN,EAAU,0BAAwC,CAChDoB,WAAU,EACVE,MAAO/B,EAAE,0D,cARf,S,oBAxBoB,SAACgC,G,MACrBC,GACA,QAAkBD,KACpBC,EAAuB,QAAd,EAAAD,EAAMJ,gBAAQ,eAAEE,KAAKG,QAEhC3B,EAAS,CACPyB,MAAO/B,EAAE,wBACTkC,QAAS,EAAAC,aAAA,OACTC,YAAaH,IA4BXI,C,UACAtB,GAAkB,G,+BAKlBuB,EAAoB,WACxB5B,KAGIQ,EAAmBP,MAAAA,OAAqB,EAArBA,EAAuB4B,KAC1CC,EAAY7B,MAAAA,OAAqB,EAArBA,EAAuB6B,UAEzC,OACE,kBAAC,EAAAC,MAAK,CACJtB,GAAG,8BACHe,QAAS,EAAAQ,aAAA,OACTX,MAAU/B,EAAE,oDAAmD,IAC/D2C,QAAQ,EACRC,QAASN,EACTO,SAAU,KACVC,QAAS,CACP,kBAAC,EAAAC,OAAM,CACLC,IAAI,SACJd,QAAQ,UACRe,KAAK,SACLC,QAAS,WAAM,OAAAlC,EAAoBL,IACnCwC,qBAAsBnD,EAAE,6BACxBoD,UAAWtC,GAEVd,EAAE,yBAEL,kBAAC,EAAA+C,OAAM,CAACC,IAAI,SAASd,QAAQ,OAAOgB,QAASZ,GAC1CtC,EAAE,oBAIP,0BACEqD,wBAAyB,CACvBC,OAAQtD,EAAE,6CAA8C,CACtDkB,iBAAgB,EAChBsB,UAAS,SASrB","sources":["webpack://kas-ui/./src/app/modules/ServiceAccounts/dialogs/ResetServiceAccount/ResetServiceAccount.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  Button,\n  Modal,\n  ModalVariant,\n  AlertVariant,\n} from '@patternfly/react-core';\nimport { useRootModalContext, KAFKA_MODAL_TYPES } from '@app/common';\nimport { isServiceApiError } from '@app/utils';\nimport { getModalAppendTo } from '@app/utils/utils';\nimport { Configuration, SecurityApi } from '@rhoas/kafka-management-sdk';\nimport { useAlert, useAuth, useConfig } from '@rhoas/app-services-ui-shared';\n\nconst ResetServiceAccount: React.FunctionComponent = () => {\n  const { t } = useTranslation();\n  const auth = useAuth();\n  const {\n    kas: { apiBasePath: basePath },\n  } = useConfig();\n  const { addAlert } = useAlert();\n  const { store, showModal, hideModal } = useRootModalContext();\n  const { serviceAccountToReset } = store?.modalProps || {};\n\n  const [isModalLoading, setIsModalLoading] = useState(false);\n\n  const handleServerError = (error: Error) => {\n    let reason: string | undefined;\n    if (isServiceApiError(error)) {\n      reason = error.response?.data.reason;\n    }\n    addAlert({\n      title: t('something_went_wrong'),\n      variant: AlertVariant.danger,\n      description: reason,\n    });\n  };\n\n  const resetServiceAccount = async (serviceAccount) => {\n    const serviceAccountId = serviceAccount?.id;\n    const accessToken = await auth?.kas.getToken();\n    if (accessToken) {\n      try {\n        const apisService = new SecurityApi(\n          new Configuration({\n            accessToken,\n            basePath,\n          })\n        );\n        setIsModalLoading(true);\n        await apisService\n          .resetServiceAccountCreds(serviceAccountId)\n          .then((response) => {\n            const credential = response?.data;\n            hideModal(); // Close first modal\n            setIsModalLoading(false);\n            showModal(KAFKA_MODAL_TYPES.GENERATE_CREDENTIALS, {\n              credential,\n              title: t('serviceAccount.reset_service_account_credentials'),\n            });\n          });\n      } catch (error) {\n        handleServerError(error);\n        setIsModalLoading(false);\n      }\n    }\n  };\n\n  const handleModalToggle = () => {\n    hideModal();\n  };\n\n  const serviceAccountId = serviceAccountToReset?.name;\n  const client_id = serviceAccountToReset?.client_id;\n\n  return (\n    <Modal\n      id='reset-service-account-modal'\n      variant={ModalVariant.medium}\n      title={`${t('serviceAccount.reset_service_account_credentials')}?`}\n      isOpen={true}\n      onClose={handleModalToggle}\n      appendTo={getModalAppendTo}\n      actions={[\n        <Button\n          key='create'\n          variant='primary'\n          type='submit'\n          onClick={() => resetServiceAccount(serviceAccountToReset)}\n          spinnerAriaValueText={t('common.submitting_request')}\n          isLoading={isModalLoading}\n        >\n          {t('serviceAccount.reset')}\n        </Button>,\n        <Button key='cancel' variant='link' onClick={handleModalToggle}>\n          {t('common.cancel')}\n        </Button>,\n      ]}\n    >\n      <span\n        dangerouslySetInnerHTML={{\n          __html: t('serviceAccount.client_secret_will_be_reset', {\n            serviceAccountId,\n            client_id,\n          }),\n        }}\n      />\n    </Modal>\n  );\n};\n\nexport { ResetServiceAccount };\nexport default ResetServiceAccount;\n"],"names":["ResetServiceAccount","t","useTranslation","auth","useAuth","basePath","useConfig","addAlert","useAlert","store","showModal","hideModal","serviceAccountToReset","modalProps","useState","isModalLoading","setIsModalLoading","resetServiceAccount","serviceAccount","serviceAccountId","id","kas","getToken","accessToken","apisService","SecurityApi","Configuration","resetServiceAccountCreds","then","response","credential","data","title","error","reason","variant","AlertVariant","description","handleServerError","handleModalToggle","name","client_id","Modal","ModalVariant","isOpen","onClose","appendTo","actions","Button","key","type","onClick","spinnerAriaValueText","isLoading","dangerouslySetInnerHTML","__html"],"sourceRoot":""}