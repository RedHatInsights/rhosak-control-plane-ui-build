"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[2713],{48090:(e,a,t)=>{t(85893),t(30645),t(28188),t(73685),t(3433)},3433:(e,a,t)=>{t.d(a,{pf:()=>r.p,D5:()=>p,C0:()=>d.C,jU:()=>d.j,yR:()=>v,wu:()=>_.wu,wR:()=>m.w,L5:()=>b.L,bN:()=>_.bN,h0:()=>_.h0});var i=t(85893),n=t(93264);t(50834);var s=t(9922),o=t(28188);var r=t(43277),d=t(12973),l=t(73685),c=t(30645);t(4256);class u extends n.Component{constructor(){super(...arguments),this.state={hasError:!1},this.onClickButton=()=>{const{history:e}=this.props;this.setState({hasError:!1}),e&&e.push("/")}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,a){console.error("error:",e,a)}render(){const{t:e}=this.props,{hasError:a}=this.state;return a?(0,i.jsx)(o.PageSection,Object.assign({padding:{default:"noPadding"},isFilled:!0},{children:(0,i.jsx)(d.C,Object.assign({emptyStateProps:{variant:d.j.UnexpectedError},emptyStateIconProps:{className:"icon-color"},titleProps:{title:e("common.something_went_wrong")},emptyStateBodyProps:{body:e("unexpected_error")}},{children:(0,i.jsx)(o.Button,Object.assign({onClick:this.onClickButton},{children:e("go_to_kafka_instances")}))}))})):this.props.children}}(0,l.withRouter)((0,c.withTranslation)()(u));const v=({bullseyeProps:e,spinnerProps:a})=>(0,i.jsx)(o.Bullseye,Object.assign({},e,{children:(0,i.jsx)(o.Spinner,Object.assign({},a))}));t(85853);const p=({onClose:e,isLoading:a=!0,drawerPanelContentProps:t,drawerHeaderProps:n,isExpanded:r,children:d,panelBodyContent:l,onExpand:c,notRequiredDrawerContentBackground:u,"data-ouia-app-id":p,inlineAlertMessage:_})=>{const m=t||{},{widths:b}=m,h=(0,s.__rest)(m,["widths"]),{text:g,title:y}=n||{},x=(0,i.jsx)(o.DrawerPanelContent,Object.assign({widths:b||{default:"width_50"}},h,{children:a?(0,i.jsx)(v,{}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.DrawerHead,{children:[(0,i.jsxs)(o.TextContent,{children:[(null==g?void 0:g.label)&&(0,i.jsx)(o.Text,Object.assign({component:(null==g?void 0:g.component)||o.TextVariants.small,className:(null==g?void 0:g.className)||"pf-u-mb-0"},{children:null==g?void 0:g.label})),(null==y?void 0:y.value)&&(0,i.jsx)(o.Title,Object.assign({headingLevel:(null==y?void 0:y.headingLevel)||"h2",size:(null==y?void 0:y.size)||o.TitleSizes.xl,className:(null==y?void 0:y.className)||"pf-u-mt-0"},{children:null==y?void 0:y.value}))]}),(0,i.jsx)(o.DrawerActions,{children:(0,i.jsx)(o.DrawerCloseButton,{onClick:e})})]}),(0,i.jsxs)(o.DrawerPanelBody,{children:[_,l]})]})}));return(0,i.jsx)(o.Drawer,Object.assign({isExpanded:r,onExpand:c,"data-ouia-app-id":p,"data-testid":"mk--instance__drawer",className:"kas-drawer"},{children:(0,i.jsx)(o.DrawerContent,Object.assign({panelContent:x,className:u?"pf-m-no-background":""},{children:(0,i.jsxs)(o.DrawerContentBody,Object.assign({className:"pf-u-display-flex pf-u-flex-direction-column"},{children:[" ",d]}))}))}))};var _=t(16846),m=t(69887),b=t(93697);t(8509)},95950:(e,a,t)=>{t.d(a,{A:()=>i.A});var i=t(94622)},217:(e,a,t)=>{t.d(a,{o:()=>h});var i=t(85893),n=t(30645),s=t(9922),o=t(93264),r=t(12902),d=t(93713),l=t(75381),c=t(3433),u=t(28188),v=t(63286),p=t(70792),_=t(61617);const m=(0,o.lazy)((()=>t.e(3495).then(t.bind(t,43495)))),b=({instance:e,activeTab:a,setActiveTab:t,tokenEndPointUrl:b})=>{var h;const{t:g}=(0,n.useTranslation)(["kasTemporaryFixMe"]),y=(0,_.s9)(),[x,f]=(0,o.useState)([]);(0,o.useEffect)((()=>{(0,s.__awaiter)(void 0,void 0,void 0,(function*(){const{marketplaceSubscriptions:e}=yield y();f(e)}))}),[y]);const w=e.status===l.Od.ACCEPTED||e.status===l.Od.PREPARING,k=null===(h=x.find((a=>a.subscriptions.find((a=>a===e.billing_cloud_account_id)))))||void 0===h?void 0:h.marketplace,j="standard"===e.billing_model?"prepaid":k?{marketplace:k,subscription:e.billing_cloud_account_id}:void 0;return(0,i.jsx)(o.Suspense,Object.assign({fallback:(0,i.jsx)(c.yR,{})},{children:(0,i.jsxs)(u.Tabs,Object.assign({activeKey:a,onSelect:(e,a)=>t(a)},{children:[(0,i.jsx)(u.Tab,Object.assign({eventKey:v.Z.DETAILS,title:(0,i.jsx)(u.TabTitleText,{children:g("details")})},{children:(0,i.jsx)(p.KafkaDetailsTab,{id:e.id,owner:e.owner,createdAt:(0,r.Z)(e.created_at),updatedAt:(0,r.Z)(e.updated_at),expiryDate:(0,d.Z)((0,r.Z)(e.created_at),48),size:e.size.display_name,ingress:(e.size.ingress_throughput_per_sec.bytes||0)/1048576,egress:(e.size.egress_throughput_per_sec.bytes||0)/1048576,storage:Math.round((e.size.max_data_retention_size.bytes||0)/1073741824),maxPartitions:e.size.max_partitions,connections:e.size.total_max_connections,connectionRate:e.size.max_connection_attempts_per_sec,messageSize:(e.size.max_message_size.bytes||0)/1048576,region:g(e.region),instanceType:"standard"===e.instance_type?"standard":"eval",billing:j,kafkaVersion:e.version})})),(0,i.jsx)(u.Tab,Object.assign({eventKey:v.Z.CONNECTION.toString(),title:(0,i.jsx)(u.TabTitleText,{children:g("connection")}),"data-testid":"drawerStreams-tabConnect"},{children:(0,i.jsx)(m,{externalServer:(()=>{const{bootstrap_server_host:a}=e;return(null==a?void 0:a.endsWith(":443"))?a:`${a}:443`})(),adminServerUrl:(()=>{const{admin_api_server_url:a}=e;return a?`${a}/openapi`:void 0})(),isKafkaPending:w,tokenEndPointUrl:b,instanceId:e.id})}))]}))}))},h=({"data-ouia-app-id":e,isDrawerOpen:a,drawerInstance:t,setDrawerActiveTab:s,drawerActiveTab:o,closeDrawer:r,tokenEndPointUrl:d,children:l})=>{const{t:u}=(0,n.useTranslation)(["kasTemporaryFixMe"]);return(0,i.jsx)(c.D5,Object.assign({isExpanded:a,isLoading:void 0===t,onClose:r,panelBodyContent:t&&(0,i.jsx)(b,{tokenEndPointUrl:d,activeTab:o||v.Z.DETAILS,instance:t,setActiveTab:s}),drawerHeaderProps:{text:{label:u("instance_name")},title:{value:null==t?void 0:t.name,headingLevel:"h1"}},"data-ouia-app-id":e,notRequiredDrawerContentBackground:void 0===t},{children:l}))}},61617:(e,a,t)=>{t.d(a,{b4:()=>u,qT:()=>c,DO:()=>g.D,TM:()=>v,AU:()=>_,dt:()=>m,df:()=>b,s9:()=>l});var i=t(9922),n=t(88601),s=t(75381),o=t(50834),r=t(93264);const d="rhosak",l=()=>{const e=(0,n.c)();return(0,r.useCallback)((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var a,t,i,n;const s=e(),o=yield s.apiAccountsMgmtV1CurrentAccountGet(),r=null===(t=null===(a=null==o?void 0:o.data)||void 0===a?void 0:a.organization)||void 0===t?void 0:t.id;if(!r)throw new Error("User has no organization id");const l=yield s.apiAccountsMgmtV1OrganizationsOrgIdQuotaCostGet(r,void 0,!0,void 0,!0);if(200!==l.status)throw new Error(l.statusText);const c=null===(i=l.data.items)||void 0===i?void 0:i.filter((e=>{var a;return null===(a=e.related_resources)||void 0===a?void 0:a.find((e=>e.resource_name===d&&"RHOSAK"===e.product))})),u=null==c?void 0:c.find((e=>{var a;return null===(a=e.related_resources)||void 0===a?void 0:a.find((e=>"standard"===e.billing_model))})),v=null==c?void 0:c.filter((e=>{var a;return null===(a=e.related_resources)||void 0===a?void 0:a.find((e=>"marketplace"===e.billing_model))})),p=(null===(n=l.data.items)||void 0===n?void 0:n.some((e=>{var a;return null===(a=e.related_resources)||void 0===a?void 0:a.find((e=>e.resource_name===d&&"RHOSAKTrial"===e.product))})))||!1,_=u?u.allowed-u.consumed:void 0,m=null==v?void 0:v.reduce(((e,a)=>a.allowed-a.consumed+e),0),b=null==v?void 0:v.filter((e=>void 0!==e.cloud_accounts)).flatMap((e=>e.cloud_accounts)),h=Array.from(new Set(null==b?void 0:b.map((e=>e.cloud_provider_id))));return{hasTrialQuota:p,remainingPrepaidQuota:_,remainingMarketplaceQuota:m,marketplaceSubscriptions:b?h.map((e=>({marketplace:e,subscriptions:b.filter((a=>a.cloud_provider_id===e)).map((e=>e.cloud_account_id))}))):[]}}))),[e])},c=()=>{const e=l();return(0,r.useCallback)((({onNoQuotaAvailable:a,onOutOfQuota:t,onQuotaAvailable:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const{hasTrialQuota:i,remainingPrepaidQuota:s,remainingMarketplaceQuota:o,marketplaceSubscriptions:r}=yield e();o||s?o&&0===o&&s&&0===s?t({quota:{marketplaceSubscriptions:r}}):n({quota:{remainingPrepaidQuota:s,remainingMarketplaceQuota:o,marketplaceSubscriptions:r}}):a({hasTrialQuota:i})}catch(e){a({hasTrialQuota:!1})}}))),[e])},u=()=>{const{getUsername:e}=(0,o.useAuth)(),a=(0,n.d)(),t=(0,r.useCallback)((({onAvailable:t,onUnavailable:n,onUsed:o})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const i=a(),n=`owner = ${yield e()}`,r=yield i.getKafkas("","","",n);if(r.data.items){r.data.items.some((e=>(null==e?void 0:e.instance_type)===(null===s.ik||void 0===s.ik?void 0:s.ik.eval)||(null==e?void 0:e.instance_type)===(null===s.ik||void 0===s.ik?void 0:s.ik.developer)))?o():t()}}catch(e){n()}}))),[a,e]);return t},v=()=>{const e=(0,n.d)(),a=p(),t=(0,r.useCallback)(((t,{onAvailable:n,onUnavailable:s})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var o;try{const s=e(),r=yield s.getCloudProviders(),d=(null===(o=null==r?void 0:r.data)||void 0===o?void 0:o.items)||[],l=yield Promise.all(d.filter((e=>e.enabled)).map((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=yield a(e.id,t);return{id:e.id,displayName:e.display_name,regions:i}}))))),c=l[0];n({providers:l,defaultProvider:null==c?void 0:c.id})}catch(e){s()}}))),[a,e]);return t},p=()=>{const e=(0,n.d)();return(0,r.useCallback)((function(a,t){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e(),s=yield i.getCloudProviderRegions(a);if(!(null===(n=null==s?void 0:s.data)||void 0===n?void 0:n.items))return[];return s.data.items.filter((e=>e.enabled&&e.capacity.some((e=>e.instance_type===t)))).map((e=>{var a;const i=null===(a=e.capacity)||void 0===a?void 0:a.some((e=>{var a;return e.instance_type===t&&0===(null===(a=e.available_sizes)||void 0===a?void 0:a.length)}));return{id:e.id,displayName:e.display_name,isDisabled:i,capacity:e.capacity}}))}))}),[e])},_=e=>{const a=(0,n.d)(),t=p();return(0,r.useCallback)(((n,s)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,o,r;const d=a(),l=(yield t(n,e)).find((e=>e.id===s)),c=(null==l?void 0:l.capacity.flatMap((e=>e.available_sizes.map((a=>`${e.instance_type}.${a}`)))))||[],u=yield d.getInstanceTypesByCloudProviderAndRegion(n,s);if(!(null===(i=null==u?void 0:u.data)||void 0===i?void 0:i.instance_types))throw new Error("No instance_types from backend");return((null===(r=null===(o=null==u?void 0:u.data)||void 0===o?void 0:o.instance_types.find((a=>a.id===e)))||void 0===r?void 0:r.sizes)||[]).map(h.bind(void 0,(a=>!c.includes(`${e}.${a}`))))}))),[t,a,e])},m=()=>_("standard"),b=()=>{const e=_("standard"),a=_("developer");return(0,r.useCallback)(((t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let i;try{i=yield e(t,n)}catch(e){i=[{id:"1",displayName:"1"},{id:"2",displayName:"2"}]}return{standard:i,trial:(yield a(t,n))[0]}}))),[a,e])};function h(e,a){const t=a;return{id:t.id,displayName:t.display_name,quota:t.quota_consumed,ingress:(t.ingress_throughput_per_sec.bytes||0)/1048576,egress:(t.egress_throughput_per_sec.bytes||0)/1048576,storage:Math.round((t.max_data_retention_size.bytes||0)/1073741824),connections:t.total_max_connections,connectionRate:t.max_connection_attempts_per_sec,maxPartitions:t.max_partitions,messageSize:(t.max_message_size.bytes||0)/1048576,status:"stable"===t.maturity_status?"stable":"preview",trialDurationHours:t.lifespan_seconds?t.lifespan_seconds/60/60:0,isDisabled:e(t.id)}}var g=t(46163)},82519:(e,a,t)=>{t(93264)}}]);
//# sourceMappingURL=2713.54e41088.js.map