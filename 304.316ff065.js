(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[304],{58773:(e,t,a)=>{"use strict";t.wP={name:"TachometerAltIcon",height:512,width:576,svgPath:"M288 32C128.94 32 0 160.94 0 320c0 52.8 14.25 102.26 39.06 144.8 5.61 9.62 16.3 15.2 27.44 15.2h443c11.14 0 21.83-5.58 27.44-15.2C561.75 422.26 576 372.8 576 320c0-159.06-128.94-288-288-288zm0 64c14.71 0 26.58 10.13 30.32 23.65-1.11 2.26-2.64 4.23-3.45 6.67l-9.22 27.67c-5.13 3.49-10.97 6.01-17.64 6.01-17.67 0-32-14.33-32-32S270.33 96 288 96zM96 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm48-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm246.77-72.41l-61.33 184C343.13 347.33 352 364.54 352 384c0 11.72-3.38 22.55-8.88 32H232.88c-5.5-9.45-8.88-20.28-8.88-32 0-33.94 26.5-61.43 59.9-63.59l61.34-184.01c4.17-12.56 17.73-19.45 30.36-15.17 12.57 4.19 19.35 17.79 15.17 30.36zm14.66 57.2l15.52-46.55c3.47-1.29 7.13-2.23 11.05-2.23 17.67 0 32 14.33 32 32s-14.33 32-32 32c-11.38-.01-20.89-6.28-26.57-15.22zM480 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z",yOffset:0,xOffset:0},t.Le=a(35183).createIcon(t.wP),t.ZP=t.Le},2112:(e,t,a)=>{"use strict";t.MS={name:"WrenchIcon",height:512,width:512,svgPath:"M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z",yOffset:0,xOffset:0},t.R0=a(35183).createIcon(t.MS),t.ZP=t.R0},9914:(e,t)=>{"use strict";t.VQ={name:"--pf-chart-color-black-500",value:"#6a6e73",var:"var(--pf-chart-color-black-500)"},t.ZP=t.VQ},84076:(e,t)=>{"use strict";t.iY={name:"--pf-chart-color-blue-300",value:"#06c",var:"var(--pf-chart-color-blue-300)"},t.ZP=t.iY},72021:(e,t)=>{"use strict";t.R0={name:"--pf-chart-color-green-300",value:"#4cb140",var:"var(--pf-chart-color-green-300)"},t.ZP=t.R0},82874:(e,t)=>{"use strict";t.g9={name:"--pf-chart-color-orange-300",value:"#ec7a08",var:"var(--pf-chart-color-orange-300)"},t.ZP=t.g9},37472:(e,t,a)=>{"use strict";a.d(t,{K:()=>r});var n=a(48121);function r(e,t){var a=(0,n.useRef)();(0,n.useEffect)((function(){a.current=e}),[e]),(0,n.useEffect)((function(){if(null!==t){var e=setTimeout((function(){a.current()}),t);return function(){clearInterval(e)}}}),[e,t])}},66151:(e,t,a)=>{"use strict";a.d(t,{g:()=>c});var n=a(48121),r=a.n(n),o=a(58788),i=a(58773),l=a(2112),s=a(61179),c=function(e){var t=e.title,a=e.body,n=e.noData,c=e.noTopics,u=e.noFilter;return r().createElement(o.EmptyState,{variant:o.EmptyStateVariant.xs},r().createElement(o.EmptyStateIcon,{icon:n?i.ZP:c?l.ZP:u?s.FilterIcon:void 0}),r().createElement(o.Title,{headingLevel:"h3",size:"lg"},t),r().createElement(o.EmptyStateBody,null,a,r().createElement("br",null),r().createElement("br",null),c&&r().createElement(o.Button,{variant:"primary"},"Create Topic")))}},49304:(e,t,a)=>{"use strict";a.d(t,{jo:()=>S,fo:()=>T,iG:()=>w});var n=a(70655),r=a(48121),o=a.n(r),i=a(38936),l=a(86150),s=a(46748),c=a(75381),u=a(58788),m=a(82821),d=a(84076),p=a(9914),h=a(88289),f=a(66151),v=a(37472),y=a(23535),E=a.n(y),b=function(e,t){var a="B";return e.sortedData.map((function(e){e.bytes.forEach((function(e){var t=E()(e).unit;"kB"===t&&"B"===a&&(a="kB"),"MB"===t&&("B"!==a&&"kB"!==a||(a="MB")),"GB"===t&&("B"!==a&&"kB"!==a&&"MB"!==a||(a="GB"))}))})),t.sortedData.map((function(e){e.bytes.forEach((function(e){var t=E()(e).unit;"kB"===t&&"B"===a&&(a="kB"),"MB"===t&&("B"!==a&&"kB"!==a||(a="MB")),"GB"===t&&("B"!==a&&"kB"!==a&&"MB"!==a||(a="GB"))}))})),a},_=function(e,t){return"B"===t?Math.round(10*e)/10:"kB"===t?Math.round(e/1024*10)/10:"MB"===t?Math.round(e/1024/1024*10)/10:"GB"===t?Math.round(e/1024/1024/1024*10)/10:void 0},g=a(61179),k=function(e){var t=e.title,a=e.showTopicFilter,n=e.setTimeInterval,i=(e.showKafkaToolbar,e.showTopicToolbar,e.setSelectedTopic),l=e.selectedTopic,s=(0,r.useState)(!1),c=s[0],m=s[1],d=(0,r.useState)(!1),p=d[0],h=d[1],f=(0,r.useState)(!1),v=f[0],y=f[1],E=function(e){h(e)},b=function(e,t){n(_(t)),m(t),h(!1)},_=function(e){var t=1;switch(e){case"Last 1 hour":t=1;break;case"Last 2 hour":t=2;break;case"Last 4 hour":t=4;break;case"Last 6 hour":t=6;break;case"Last 12 hour":t=12;break;case"Last 24 hour":t=24;break;case"Last 2 days":t=48;break;case"Last 3 days":t=72;break;case"Last 4 days":t=96;break;case"Last 5 days":t=120;break;case"Last 6 days":t=144;break;case"Last 7 days":t=168}return t},k=function(e){y(e)},w=function(e,t){i&&i(t),y(!1)},C=function(e){return o().createElement(u.ToolbarItem,null,o().createElement(u.Select,{variant:u.SelectVariant.single,"aria-label":"Select Input",onToggle:E,onSelect:b,selections:c,isOpen:p,isDisabled:!0},o().createElement(u.SelectOption,{key:0,value:"Last 1 hour"}),o().createElement(u.SelectOption,{key:1,value:"Last 2 hour"}),o().createElement(u.SelectOption,{key:2,value:"Last 4 hour"}),o().createElement(u.SelectOption,{key:3,value:"Last 6 hour",isPlaceholder:!0}),o().createElement(u.SelectOption,{key:4,value:"Last 12 hour"}),o().createElement(u.SelectOption,{key:5,value:"Last 24 hour"}),o().createElement(u.SelectOption,{key:6,value:"Last 2 days"}),o().createElement(u.SelectOption,{key:7,value:"Last 3 days"}),o().createElement(u.SelectOption,{key:8,value:"Last 4 days"}),o().createElement(u.SelectOption,{key:9,value:"Last 5 days"}),o().createElement(u.SelectOption,{key:10,value:"Last 6 days"}),o().createElement(u.SelectOption,{key:11,value:"Last 7 days"})))},S=function(e,t){return D},D=[o().createElement(u.SelectGroup,{label:"Filter by topic",key:"group1"},o().createElement(u.SelectOption,{key:0,value:"topic-1"}),o().createElement(u.SelectOption,{key:1,value:"topic-2"}))];return o().createElement(o().Fragment,null,o().createElement(u.Level,null,o().createElement(u.LevelItem,null,o().createElement(u.CardTitle,{component:"h2"},t)),o().createElement(u.LevelItem,null,a?o().createElement(u.Toolbar,null,o().createElement(u.ToolbarContent,null,o().createElement(u.ToolbarItem,null,o().createElement(u.Select,{variant:u.SelectVariant.single,onToggle:k,onSelect:w,selections:l,isOpen:v,placeholderText:"All Topics","aria-labelledby":"titleId",onFilter:S,isGrouped:!0,hasInlineFilter:!0,isDisabled:!0},D)),C(),o().createElement(u.Button,{variant:"plain","aria-label":"sync"},o().createElement(g.SyncIcon,null)))):o().createElement(u.Toolbar,null,o().createElement(u.ToolbarContent,null,C(),o().createElement(u.Button,{variant:"plain","aria-label":"sync"},o().createElement(g.SyncIcon,null)))))),o().createElement(u.Divider,null))},w=function(e){var t=e.kafkaID,a=e.metricsDataUnavailable,y=e.setMetricsDataUnavailable,E=(0,r.useRef)(),b=(0,i.useTranslation)().t,g=(0,s.useAuth)(),w=(0,s.useConfig)().kas.apiBasePath,C=(0,s.useAlert)().addAlert,S=(0,r.useState)(),D=S[0],T=S[1],B=(0,r.useState)(),L=B[0],A=B[1],P=(0,r.useState)(),x=P[0],M=P[1],z=(0,r.useState)(!0),I=z[0],G=z[1],O=(0,r.useState)(),Z=O[0],V=O[1],F=(0,r.useState)(6),R=F[0],U=F[1],W=function(){return E.current&&T(E.current.clientWidth)},K=D&&D>650?6:3,Q=function(){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e,a,r,o,i,s,m,d;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==g?void 0:g.kas.getToken()];case 1:if(void 0===(e=n.sent())||""===e)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),a=new l.DefaultApi(new l.Configuration({accessToken:e,basePath:w})),t?[4,a.getMetricsByRangeQuery(t,60*R,300,["kubelet_volume_stats_used_bytes"])]:[2];case 3:return r=n.sent(),o={name:"Used disk space",data:[]},r.data.items?(y(!1),null===(m=r.data.items)||void 0===m||m.forEach((function(e,t){var a,n=e.metric;if(void 0===n)throw new Error("item.metric cannot be undefined");if(void 0===e.values)throw new Error("item.values cannot be undefined");"kubelet_volume_stats_used_bytes"===n.__name__&&(n.persistentvolumeclaim.includes("zookeeper")||null===(a=e.values)||void 0===a||a.forEach((function(e,a){if(null==e.timestamp)throw new Error("timestamp cannot be undefined");if(t>0){var n=o.data[a].usedSpaceAvg.concat(e.value);o.data[a].usedSpaceAvg=n}else o.data.push({timestamp:e.timestamp,usedSpaceAvg:[e.value]})})));N(o)}))):(y(!0),G(!1)),[3,5];case 4:return i=n.sent(),s=void 0,(0,c.G6)(i)&&(s=null===(d=i.response)||void 0===d?void 0:d.data.reason),C({variant:u.AlertVariant.danger,title:b("common.something_went_wrong"),description:s}),[3,5];case 5:return[2]}}))}))};(0,r.useEffect)((function(){Q(),W()}),[R]),(0,v.K)((function(){return Q()}),3e5),(0,r.useEffect)((function(){W(),window.addEventListener("resize",W)}),[D]);var N=function(e){var t=[{name:"Limit",symbol:{fill:p.ZP.value,type:"threshold"}},{name:e.name,symbol:{fill:d.ZP.value}}],a=d.ZP.value,n=p.ZP.value,r=[],o=[],i=[],l=function(){return(e.data[e.data.length-1].timestamp-e.data[0].timestamp)/1e3/60},s=360-l(),c=(360-l())/5;if(s<=360)for(var u=0;u<c;u+=1){var m=e.data[0].timestamp-3e5*(c-u),f=new Date(m),v=(0,h.format)(f,"hh:mm");o.push({name:e.name,x:v,y:0}),i.push({name:"Limit",x:v,y:60})}e.data.map((function(t){var a=new Date(t.timestamp),n=(0,h.format)(a,"hh:mm"),r=t.usedSpaceAvg.reduce((function(e,t){return e+t}),0),l=_(r,"GB");o.push({name:e.name,x:n,y:l}),i.push({name:"Limit",x:n,y:60})})),r.push({areaColor:a,softLimitColor:n,area:o,softLimit:i}),A(t),M(r),V("GB"),G(!1)};return o().createElement(u.Card,null,o().createElement(k,{showTopicFilter:!1,title:b("metrics.kafka_instance_metrics"),setTimeInterval:U,showKafkaToolbar:!a}),o().createElement(u.CardTitle,{component:"h2"},b("metrics.used_disk_space")),o().createElement(u.CardBody,null,o().createElement("div",{ref:E},I?o().createElement(u.Bullseye,null,o().createElement(u.Spinner,{isSVG:!0})):a?o().createElement(f.g,{title:b("metrics.empty_state_no_data_title"),body:b("metrics.empty_state_no_data_body"),noData:!0}):x&&L&&Z&&o().createElement(m.Chart,{ariaDesc:b("metrics.used_disk_space"),ariaTitle:"Disk Space",containerComponent:o().createElement(m.ChartVoronoiContainer,{labels:function(e){var t=e.datum;return t.name+": "+t.y},constrainToVisibleArea:!0}),legendPosition:"bottom-left",legendComponent:o().createElement(m.ChartLegend,{orientation:"horizontal",data:L,itemsPerRow:K}),height:350,padding:{bottom:110,left:90,right:60,top:25},themeColor:m.ChartThemeColor.multiUnordered,width:D,minDomain:{y:0},legendAllowWrap:!0},o().createElement(m.ChartAxis,{label:"Time",tickCount:6}),o().createElement(m.ChartAxis,{dependentAxis:!0,tickFormat:function(e){return Math.round(e)+" "+Z},tickCount:4}),o().createElement(m.ChartGroup,null,x.map((function(e,t){return o().createElement(m.ChartArea,{key:"chart-area-"+t,data:e.area,interpolation:"monotoneX",style:{data:{stroke:e.color}}})}))),o().createElement(m.ChartThreshold,{key:"chart-softlimit",data:x[0].softLimit,style:{data:{stroke:x[0].softLimitColor}}})))))},C=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,n.__extends)(t,e),t.prototype.render=function(){var e=(0,m.createContainer)("voronoi","cursor"),t=[],a=[];return this.props.topics.forEach((function(e){t.push({name:e.name});var n=e.data.map((function(t){var a=new Date(t.timestamp);return{x:(0,h.format)(a,"hh:mm"),y:t.count,name:e.name}}));a.push(n)})),console.log(this.props.topics),o().createElement("div",{style:{height:"300x",width:"450px"}},o().createElement(m.Chart,{ariaDesc:"Messages in to a topic",ariaTitle:"Messages in",containerComponent:o().createElement(e,{cursorDimension:"x",labels:function(e){return""+e.datum.y},labelComponent:o().createElement(m.ChartLegendTooltip,{legendData:t,title:function(e){return e.x}}),mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:50}),legendData:t,legendPosition:"bottom",height:300,maxDomain:{y:10},minDomain:{y:0},padding:{bottom:100,left:70,right:50,top:50},themeColor:m.ChartThemeColor.green,width:450},o().createElement(m.ChartAxis,{label:"time",tickCount:6}),o().createElement(m.ChartAxis,{dependentAxis:!0,showGrid:!0,label:"messages"}),o().createElement(m.ChartGroup,null,a.map((function(e,t){return o().createElement(m.ChartLine,{data:e,key:"chart-messages-"+t})})))))}}(o().Component),a(82874)),S=function(e){var t=e.kafkaID,a=e.metricsDataUnavailable,p=e.setMetricsDataUnavailable,y=(0,i.useTranslation)().t,E=(0,s.useAuth)(),g=(0,s.useConfig)().kas.apiBasePath,w=(0,s.useAlert)().addAlert,S=(0,r.useRef)(),D=(0,r.useState)(),B=D[0],L=D[1],A=(0,r.useState)(6),P=A[0],x=A[1],M=(0,r.useState)(!1),z=M[0],I=M[1],G=function(){return S.current&&L(S.current.clientWidth)},O=B&&B>650?6:3;(0,r.useEffect)((function(){G(),window.addEventListener("resize",G)}),[B]);var Z=(0,r.useState)(),V=Z[0],F=Z[1],R=(0,r.useState)(),U=R[0],W=R[1],K=(0,r.useState)(),Q=K[0],N=K[1],X=(0,r.useState)(),Y=X[0],j=X[1],H=(0,r.useState)(!0),J=H[0],q=H[1],$=function(){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e,a,r,o,i,s,m,d,h,f,v;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==E?void 0:E.kas.getToken()];case 1:if(void 0===(e=n.sent())||""===e)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),a=new l.DefaultApi(new l.Configuration({accessToken:e,basePath:g})),t?[4,a.getMetricsByRangeQuery(t,60*P,300,["kafka_server_brokertopicmetrics_bytes_in_total","kafka_server_brokertopicmetrics_bytes_out_total"])]:[2];case 3:return r=n.sent(),o={name:"Total incoming bytes",rawData:new Map},i={name:"Total outgoing bytes",rawData:new Map},r.data.items?(p(!1),null===(f=r.data.items)||void 0===f||f.forEach((function(e,t){var a,n,r=e.metric;if(void 0===r)throw new Error("item.metric cannot be undefined");if(void 0===e.values)throw new Error("item.values cannot be undefined");console.log("what is label here"+r.topic),"__strimzi_canary"!==r.topic&&"__consumer_offsets"!==r.topic&&("kafka_server_brokertopicmetrics_bytes_in_total"===r.__name__&&(null===(a=e.values)||void 0===a||a.forEach((function(e,t){var a;if(null==e.timestamp)throw new Error("timestamp cannot be undefined");o.rawData.has(e.timestamp)?null===(a=o.rawData.get(e.timestamp))||void 0===a||a.push(e.value):o.rawData.set(e.timestamp,[e.value])}))),"kafka_server_brokertopicmetrics_bytes_out_total"===r.__name__&&(null===(n=e.values)||void 0===n||n.forEach((function(e,t){var a;if(null==e.timestamp)throw new Error("timestamp cannot be undefined");i.rawData.has(e.timestamp)?null===(a=i.rawData.get(e.timestamp))||void 0===a||a.push(e.value):i.rawData.set(e.timestamp,[e.value])}))))})),o.rawData.size<1&&i.rawData.size<1?(j(!0),q(!1)):(s=[],o.rawData.forEach((function(e,t){return s.push({timestamp:t,bytes:e})})),o.sortedData=s.sort((function(e,t){return e.timestamp-t.timestamp})),m=[],i.rawData.forEach((function(e,t){return m.push({timestamp:t,bytes:e})})),i.sortedData=m.sort((function(e,t){return e.timestamp-t.timestamp})),ee(o,i))):(p(!0),q(!1)),[3,5];case 4:return d=n.sent(),h=void 0,(0,c.G6)(d)&&(h=null===(v=d.response)||void 0===v?void 0:v.data.reason),w({variant:u.AlertVariant.danger,title:y("common.something_went_wrong"),description:h}),[3,5];case 5:return[2]}}))}))};(0,r.useEffect)((function(){$()}),[P]),(0,v.K)((function(){return $()}),3e5);var ee=function(e,t){var a=[],n=[],r=b(e,t);if(e){var o=[],i=d.ZP.value,l=360-(f=function(){return(e.sortedData[e.sortedData.length-1].timestamp-e.sortedData[0].timestamp)/1e3/60})(),s=(360-f())/5;if(l<=360)for(var c=0;c<s;c+=1){var u=e.sortedData[0].timestamp-3e5*(s-c),m=new Date(u),p=(0,h.format)(m,"hh:mm");o.push({name:e.name,x:p,y:0})}e.sortedData.map((function(t){var a=new Date(t.timestamp),n=(0,h.format)(a,"hh:mm"),i=t.bytes.reduce((function(e,t){return e+t}),0),l=_(i,r);o.push({name:e.name,x:n,y:l})})),n.push({color:i,line:o}),a.push({name:e.name,symbol:{fill:d.ZP.value}})}if(t){var f,v=[];i=C.ZP.value,l=360-(f=function(){return(t.sortedData[t.sortedData.length-1].timestamp-t.sortedData[0].timestamp)/1e3/60})(),s=(360-f())/5;if(l<=360)for(c=0;c<s;c+=1){u=t.sortedData[0].timestamp-3e5*(s-c),m=new Date(u),p=(0,h.format)(m,"hh:mm");v.push({name:t.name,x:p,y:0})}t.sortedData.map((function(e){var a=new Date(e.timestamp),n=(0,h.format)(a,"hh:mm"),o=e.bytes.reduce((function(e,t){return e+t}),0),i=_(o,r);v.push({name:t.name,x:n,y:i})})),n.push({color:i,line:v}),a.push({name:t.name,symbol:{fill:C.ZP.value}})}W(a),F(n),N(r),q(!1)};return o().createElement(u.Card,null,o().createElement(k,{showTopicFilter:!0,title:y("metrics.topic_metrics"),setTimeInterval:x,showTopicToolbar:!Y&&!a,selectedTopic:z,setSelectedTopic:I}),o().createElement(u.CardTitle,{component:"h2"},y("metrics.total_bytes")),o().createElement(u.CardBody,null,o().createElement("div",{ref:S},o().createElement("div",null,J?o().createElement(u.Bullseye,null,o().createElement(u.Spinner,{isSVG:!0})):a?o().createElement(f.g,{title:y("metrics.empty_state_no_data_title"),body:y("metrics.empty_state_no_data_body"),noData:!0}):Y?o().createElement(f.g,{title:y("metrics.empty_state_no_topics_title"),body:y("metrics.empty_state_no_topics_body"),noTopics:!0}):V&&U&&Q&&o().createElement(o().Fragment,null,o().createElement(m.Chart,{ariaDesc:y("metrics.total_bytes"),ariaTitle:"Total Bytes",containerComponent:o().createElement(m.ChartVoronoiContainer,{labels:function(e){var t=e.datum;return t.name+": "+t.y},constrainToVisibleArea:!0}),legendAllowWrap:!0,legendPosition:"bottom-left",legendComponent:o().createElement(m.ChartLegend,{data:U,itemsPerRow:O}),height:300,padding:{bottom:110,left:90,right:30,top:25},themeColor:m.ChartThemeColor.multiUnordered,width:B},o().createElement(m.ChartAxis,{label:"Time",tickCount:6}),o().createElement(m.ChartAxis,{dependentAxis:!0,tickFormat:function(e){return Math.round(e)+" "+Q},tickCount:4,minDomain:{y:0}}),o().createElement(m.ChartGroup,null,V.map((function(e,t){return o().createElement(m.ChartLine,{key:"chart-line-"+t,data:e.line,style:{data:{stroke:e.color}}})})))),o().createElement(u.Divider,null),z?o().createElement(T,{kafkaID:t}):o().createElement(f.g,{title:y("metrics.empty_state_no_filter_title"),body:y("metrics.empty_state_no_filter_body"),noFilter:!0}))))))},D=a(72021),T=function(e){var t=e.kafkaID,a=(0,r.useRef)(),p=(0,i.useTranslation)().t,y=(0,s.useAuth)(),g=(0,s.useConfig)().kas.apiBasePath,k=(0,s.useAlert)().addAlert,w=(0,r.useState)(),C=w[0],S=w[1],T=(0,r.useState)(),B=T[0],L=T[1],A=(0,r.useState)(),P=A[0],x=A[1],M=(0,r.useState)(),z=M[0],I=M[1],G=(0,r.useState)(!1),O=G[0],Z=G[1],V=(0,r.useState)(!0),F=V[0],R=V[1],U=(0,r.useState)(),W=U[0],K=U[1],Q=[D.ZP.value,d.ZP.value],N=function(){return a.current&&S(a.current.clientWidth)},X=C&&C>650?6:3,Y=function(){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e,a,r,o,i,s,m,d,h;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==y?void 0:y.kas.getToken()];case 1:if(void 0===(e=n.sent())||""===e)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),a=new l.DefaultApi(new l.Configuration({accessToken:e,basePath:g})),t?[4,a.getMetricsByRangeQuery(t,360,300,["kafka_log_log_size"])]:[2];case 3:return r=n.sent(),console.log("what is data log size per partition"+JSON.stringify(r)),o=[],r.data.items?(Z(!1),null===(d=r.data.items)||void 0===d||d.forEach((function(e,t){var a,n,r=null===(a=null==e?void 0:e.metric)||void 0===a?void 0:a.topic,i={name:r,data:[]},l=o.some((function(e){return e.name===r}));null===(n=e.values)||void 0===n||n.forEach((function(e){if(null==e.timestamp)throw new Error("timestamp cannot be undefined");l?o.map((function(t){t.name===r&&t.data.forEach((function(t){t.bytes=t.bytes+e.value}))})):i.data.push({name:r,timestamp:e.timestamp,bytes:e.value})})),l||o.push(i)})),i=o.filter((function(e){return"__strimzi_canary"!==e.name&&"__consumer_offsets"!==e.name})),console.log("what is filteredTopics for logsize"+i),i.length<1&&K(!0),j(i)):(Z(!0),R(!1)),[3,5];case 4:return s=n.sent(),m=void 0,(0,c.G6)(s)&&(m=null===(h=s.response)||void 0===h?void 0:h.data.reason),k({variant:u.AlertVariant.danger,title:p("common.something_went_wrong"),description:m}),[3,5];case 5:return[2]}}))}))};(0,r.useEffect)((function(){Y(),N()}),[]),(0,v.K)((function(){return Y()}),3e5),(0,r.useEffect)((function(){N(),window.addEventListener("resize",N)}),[C]);var j=function(e){console.log("what is partitionArray"+e);var t=[],a=[],n=b(e);e.map((function(e,r){var o=Q[r];t.push({name:e.name});var i=[],l=function(){return(e.data[e.data.length-1].timestamp-e.data[0].timestamp)/1e3/60},s=360-l(),c=(360-l())/5;if(s<=360)for(var u=0;u<c;u+=1){var m=e.data[0].timestamp-3e5*(c-u),d=new Date(m),p=(0,h.format)(d,"hh:mm");i.push({name:e.name,x:p,y:0})}e.data.map((function(e){var t=new Date(e.timestamp),a=(0,h.format)(t,"hh:mm"),r=_(e.bytes,n);i.push({name:e.name,x:a,y:r})})),a.push({color:o,area:i})})),L(t),x(a),I(n),R(!1)};return o().createElement(u.Card,null,o().createElement(u.CardTitle,{component:"h2"},p("metrics.log_size_per_partition")),o().createElement(u.CardBody,null,o().createElement("div",{ref:a},F?o().createElement(u.Bullseye,null,o().createElement(u.Spinner,{isSVG:!0})):O?o().createElement(f.g,{title:"No data",body:"We’re creating your Kafka instance, so some details aren’t yet available.",noData:!0}):W?o().createElement(f.g,{title:"No topics yet",body:"Data will show when topics exist and are in use.",noTopics:!0}):P&&B&&E()&&o().createElement(m.Chart,{ariaDesc:p("metrics.log_size_per_partition"),ariaTitle:"Log Size",containerComponent:o().createElement(m.ChartVoronoiContainer,{labels:function(e){var t=e.datum;return t.name+": "+t.y},constrainToVisibleArea:!0}),legendPosition:"bottom-left",legendComponent:o().createElement(m.ChartLegend,{data:B,itemsPerRow:X}),height:350,padding:{bottom:110,left:90,right:30,top:25},themeColor:m.ChartThemeColor.multiUnordered,width:C,legendAllowWrap:!0},o().createElement(m.ChartAxis,{label:"Time",tickCount:6}),o().createElement(m.ChartAxis,{dependentAxis:!0,tickFormat:function(e){return Math.round(e)+" "+z}}),o().createElement(m.ChartGroup,null,P.map((function(e,t){return o().createElement(m.ChartArea,{key:"chart-area-"+t,data:e.area,interpolation:"monotoneX"})})))))))}}}]);
//# sourceMappingURL=304.316ff065.js.map