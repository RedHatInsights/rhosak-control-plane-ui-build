"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[1540],{51540:(e,t,n)=>{n.d(t,{L:()=>C});var a=n(70655),i=n(75418),r=n.n(i),o=n(98068),s=n(11593),l=n(56176),u=n.n(l),c=n(86369),d=n.n(c),v=n(84669),f=n(92550);function g(e,t){var n=(0,i.useRef)();(0,i.useEffect)((function(){n.current=e}),[e]),(0,i.useEffect)((function(){if(null!==t){var e=setTimeout((function(){n.current()}),t);return function(){clearInterval(e)}}}),[e,t])}var m=n(75381);function h(){return!document[(e=document,void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":"")];var e}function p(){var e=(0,i.useState)(h()),t=e[0],n=e[1],a=function(){return n(h())};return(0,i.useEffect)((function(){var e,t=void 0!==(e=document).hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":"";return document.addEventListener(t,a,!1),function(){document.removeEventListener(t,a)}}),[]),{isVisible:t,setIsVisible:n}}var _=n(10069),k=n(22497),E=n(55277),S=n(62308),w=n(5569),P=n(13449),b=n(11845),C=function(e){var t=e.preCreateInstance,n=e.tokenEndPointUrl;d().extend(u());var l=((0,P.S)()||{}).shouldOpenCreateModal,c=(0,S.useAuth)(),h=(((0,S.useConfig)()||{}).kas||{}).apiBasePath,C=p().isVisible,y=(0,o.useLocation)(),I=new URLSearchParams(y.search),T=(0,f.h0)()||{},O=T.page,D=void 0===O?1:O,V=T.perPage,A=void 0===V?10:V,N=I.has("user-testing"),R=(0,s.useTranslation)().t,L=((0,S.useAlert)()||{}).addAlert,x=(0,f.QK)().showModal,B=window.localStorage,U=r().useContext(_.QuickStartContext),F=(0,i.useState)(),K=F[0],H=F[1],M=(0,i.useState)({}),G=M[0],Q=M[1],j=(0,i.useState)([]),q=j[0],z=j[1],Z=(0,i.useState)(!1),W=Z[0],Y=Z[1],J=(0,i.useState)("created_at desc"),X=J[0],$=J[1],ee=(0,i.useState)(),te=ee[0],ne=ee[1],ae=(0,i.useState)(0),ie=ae[0],re=ae[1],oe=(0,i.useState)(void 0),se=oe[0],le=oe[1],ue=(0,i.useState)("name"),ce=ue[0],de=ue[1],ve=(0,i.useState)([]),fe=ve[0],ge=ve[1],me=(0,i.useState)(!1),he=me[0],pe=me[1],_e=(0,i.useState)(!1),ke=_e[0],Ee=_e[1],Se=(0,i.useState)(!1),we=Se[0],Pe=Se[1],be=(0,i.useState)(void 0),Ce=be[0],ye=be[1],Ie=(0,i.useState)(),Te=Ie[0],Oe=Ie[1],De=te||{},Ve=De.activeTab,Ae=De.instanceDetail,Ne=null==Te?void 0:Te.some((function(e){return(null==e?void 0:e.instance_type)===(null===m.ik||void 0===m.ik?void 0:m.ik.eval)}));(0,i.useEffect)((function(){if((0,m.Qw)()&&B){var e=parseInt(B.getItem("openSessions")||"0"),t=e+1;e<1&&(B.setItem("openSessions",""+t),Ee(!0))}}),[]);var Re=function(){Ee(!ke)};(0,i.useEffect)((function(){(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return(t=l)?[4,l()]:[3,2];case 1:t=n.sent(),n.label=2;case 2:return(e=t)&&(null==q?void 0:q.length)<1&&He(),e&&(null==q?void 0:q.length)>0&&Le(),[2]}}))}))}),[l,q]);var Le=function(){x(f.Ng.CREATE_KAFKA_INSTANCE,{onCreate:Ge,cloudProviders:q,mainToggle:N,refresh:Me,hasUserTrialKafka:Ne})},xe=function(e){ne({instanceDetail:e,activeTab:b.so.DETAILS})},Be=function(e){ne({instanceDetail:e,activeTab:b.so.CONNECTION})},Ue=function(e){var t,n,a,i,r;(0,m.G6)(e)&&(i=null===(t=e.response)||void 0===t?void 0:t.data.reason,r=null===(a=null===(n=e.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.code),r===m.SM.UNAUTHORIZED_USER?pe(!0):L&&L({variant:v.AlertVariant.danger,title:R("common.something_went_wrong"),description:i})},Fe=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return i=[],fe.forEach((function(e){var t=e.filterKey,n=e.filterValue;if(n&&n.length>0){var a="(";a+=n.map((function(e){var n=e.value.trim();return n===m.Od.PROVISIONING?t+" = "+m.Od.PREPARING+" or "+t+" = "+m.Od.PROVISIONING:n===m.Od.DEPROVISION?t+" = "+m.Od.DEPROVISION+" or "+t+" = "+m.Od.DELETED:""!==n?t+" "+(!0===e.isExact?"= "+n:"like %"+n+"%"):""})).join(" or "),a+=")",i.push(a)}})),e=i.join(" and "),[4,null==c?void 0:c.kas.getToken()];case 1:if(!(t=a.sent())||!C)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new E.DefaultApi(new E.Configuration({accessToken:t,basePath:h})).getKafkas(null==D?void 0:D.toString(),null==A?void 0:A.toString(),X,e).then((function(e){var t=e.data,n=(null==t?void 0:t.items)||[];Q(t),H(n),void 0!==(null==G?void 0:G.total)&&G.total>ie&&re(G.total),we&&fe.length<1&&0==(null==n?void 0:n.length)&&(le(!0),Pe(!1)),Y(!0)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Ue(n),[3,5];case 5:return[2]}var i}))}))};(0,i.useEffect)((function(){(!K||(null==K?void 0:K.length)<=1)&&(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==c?void 0:c.kas.getToken()];case 1:if(!(e=n.sent())||!C)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new E.DefaultApi(new E.Configuration({accessToken:e,basePath:h})).getKafkas("1","1").then((function(e){var t,n,a=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||void 0===n?void 0:n.length;le(!a||a<1)}))];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),Ue(t),[3,5];case 5:return[2]}}))}))}),[K]);var Ke=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==c?void 0:c.kas.getToken()];case 1:if(e=a.sent(),t="owner = "+Ce,!e||!C)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new E.DefaultApi(new E.Configuration({accessToken:e,basePath:h})).getKafkas("","","",t).then((function(e){var t=e.data;Oe(t.items)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Ue(n),[3,5];case 5:return[2]}}))}))};(0,i.useEffect)((function(){Ce&&Ke()}),[Ce]),g((function(){return Ke()}),m.md);var He=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==c?void 0:c.kas.getToken()];case 1:if(!(e=a.sent()))return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new E.DefaultApi(new E.Configuration({accessToken:e,basePath:h})).getCloudProviders().then((function(e){var t,n=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||[],a=null==n?void 0:n.filter((function(e){return e.enabled}));z(a)}))];case 3:return a.sent(),[3,5];case 4:return t=a.sent(),n=void 0,(0,m.G6)(t)&&(n=null===(i=t.response)||void 0===i?void 0:i.data.reason),L&&L({variant:v.AlertVariant.danger,title:R("common.something_went_wrong"),description:n}),[3,5];case 5:return[2]}}))}))};(0,i.useEffect)((function(){Y(!1),Fe()}),[c,D,A,fe,X]),(0,i.useEffect)((function(){He(),Fe()}),[]),(0,i.useEffect)((function(){!function(){if(K&&(null==K?void 0:K.length)>0){var e=null==K?void 0:K.filter((function(e){var t;return(null==e?void 0:e.id)===(null===(t=null==te?void 0:te.instanceDetail)||void 0===t?void 0:t.id)}))[0],t=(0,a.__assign)((0,a.__assign)({},te),{instanceDetail:e});e&&ne(t)}}()}),[K]),(0,i.useEffect)((function(){null==c||c.getUsername().then((function(e){return ye(e)}))}),[c]),g((function(){return Fe()}),m.md);var Me=function(){K&&1===(null==K?void 0:K.length)?Y(!0):Y(!1),Fe()},Ge=function(){re(G.total+1)},Qe=function(){Y(!1),re(G.total-1)};if(he)return r().createElement(v.PageSection,{variant:v.PageSectionVariants.default,padding:{default:"noPadding"},isFilled:!0},r().createElement(f.C0,{titleProps:{title:R("access_permissions_needed"),headingLevel:"h2"},emptyStateIconProps:{icon:w.ZP},emptyStateBodyProps:{body:R("to_access_kafka_instances_contact_your_organization_administrators")}}));return r().createElement(r().Fragment,null,r().createElement(k.oY,{mainToggle:N,isExpanded:null!=te,initialTab:Ve,isLoading:void 0===Ae,instanceDetail:Ae,onClose:function(){ne(null)},"data-ouia-app-id":"controlPlane-streams",tokenEndPointUrl:n,notRequiredDrawerContentBackground:se},r().createElement("main",{className:"pf-c-page__main"},r().createElement(v.PageSection,{variant:v.PageSectionVariants.light},r().createElement(v.Level,null,r().createElement(v.LevelItem,null,r().createElement(v.TextContent,null,r().createElement(v.Text,{component:"h1"},R("kafka_instances")))))),void 0===K?r().createElement(v.PageSection,{variant:v.PageSectionVariants.light,padding:{default:"noPadding"}},r().createElement(f.yR,null)):se?r().createElement(v.PageSection,{padding:{default:"noPadding"},isFilled:!0},r().createElement(f.C0,{emptyStateProps:{variant:f.jU.NoItems},emptyStateBodyProps:{body:r().createElement(r().Fragment,null,R("create_a_kafka_instance_to_get_started")," ",r().createElement(v.Button,{variant:v.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:function(){return U.setActiveQuickStart&&U.setActiveQuickStart("getting-started")}},"quick start guide."))},titleProps:{title:R("no_kafka_instances_yet")}},r().createElement(v.Button,{"data-testid":"emptyStateStreams-buttonCreateKafka",variant:v.ButtonVariant.primary,onClick:function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return t?[4,t(!0)]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return e&&Le(),[2]}}))}))}},R("create_kafka_instance"))),")"):K&&void 0!==se?r().createElement(v.PageSection,{className:"mk--main-page__page-section--table pf-m-padding-on-xl",variant:v.PageSectionVariants.default,padding:{default:"noPadding"}},r().createElement(v.Card,null,r().createElement(k.fw,{kafkaInstanceItems:K,mainToggle:N,onViewConnection:Be,onViewInstance:xe,refresh:Me,kafkaDataLoaded:W,setWaitingForDelete:Pe,onDelete:Qe,page:D,perPage:A,total:null==G?void 0:G.total,expectedTotal:ie,filteredValue:fe,setFilteredValue:ge,setFilterSelected:de,filterSelected:ce,orderBy:X,setOrderBy:$,isDrawerOpen:null!==te,loggedInUser:Ce,currentUserkafkas:Te,onCreate:Ge,cloudProviders:q}))):r().createElement(r().Fragment,null))),r().createElement(v.Modal,{variant:v.ModalVariant.small,title:"Mobile experience",isOpen:ke,onClose:function(){return Re()},actions:[r().createElement(v.Button,{key:"confirm",variant:"primary",onClick:function(){return Re()}},"Ok")]},"The mobile experience isn't fully optimized yet, so some items might not appear correctly."))}}}]);
//# sourceMappingURL=1540.4961e69c.js.map