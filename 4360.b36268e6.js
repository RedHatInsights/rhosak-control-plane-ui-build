"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[4360],{73171:(e,t,a)=>{t.qw={name:"AwsIcon",height:512,width:640,svgPath:"M180.41 203.01c-.72 22.65 10.6 32.68 10.88 39.05a8.164 8.164 0 0 1-4.1 6.27l-12.8 8.96a10.66 10.66 0 0 1-5.63 1.92c-.43-.02-8.19 1.83-20.48-25.61a78.608 78.608 0 0 1-62.61 29.45c-16.28.89-60.4-9.24-58.13-56.21-1.59-38.28 34.06-62.06 70.93-60.05 7.1.02 21.6.37 46.99 6.27v-15.62c2.69-26.46-14.7-46.99-44.81-43.91-2.4.01-19.4-.5-45.84 10.11-7.36 3.38-8.3 2.82-10.75 2.82-7.41 0-4.36-21.48-2.94-24.2 5.21-6.4 35.86-18.35 65.94-18.18a76.857 76.857 0 0 1 55.69 17.28 70.285 70.285 0 0 1 17.67 52.36l-.01 69.29zM93.99 235.4c32.43-.47 46.16-19.97 49.29-30.47 2.46-10.05 2.05-16.41 2.05-27.4-9.67-2.32-23.59-4.85-39.56-4.87-15.15-1.14-42.82 5.63-41.74 32.26-1.24 16.79 11.12 31.4 29.96 30.48zm170.92 23.05c-7.86.72-11.52-4.86-12.68-10.37l-49.8-164.65c-.97-2.78-1.61-5.65-1.92-8.58a4.61 4.61 0 0 1 3.86-5.25c.24-.04-2.13 0 22.25 0 8.78-.88 11.64 6.03 12.55 10.37l35.72 140.83 33.16-140.83c.53-3.22 2.94-11.07 12.8-10.24h17.16c2.17-.18 11.11-.5 12.68 10.37l33.42 142.63L420.98 80.1c.48-2.18 2.72-11.37 12.68-10.37h19.72c.85-.13 6.15-.81 5.25 8.58-.43 1.85 3.41-10.66-52.75 169.9-1.15 5.51-4.82 11.09-12.68 10.37h-18.69c-10.94 1.15-12.51-9.66-12.68-10.75L328.67 110.7l-32.78 136.99c-.16 1.09-1.73 11.9-12.68 10.75h-18.3zm273.48 5.63c-5.88.01-33.92-.3-57.36-12.29a12.802 12.802 0 0 1-7.81-11.91v-10.75c0-8.45 6.2-6.9 8.83-5.89 10.04 4.06 16.48 7.14 28.81 9.6 36.65 7.53 52.77-2.3 56.72-4.48 13.15-7.81 14.19-25.68 5.25-34.95-10.48-8.79-15.48-9.12-53.13-21-4.64-1.29-43.7-13.61-43.79-52.36-.61-28.24 25.05-56.18 69.52-55.95 12.67-.01 46.43 4.13 55.57 15.62 1.35 2.09 2.02 4.55 1.92 7.04v10.11c0 4.44-1.62 6.66-4.87 6.66-7.71-.86-21.39-11.17-49.16-10.75-6.89-.36-39.89.91-38.41 24.97-.43 18.96 26.61 26.07 29.7 26.89 36.46 10.97 48.65 12.79 63.12 29.58 17.14 22.25 7.9 48.3 4.35 55.44-19.08 37.49-68.42 34.44-69.26 34.42zm40.2 104.86c-70.03 51.72-171.69 79.25-258.49 79.25A469.127 469.127 0 0 1 2.83 327.46c-6.53-5.89-.77-13.96 7.17-9.47a637.37 637.37 0 0 0 316.88 84.12 630.22 630.22 0 0 0 241.59-49.55c11.78-5 21.77 7.8 10.12 16.38zm29.19-33.29c-8.96-11.52-59.28-5.38-81.81-2.69-6.79.77-7.94-5.12-1.79-9.47 40.07-28.17 105.88-20.1 113.44-10.63 7.55 9.47-2.05 75.41-39.56 106.91-5.76 4.87-11.27 2.3-8.71-4.1 8.44-21.25 27.39-68.49 18.43-80.02z",yOffset:0,xOffset:0},t.er=a(35183).createIcon(t.qw),t.ZP=t.er},91329:(e,t,a)=>{a.d(t,{d9:()=>r});var n=a(75418);function i(){return!document[(e=document,void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":"")];var e}function r(){var e=(0,n.useState)(i()),t=e[0],a=e[1],r=function(){return a(i())};return(0,n.useEffect)((function(){var e,t=void 0!==(e=document).hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":"";return document.addEventListener(t,r,!1),function(){document.removeEventListener(t,r)}}),[]),{isVisible:t,setIsVisible:a}}},54360:(e,t,a)=>{a.r(t),a.d(t,{CreateInstance:()=>b,default:()=>x});var n=a(70655),i=a(75418),r=a.n(i),o=a(11593),l=a(84669),s=a(78261),u=a(75381),c=a(55277),d=a(10069),m=function(e){var t=e.isKasTrial,a=(0,o.useTranslation)().t,n=r().useContext(d.QuickStartContext);return r().createElement(l.TextContent,null,r().createElement(l.Text,{component:l.TextVariants.h3},a("common.instance_information")),r().createElement(l.TextList,{component:l.TextListVariants.dl},r().createElement(l.Grid,{sm:6,lg:12,hasGutter:!0},t&&r().createElement(l.GridItem,null,r().createElement(l.TextListItem,{component:l.TextListItemVariants.dt},a("common.duration")),r().createElement(l.TextListItem,{component:l.TextListItemVariants.dd},a("common.duration_value"))),r().createElement(l.GridItem,null,r().createElement(l.TextListItem,{component:l.TextListItemVariants.dt},a("common.ingress_egress")),r().createElement(l.TextListItem,{component:l.TextListItemVariants.dd},a("common.ingress_egress_value"))),r().createElement(l.GridItem,null,r().createElement(l.TextListItem,{component:l.TextListItemVariants.dt},a("common.storage")),r().createElement(l.TextListItem,{component:l.TextListItemVariants.dd},a("common.storage_value"))),r().createElement(l.GridItem,null,r().createElement(l.TextListItem,{component:l.TextListItemVariants.dt},a("common.partitions")),r().createElement(l.TextListItem,{component:l.TextListItemVariants.dd},a("common.partitions_value"))),r().createElement(l.GridItem,null,r().createElement(l.TextListItem,{component:l.TextListItemVariants.dt},a("common.client_connections")),r().createElement(l.TextListItem,{component:l.TextListItemVariants.dd},a("common.client_connections_value"))),r().createElement(l.GridItem,null,r().createElement(l.TextListItem,{component:l.TextListItemVariants.dt},a("common.connection_rate")),r().createElement(l.TextListItem,{component:l.TextListItemVariants.dd},a("common.connection_rate_value"))),r().createElement(l.GridItem,null,r().createElement(l.TextListItem,{component:l.TextListItemVariants.dt},a("common.message_size")),r().createElement(l.TextListItem,{component:l.TextListItemVariants.dd},a("common.message_size_value")))),r().createElement(l.Button,{isSmall:!0,isInline:!0,variant:l.ButtonVariant.link,style:{marginTop:"20px"},onClick:function(){return n.setActiveQuickStart&&n.setActiveQuickStart("getting-started")}},a("common.quick_start_guide_message"))))},v=a(11272),_=function(e){var t=e.quota,a=e.hasKafkaCreationFailed,n=e.userHasTrialInstance,i=(0,o.useTranslation)().t;if(void 0===t||t.loading)return r().createElement(l.Alert,{className:"pf-u-mb-md",variant:l.AlertVariant.info,title:i("instance_checking_message"),"aria-live":"polite",isInline:!0,customIcon:r().createElement(l.Spinner,{size:"md","aria-valuetext":"Checking kafka availability"})});var s=function(){var e,i,r=null===(e=t.data)||void 0===e?void 0:e.get(null===v.QuotaType||void 0===v.QuotaType?void 0:v.QuotaType.kas),o=null===(i=t.data)||void 0===i?void 0:i.get(null===v.QuotaType||void 0===v.QuotaType?void 0:v.QuotaType.kasTrial);return a?{variant:l.AlertVariant.danger,titleKey:"kafka_creation_failed_alert_title",messageKey:r?"standard_kafka_creation_failed_alert_message":"trial_kafka_creation_failed_alert_message"}:t.isServiceDown?{titleKey:"something_went_wrong",variant:l.AlertVariant.danger,messageKey:"ams_service_down_message"}:!r&&o&&n?{titleKey:"trial_kafka_title",variant:l.AlertVariant.warning,messageKey:"deploy_one_instance_alert_message"}:r||o?r||!o||n?r&&0===(null==r?void 0:r.remaining)?{variant:l.AlertVariant.warning,titleKey:"standard_kafka_alert_title",messageKey:"standard_kafka_alert_message"}:void 0:{variant:l.AlertVariant.info,titleKey:"trial_quota_kafka_title",messageKey:""}:{variant:l.AlertVariant.warning,titleKey:"no_quota_kafka_alert_title",messageKey:"no_quota_kafka_alert_message"}}();return void 0===s?r().createElement(r().Fragment,null):r().createElement(l.Alert,{className:"pf-u-mb-md",variant:s.variant,title:i(s.titleKey),"aria-live":"polite",isInline:!0},i(s.messageKey))},f=function(e){if(void 0===e.name.value)throw new Error("kafkaRequest.name must not be undefined");if(void 0===e.region.value)throw new Error("kafkaRequest.region must not be undefined");if(void 0===e.multi_az.value)throw new Error("kafkaRequest.multi_az must not be undefined");if(void 0===e.cloud_provider.value)throw new Error("kafkaRequest.cloud_provider must not be undefined");return{name:e.name.value,region:e.region.value,multi_az:e.multi_az.value,cloud_provider:e.cloud_provider.value}},g=function(e){return"error"===e.name.validated||"error"===e.region.validated||"error"===e.cloud_provider.validated||"error"===e.multi_az.validated},p=function(e){var t=e.kafkaRequest,a=e.selectCloudRegion,n=e.cloudRegions,i=(0,o.useTranslation)().t;return void 0===n?r().createElement(l.Skeleton,{fontSize:"2xl"}):r().createElement(l.FormSelect,{validated:t.region.validated,value:t.region.value,onChange:a,id:"cloud-region-select",name:"cloud-region","aria-label":i("cloud_region"),isDisabled:void 0===n},[r().createElement(l.FormSelectOption,{value:"",key:"placeholder",label:i("please_select")}),(n||[]).map((function(e,t){var a=e.id,n=e.display_name,o=void 0===n?"":n;return r().createElement(l.FormSelectOption,{key:t,value:a,label:a?i(a):o})}))])},k=a(73171),E=function(e){var t=e.cloudProviders,a=e.kafkaRequest,n=e.selectCloudProvider,i=function(e){if("aws"===(null==e?void 0:e.toLowerCase()))return r().createElement(k.ZP,{size:"lg",color:"black",className:"mk--create-instance__tile--icon"})};return void 0===t?r().createElement(l.Skeleton,{className:"pf-m-text-4xl",screenreaderText:"Loading contents"}):r().createElement(r().Fragment,null,t.map((function(e){return r().createElement(l.Tile,{key:"tile-"+e.name,title:e.display_name||"",icon:i(e.name),isSelected:a.cloud_provider.value===e.name,onClick:function(){return n(e)}})})))},T=function(e){var t=e.createInstance,a=e.kafkaRequest,s=e.setKafkaRequest,c=e.cloudProviders,d=e.getCloudRegions,m=e.id,v=(0,o.useTranslation)().t,_=(0,i.useState)(!1),f=_[0],k=_[1],T=(0,i.useState)(),h=T[0],I=T[1],b=function(e){return void 0===e.name.value||""===e.name.value.trim()?(e.name.validated="error",e.name.errorMessage=v("common.this_is_a_required_field")):/^[a-z]([-a-z0-9]*[a-z0-9])?$/.test(e.name.value.trim())?e.name.value.length>u.JB&&(e.name.validated="error",e.name.errorMessage=v("length_is_greater_than_expected",{maxLength:u.JB})):(e.name.validated="error",e.name.errorMessage=v("common.input_filed_invalid_helper_text")),e},x=function(e){return void 0!==e.region.value&&""!==e.region.value.trim()||(e.region.validated="error",e.region.errorMessage=v("common.this_is_a_required_field")),e},w=function(){k(!1),s({cloud_provider:{value:""},multi_az:{value:!0},region:{value:""},name:{value:""}})},y=function(e){s((function(t){return(0,n.__assign)((0,n.__assign)({},t),{cloud_provider:{value:e.name||""}})}))},C=function(e){s((function(t){var a=(0,n.__assign)((0,n.__assign)({},t),{region:{value:e||""}});return x(a)}))},L=function(e){s((function(t){return(0,n.__assign)((0,n.__assign)({},t),{multi_az:{value:e}})}))};(0,i.useEffect)((function(){void 0!==c&&c.length>0&&c[0].name&&y(c[0])}),[c]),(0,i.useEffect)((function(){L(!0)}),[]),(0,i.useEffect)((function(){var e;void 0!==a.cloud_provider.value&&(e=a.cloud_provider.value,(0,n.__awaiter)(void 0,void 0,void 0,(function(){var t;return(0,n.__generator)(this,(function(a){switch(a.label){case 0:return[4,d(e)];case 1:return void 0!==(t=a.sent())&&1===t.length&&void 0!==t[0].id&&C(t[0].id),I(t),[2]}}))})))}),[a.cloud_provider]);return r().createElement(l.Form,{onSubmit:function(e){e.preventDefault(),k(!0);var i=x(b(a));s((0,n.__assign)({},i)),g(i)||t().then((function(){return w()}))},id:m},r().createElement((function(){return f&&g(a)?r().createElement(l.FormAlert,null,r().createElement(l.Alert,{variant:"danger",title:v("common.form_invalid_alert"),"aria-live":"polite",isInline:!0})):r().createElement(r().Fragment,null)}),null),r().createElement(l.FormGroup,{label:v("instance_name"),helperText:v("create_instance_name_helper_text"),helperTextInvalid:a.name.errorMessage,isRequired:!0,validated:a.name.validated,fieldId:"form-instance-name"},r().createElement(l.TextInput,{isRequired:!0,validated:a.name.validated,type:"text",id:"form-instance-name",name:"instance-name",value:a.name.value,onChange:function(e){s((function(t){var a=(0,n.__assign)((0,n.__assign)({},t),{name:{value:e}});return b(a)}))},autoFocus:!0})),r().createElement(l.FormGroup,{label:v("cloud_provider"),fieldId:"form-cloud-provider-name"},r().createElement(E,{kafkaRequest:a,selectCloudProvider:y,cloudProviders:c})),r().createElement(l.FormGroup,{label:v("cloud_region"),helperTextInvalid:a.region.errorMessage,validated:a.region.validated,fieldId:"form-cloud-region-option",isRequired:!0},r().createElement(p,{kafkaRequest:a,selectCloudRegion:C,cloudRegions:h})),r().createElement(l.FormGroup,{label:v("availabilty_zones"),fieldId:"availability-zones"},r().createElement(l.ToggleGroup,{"aria-label":v("availability_zone_selection")},r().createElement(l.Tooltip,{content:v("kafkaInstance.availabilty_zones_tooltip_message")},r().createElement(l.ToggleGroupItem,{text:v("single"),value:"single",isDisabled:!0,buttonId:"single",onChange:L})),r().createElement(l.ToggleGroupItem,{text:v("multi"),value:"multi",buttonId:"multi",isSelected:a.multi_az.value||!1,onChange:L}),r().createElement(l.Tooltip,{content:v("kafkaInstance.availabilty_zones_tooltip_message"),reference:function(){return document.getElementById("multi")||document.createElement("span")}}))))},h=a(91329),I="create_instance_-form",b=function(e){var t,a,d=e.onCreate,p=e.title,k=e.hideModal,E=(0,o.useTranslation)().t,b=(0,v.useAuth)(),x=(((0,v.useConfig)()||{}).kas||{}).apiBasePath,w=((0,v.useAlert)()||{}).addAlert,y=((0,v.useQuota)()||{}).getQuota,C=(0,h.d9)().isVisible,L=(0,i.useState)({cloud_provider:{value:""},multi_az:{value:!0},region:{value:""},name:{value:""}}),A=L[0],V=L[1],S=(0,i.useState)(!1),K=S[0],z=S[1],q=(0,i.useState)(),R=q[0],F=q[1],G=(0,i.useState)(!1),Q=G[0],P=G[1],M=(0,i.useState)(),D=M[0],N=M[1],H=(0,i.useState)(),B=H[0],O=H[1],U=null===(t=null==R?void 0:R.data)||void 0===t?void 0:t.get(null===v.QuotaType||void 0===v.QuotaType?void 0:v.QuotaType.kas),J=null===(a=null==R?void 0:R.data)||void 0===a?void 0:a.get(null===v.QuotaType||void 0===v.QuotaType?void 0:v.QuotaType.kasTrial),Z=void 0===(null==R?void 0:R.loading)||(null==R?void 0:R.loading),W=J&&!U;(0,i.useEffect)((function(){(0,n.__awaiter)(void 0,void 0,void 0,(function(){return(0,n.__generator)(this,(function(e){switch(e.label){case 0:return y?[4,y().then((function(e){F(e)}))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}),[]);(0,i.useEffect)((function(){(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e,t,a,i;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==b?void 0:b.kas.getToken()];case 1:if(!(e=n.sent()))return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new c.DefaultApi(new c.Configuration({accessToken:e,basePath:x})).getCloudProviders().then((function(e){var t,a=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||[],n=null==a?void 0:a.filter((function(e){return e.enabled}));N(n)}))];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),a=void 0,(0,s.G)(t)&&(a=null===(i=t.response)||void 0===i?void 0:i.data.reason),w&&w({variant:l.AlertVariant.danger,title:E("common.something_went_wrong"),description:a}),[3,5];case 5:return[2]}}))}))}),[]);var X=function(e){var t,a,n,i;(0,s.G)(e)&&(i=null===(t=e.response)||void 0===t?void 0:t.data.reason,null===(n=null===(a=e.response)||void 0===a?void 0:a.data)||void 0===n||n.code),w&&w({variant:l.AlertVariant.danger,title:E("common.something_went_wrong"),description:i})};(0,i.useEffect)((function(){(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e,t,a,i,r;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==b?void 0:b.getUsername()];case 1:return e=n.sent(),[4,null==b?void 0:b.kas.getToken()];case 2:if(t=n.sent(),!e)return[3,6];if(a="owner = "+e,!t||!C)return[3,6];n.label=3;case 3:return n.trys.push([3,5,,6]),[4,new c.DefaultApi(new c.Configuration({accessToken:t,basePath:x})).getKafkas("","","",a)];case 4:return(i=n.sent()).data.items&&O(i.data.items.some((function(e){return(null==e?void 0:e.instance_type)===(null===u.ik||void 0===u.ik?void 0:u.ik.eval)}))),[3,6];case 5:return r=n.sent(),X(r),[3,6];case 6:return[2]}}))}))}),[]);var $=function(){k()};return r().createElement(l.Modal,{id:"modalCreateKafka",variant:l.ModalVariant.medium,title:p,isOpen:!0,onClose:$,appendTo:u.wx,actions:[r().createElement(l.Button,{key:"submit",variant:"primary",type:"submit",form:I,isDisabled:g(A)||K||Z||B||Q||U&&0===(null==U?void 0:U.remaining)||!U&&!J,spinnerAriaValueText:E("submitting_request"),isLoading:K,"data-testid":"modalCreateKafka-buttonSubmit"},E("create_instance")),r().createElement(l.Button,{key:"cancel",variant:"link",onClick:$,"data-testid":"modalCreateKafka-buttonCancel"},E("cancel"))]},r().createElement(_,{quota:R,hasKafkaCreationFailed:Q,loadingQuota:Z,userHasTrialInstance:B,isKasTrial:W}),r().createElement(l.Flex,{direction:{default:"column",lg:"row"}},r().createElement(l.FlexItem,{flex:{default:"flex_2"}},r().createElement(T,{kafkaRequest:A,setKafkaRequest:V,createInstance:function(){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e,t,a,i,r,o,m;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==b?void 0:b.kas.getToken()];case 1:if(!(e=n.sent()))return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),t=new c.DefaultApi(new c.Configuration({accessToken:e,basePath:x})),z(!0),d&&d(),[4,t.createKafka(!0,f(A))];case 3:return n.sent(),k(),d&&d(),[3,5];case 4:return a=n.sent(),(0,s.G)(a)&&(i=(null===(m=null==a?void 0:a.response)||void 0===m?void 0:m.data)||{},r=i.code,o=i.reason,r===u.SM.DUPLICATE_INSTANCE_NAME?(A.name.validated="error",A.name.errorMessage=E("the_name_already_exists_please_enter_a_unique_name",{name:A.name.value})):r===u.SM.PREVIEW_KAFKA_INSTANCE_EXIST||r===u.SM.INSUFFICIENT_QUOTA||r===u.SM.FAILED_TO_CHECK_QUOTA?P(!0):w&&w({title:E("common.something_went_wrong"),variant:l.AlertVariant.danger,description:o,dataTestId:"toastCreateKafka-failed"})),z(!1),[3,5];case 5:return[2]}}))}))},cloudProviders:D,getCloudRegions:function(e){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var t,a,i,r,o,u;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==b?void 0:b.kas.getToken()];case 1:if(!(t=n.sent())||!e)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new c.DefaultApi(new c.Configuration({accessToken:t,basePath:x})).getCloudProviderRegions(e)];case 3:return a=n.sent(),[2,null===(o=a.data.items)||void 0===o?void 0:o.filter((function(e){return e.enabled}))];case 4:return i=n.sent(),r=void 0,(0,s.G)(i)&&(r=null===(u=i.response)||void 0===u?void 0:u.data.reason),w&&w({title:E("common.something_went_wrong"),variant:l.AlertVariant.danger,description:r}),[3,5];case 5:return[2,void 0]}}))}))},id:I})),r().createElement(l.Divider,{isVertical:!0}),r().createElement(l.FlexItem,{flex:{default:"flex_1"},className:"mk--create-instance-modal__sidebar--content"},r().createElement(m,{isKasTrial:W}))))};const x=b}}]);
//# sourceMappingURL=4360.b36268e6.js.map