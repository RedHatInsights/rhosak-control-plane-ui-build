"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[3097],{80516:(e,t,n)=>{t.Jk={name:"BanIcon",height:512,width:512,svgPath:"M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z",yOffset:0,xOffset:0},t.SC=n(35183).createIcon(t.Jk),t.ZP=t.SC},44535:(e,t,n)=>{t.de={name:"CheckIcon",height:512,width:512,svgPath:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z",yOffset:0,xOffset:0},t.nQ=n(35183).createIcon(t.de),t.ZP=t.nQ},33097:(e,t,n)=>{n.d(t,{L:()=>T});var a=n(70655),i=n(75418),r=n.n(i),o=n(76007),l=n(54532),s=n(56176),c=n.n(s),u=n(97012),d=n.n(u),v=n(58788),f=n(35451),m=n(80516),g=n(44535),p=n(45024),h=n(37472),k=n(75381);function S(){return!document[(e=document,void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":"")];var e}function E(){var e=(0,i.useState)(S()),t=e[0],n=e[1],a=function(){return n(S())};return(0,i.useEffect)((function(){var e,t=void 0!==(e=document).hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":"";return document.addEventListener(t,a,!1),function(){document.removeEventListener(t,a)}}),[]),{isVisible:t,setIsVisible:n}}var _=n(54950),b=n(365),w=n(74162),P=n(70854),y=n(5569),C=n(95368),T=function(e){var t=e.onConnectToRoute,n=e.getConnectToRoutePath,s=e.preCreateInstance,u=e.tokenEndPointUrl;d().extend(c());var S=((0,C.SP)()||{}).shouldOpenCreateModal,T=(0,P.useAuth)(),I=(0,P.useConfig)().kas.apiBasePath,D=E().isVisible,V=(0,o.useLocation)(),O=new URLSearchParams(V.search),L=parseInt(O.get("page")||"",10)||1,A=parseInt(O.get("perPage")||"",10)||10,x=O.has("user-testing"),R=(0,l.useTranslation)().t,B=(0,P.useAlert)().addAlert,N=(0,p.QK)().showModal,K=window.localStorage,F=r().useContext(_.QuickStartContext),z=(0,i.useState)(),M=z[0],U=z[1],Z=(0,i.useState)(),H=Z[0],Q=Z[1],G=(0,i.useState)({}),Y=G[0],j=G[1],q=(0,i.useState)([]),J=q[0],W=q[1],X=(0,i.useState)(!1),$=X[0],ee=X[1],te=(0,i.useState)("created_at desc"),ne=te[0],ae=te[1],ie=(0,i.useState)(),re=ie[0],oe=ie[1],le=(0,i.useState)(0),se=le[0],ce=le[1],ue=(0,i.useState)(void 0),de=ue[0],ve=ue[1],fe=(0,i.useState)("name"),me=fe[0],ge=fe[1],pe=(0,i.useState)([]),he=pe[0],ke=pe[1],Se=(0,i.useState)(!1),Ee=Se[0],_e=Se[1],be=(0,i.useState)(!1),we=be[0],Pe=be[1],ye=(0,i.useState)(!1),Ce=ye[0],Te=ye[1],Ie=(0,i.useState)(void 0),De=Ie[0],Ve=Ie[1],Oe=(0,i.useState)(void 0),Le=Oe[0],Ae=Oe[1],xe=(0,i.useState)(),Re=xe[0],Be=xe[1],Ne=re||{},Ke=Ne.activeTab,Fe=Ne.instanceDetail;(0,i.useEffect)((function(){if((0,k.Qw)()&&K){var e=parseInt(K.getItem("openSessions")||"0"),t=e+1;e<1&&(K.setItem("openSessions",""+t),Pe(!0))}}),[]);var ze=function(){Pe(!we)};(0,i.useEffect)((function(){(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,S()];case 1:return(e=t.sent())&&(null==J?void 0:J.length)<1&&qe(),e&&(null==J?void 0:J.length)>0&&Me(),[2]}}))}))}),[S,J]);var Me=function(){N(p.Ny.CREATE_KAFKA_INSTANCE,{onCreate:We,cloudProviders:J,mainToggle:x,refresh:Je})},Ue=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return s?[4,s(!0)]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return e&&Me(),[2]}}))}))},Ze=function(e){oe({instanceDetail:e,activeTab:"Details"})},He=function(e){oe({instanceDetail:e,activeTab:"Connection"})},Qe=function(e){var t,n,a,i,r;(0,k.G6)(e)&&(i=null===(t=e.response)||void 0===t?void 0:t.data.reason,r=null===(a=null===(n=e.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.code),r===k.SM.UNAUTHORIZED_USER?_e(!0):B({variant:v.AlertVariant.danger,title:R("common.something_went_wrong"),description:i})},Ge=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return i=[],he.forEach((function(e){var t=e.filterKey,n=e.filterValue;if(n&&n.length>0){var a="(";a+=n.map((function(e){var n=e.value.trim();return n===k.Od.PROVISIONING?t+" = "+k.Od.PREPARING+" or "+t+" = "+k.Od.PROVISIONING:n===k.Od.DEPROVISION?t+" = "+k.Od.DEPROVISION+" or "+t+" = "+k.Od.DELETED:""!==n?t+" "+(!0===e.isExact?"= "+n:"like %"+n+"%"):""})).join(" or "),a+=")",i.push(a)}})),e=i.join(" and "),[4,null==T?void 0:T.kas.getToken()];case 1:if(!(t=a.sent())||!D)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:t,basePath:I})).getKafkas(null==L?void 0:L.toString(),null==A?void 0:A.toString(),ne,e).then((function(e){var t=e.data,n=(null==t?void 0:t.items)||[];j(t),U(n),void 0!==(null==Y?void 0:Y.total)&&Y.total>se&&ce(Y.total),Ce&&he.length<1&&0==(null==n?void 0:n.length)&&(ve(!0),Te(!1)),ee(!0)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Qe(n),[3,5];case 5:return[2]}var i}))}))};(0,i.useEffect)((function(){(!M||(null==M?void 0:M.length)<=1)&&(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==T?void 0:T.kas.getToken()];case 1:if(!(e=n.sent())||!D)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:I})).getKafkas("1","1").then((function(e){var t,n,a=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||void 0===n?void 0:n.length;ve(!a||a<1)}))];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),Qe(t),[3,5];case 5:return[2]}}))}))}),[M]);var Ye=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==T?void 0:T.kas.getToken()];case 1:if(e=a.sent(),t="owner = "+Le,!e||!D)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:I})).getKafkas("","","",t).then((function(e){var t=e.data;Be(t.items)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Qe(n),[3,5];case 5:return[2]}}))}))};(0,i.useEffect)((function(){Le&&Ye()}),[Le]),(0,h.K)((function(){return Ye()}),k.md);var je=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==T?void 0:T.kas.getToken()];case 1:if(e=a.sent(),t=Le?"owner = "+Le:"",!e||!D)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:I})).getKafkas("1","1","",t).then((function(e){var t=e.data;Q(t.items)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Qe(n),[3,5];case 5:return[2]}}))}))},qe=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==T?void 0:T.kas.getToken()];case 1:if(!(e=a.sent()))return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:I})).getCloudProviders().then((function(e){var t,n=(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||[],a=null==n?void 0:n.filter((function(e){return e.enabled}));W(a)}))];case 3:return a.sent(),[3,5];case 4:return t=a.sent(),n=void 0,(0,k.G6)(t)&&(n=null===(i=t.response)||void 0===i?void 0:i.data.reason),B({variant:v.AlertVariant.danger,title:R("common.something_went_wrong"),description:n}),[3,5];case 5:return[2]}}))}))};(0,i.useEffect)((function(){ee(!1),Ge()}),[T,L,A,he,ne]),(0,i.useEffect)((function(){qe(),Ge()}),[]),(0,i.useEffect)((function(){je()}),[]),(0,i.useEffect)((function(){!function(){if(M&&(null==M?void 0:M.length)>0){var e=null==M?void 0:M.filter((function(e){var t;return(null==e?void 0:e.id)===(null===(t=null==re?void 0:re.instanceDetail)||void 0===t?void 0:t.id)}))[0],t=(0,a.__assign)((0,a.__assign)({},re),{instanceDetail:e});e&&oe(t)}}()}),[M]),(0,i.useEffect)((function(){null==T||T.getUsername().then((function(e){return Ae(e)}))}),[T]),(0,i.useEffect)((function(){(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==T?void 0:T.kas.getToken()];case 1:if(!(e=n.sent()))return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new w.DefaultApi(new w.Configuration({accessToken:e,basePath:I})).getServiceStatus().then((function(e){var t,n,a=(null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.kafkas)||void 0===n?void 0:n.max_capacity_reached)||x;Ve(a)}))];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),Qe(t),[3,5];case 5:return[2]}}))}))}),[]),(0,h.K)((function(){return je()}),k.md),(0,h.K)((function(){return Ge()}),k.md);var Je=function(){M&&1===(null==M?void 0:M.length)?ee(!0):ee(!1),Ge()},We=function(){ce(Y.total+1)},Xe=function(){ee(!1),ce(Y.total-1)};if(Ee)return r().createElement(v.PageSection,{variant:v.PageSectionVariants.default,padding:{default:"noPadding"},isFilled:!0},r().createElement(p.C0,{titleProps:{title:R("access_permissions_needed"),headingLevel:"h2"},emptyStateIconProps:{icon:y.ZP},emptyStateBodyProps:{body:R("to_access_kafka_instances_contact_your_organization_administrators")}}));var $e,et=function(){var e=null==M?void 0:M.filter((function(e){return e.owner===Le}))[0];return e||(e=null==H?void 0:H.filter((function(e){return e.owner===Le}))[0]),e},tt=function(){var e=void 0!==et(),t="";return(e||De)&&(t=De&&e?"You can deploy 1 preview instance at a time.":De?"Development preview instances are currently unavailable for creation.":"You can deploy 1 preview instance at a time."),t},nt=function(){var e=De?"Development preview instances are currently unavailable for creation.":"Development preview instances are available for creation. You can deploy 1 preview instance at a time.";return De?r().createElement(v.Tooltip,{content:e},r().createElement(v.Label,{icon:r().createElement(m.ZP,null),className:"pf-u-ml-md",tabIndex:0},"No instances available")):r().createElement(v.Tooltip,{content:e},r().createElement(v.Label,{color:"green",icon:r().createElement(g.ZP,null),className:"pf-u-ml-md",tabIndex:0},"Instances available"))};return r().createElement(r().Fragment,null,r().createElement(b.oY,{mainToggle:x,isExpanded:null!=re,activeTab:Ke,isLoading:void 0===Fe,instanceDetail:Fe,onClose:function(){oe(null)},"data-ouia-app-id":"controlPlane-streams",getConnectToRoutePath:n,onConnectToRoute:t,tokenEndPointUrl:u,notRequiredDrawerContentBackground:de},r().createElement("main",{className:"pf-c-page__main"},r().createElement(v.PageSection,{variant:v.PageSectionVariants.light},r().createElement(v.Level,null,r().createElement(v.LevelItem,null,r().createElement(v.TextContent,null,r().createElement(v.Text,{component:"h1"},R("kafka_instances"))))),($e=et())?r().createElement(v.Alert,{variant:"info",isInline:!0,title:(null==$e?void 0:$e.name)+" was created on "+d()(null==$e?void 0:$e.created_at).format("LLLL"),className:"pf-u-mt-lg"},"This preview instance will expire 48 hours after creation."):r().createElement(r().Fragment,null)),void 0===M?r().createElement(v.PageSection,{variant:v.PageSectionVariants.light,padding:{default:"noPadding"}},r().createElement(p.yR,null)):de?r().createElement(v.PageSection,{padding:{default:"noPadding"},isFilled:!0},De?r().createElement(p.C0,{emptyStateProps:{variant:v.EmptyStateVariant.large},emptyStateIconProps:{icon:m.ZP},emptyStateBodyProps:{body:r().createElement(r().Fragment,null,"Development preview instances are currently unavailable for creation, so check back later. In the meantime,"," ",r().createElement(v.Button,{variant:v.ButtonVariant.link,isSmall:!0,isInline:!0,"data-testid":"emptyState-actionTour"},"take a tour")," ","to learn more about the service.")},titleProps:{title:"Kafka instances unavailable",size:v.TitleSizes.xl,headingLevel:"h2"}}):r().createElement(p.C0,{emptyStateProps:{variant:v.EmptyStateVariant.large},emptyStateIconProps:{icon:f.ZP,color:"green"},emptyStateBodyProps:{body:r().createElement(r().Fragment,null,"Development preview instances are available for creation. For help getting started, access the"," ",r().createElement(v.Button,{variant:v.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:function(){return F.setActiveQuickStart&&F.setActiveQuickStart("getting-started")}},"quick start guide."))},titleProps:{title:"Kafka instances available",size:v.TitleSizes.xl,headingLevel:"h2"}},function(){var e=void 0!==et()||De;if(e){var t=tt();return r().createElement(v.Tooltip,{content:t},r().createElement(v.Button,{"data-testid":"emptyStateStreams-buttonCreateKafka",variant:v.ButtonVariant.primary,onClick:Ue,isAriaDisabled:e},R("create_kafka_instance")))}return r().createElement(v.Button,{"data-testid":"emptyStateStreams-buttonCreateKafka",variant:v.ButtonVariant.primary,onClick:Ue},R("create_kafka_instance"))}())):M&&void 0!==de?r().createElement(v.PageSection,{className:"mk--main-page__page-section--table pf-m-padding-on-xl",variant:v.PageSectionVariants.default,padding:{default:"noPadding"}},r().createElement(v.Card,null,r().createElement(b.fw,{kafkaInstanceItems:M,mainToggle:x,onViewConnection:He,onViewInstance:Ze,onConnectToRoute:t,getConnectToRoutePath:n,refresh:Je,kafkaDataLoaded:$,setWaitingForDelete:Te,onDelete:Xe,page:L,perPage:A,total:null==Y?void 0:Y.total,expectedTotal:se,filteredValue:he,setFilteredValue:ke,setFilterSelected:ge,filterSelected:me,orderBy:ne,setOrderBy:ae,isDrawerOpen:null!==re,loggedInUser:Le,isMaxCapacityReached:De,buttonTooltipContent:tt(),isDisabledCreateButton:void 0!==et()||De,labelWithTooltip:nt(),currentUserkafkas:Re,onCreate:We,cloudProviders:J}))):r().createElement(r().Fragment,null))),r().createElement(v.Modal,{variant:v.ModalVariant.small,title:"Mobile experience",isOpen:we,onClose:function(){return ze()},actions:[r().createElement(v.Button,{key:"confirm",variant:"primary",onClick:function(){return ze()}},"Ok")]},"The mobile experience isn't fully optimized yet, so some items might not appear correctly."))}}}]);
//# sourceMappingURL=3097.0eeb4cf8.js.map