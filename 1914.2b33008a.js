"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[1914],{21914:(e,a,o)=>{o.r(a),o.d(a,{default:()=>k});var i=o(223),t=o(85893),n=o(97915),r=o(10069),l=o(75418),s=o(5854),d=o(99137),u=o(75381),c=o(6283);const v=()=>{const e=(0,s.useConfig)(),a=(0,s.useAuth)(),o="rhosak";return()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,t,n,r,l,d;const u=yield null==a?void 0:a.ams.getToken(),v=new c.AppServicesApi({accessToken:u,basePath:(null==e?void 0:e.ams.apiBasePath)||""}),m=yield v.apiAccountsMgmtV1CurrentAccountGet(),p=null===(t=null===(i=null==m?void 0:m.data)||void 0===i?void 0:i.organization)||void 0===t?void 0:t.id,g=new Map,_={loading:!0,isServiceDown:!1,data:void 0};if(!p)return console.error("useQuota","orgId is not defined"),_.loading=!1,_.isServiceDown=!0,_;try{const e=yield v.apiAccountsMgmtV1OrganizationsOrgIdQuotaCostGet(p,void 0,!0),a=null===(r=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.items)||void 0===r?void 0:r.find((e=>{var a;return null===(a=e.related_resources)||void 0===a?void 0:a.find((e=>e.resource_name===o&&"RHOSAK"===e.product))})),i=null===(d=null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.items)||void 0===d?void 0:d.find((e=>{var a;return null===(a=e.related_resources)||void 0===a?void 0:a.find((e=>e.resource_name===o&&"RHOSAKTrial"===e.product))}));if(a&&a.allowed>0){const e=(null==a?void 0:a.allowed)-(null==a?void 0:a.consumed);null==g||g.set(s.QuotaType.kas,{allowed:null==a?void 0:a.allowed,consumed:null==a?void 0:a.consumed,remaining:e<0?0:e})}i&&(null==g||g.set(s.QuotaType.kasTrial,{allowed:null==i?void 0:i.allowed,consumed:null==i?void 0:i.consumed,remaining:(null==i?void 0:i.allowed)-(null==i?void 0:i.consumed)})),_.loading=!1,_.data=g}catch(e){_.loading=!1,_.isServiceDown=!0,console.error(e)}return _}))};function m(e){let a;try{a=null==e?void 0:e.get(null===s.QuotaType||void 0===s.QuotaType?void 0:s.QuotaType.kas)}catch(e){console.error("useAvailableProvidersAndDefault","quota?.get exception",e)}return void 0!==a&&a.remaining>=0?u.ik.standard:u.ik.developer}const p=()=>{const{kas:e,getUsername:a}=(0,s.useAuth)(),{kas:{apiBasePath:o}}=(0,s.useConfig)(),t=v();function n(){return new d.DefaultApi(new d.Configuration({accessToken:e.getToken(),basePath:o}))}const r=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var a;try{const o=n(),t=yield o.getCloudProviders(),r=(null===(a=null==t?void 0:t.data)||void 0===a?void 0:a.items)||[];return yield Promise.all(r.filter((e=>e.enabled)).map((a=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const o=yield((e,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var o;const i=n(),t=yield i.getCloudProviderRegions(e);return(null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.items)?t.data.items.filter((e=>e.enabled&&e.capacity.some((e=>e.instance_type===a)))).map((e=>{var a;const o=null===(a=e.capacity)||void 0===a?void 0:a.some((e=>{var a;return 0===(null===(a=e.available_sizes)||void 0===a?void 0:a.length)}));return{id:e.id,displayName:e.display_name,isDisabled:o}})):[]})))(a.id,e);return{id:a.id,displayName:a.display_name,regions:o}})))))}catch(e){return console.error("useAvailableProvidersAndDefault","fetchProvider",e),Promise.reject(e)}}));return function(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const o=yield t(),l=function(e){let a;try{a=null==e?void 0:e.get(null===s.QuotaType||void 0===s.QuotaType?void 0:s.QuotaType.kas)}catch(e){console.error("useAvailableProvidersAndDefault","quota?.get exception",e)}return void 0!==a&&a.remaining>=0?"standard":"trial"}(o.data),d=m(o.data),c=null===(e=null==o?void 0:o.data)||void 0===e?void 0:e.get(null===s.QuotaType||void 0===s.QuotaType?void 0:s.QuotaType.kas),v=yield(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const e=`owner = ${yield a()}`,o=n(),i=yield o.getKafkas("","","",e);if(i.data.items)return i.data.items.some((e=>(null==e?void 0:e.instance_type)===(null===u.ik||void 0===u.ik?void 0:u.ik.eval)||(null==e?void 0:e.instance_type)===(null===u.ik||void 0===u.ik?void 0:u.ik.developer)))}catch(e){console.error("useAvailableProvidersAndDefault","fetchUserHasTrialInstance",e)}return!1})),p=yield r(d);let g;try{g=1===p.length?p[0].id:void 0}catch(e){console.error("useAvailableProvidersAndDefault","defaultProvider error",e)}return{defaultProvider:g,availableProviders:p,instanceAvailability:(()=>{switch(!0){case void 0!==c&&c.remaining>0:return"standard-available";case void 0!==c&&0===c.remaining:return"over-quota";case v:return"trial-used";default:return"trial-available"}})(),maxStreamingUnits:(null==c?void 0:c.allowed)||0,remainingQuota:(null==c?void 0:c.remaining)||0,plan:l}}catch(e){return console.error("useAvailableProvidersAndDefault",e),Promise.reject(e)}}))}};var g=o(78261);const _=()=>{const e=(0,s.useAuth)(),a=v(),{kas:{apiBasePath:o}}=(0,s.useConfig)();return(t,n,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const l=new d.DefaultApi(new d.Configuration({accessToken:null==e?void 0:e.kas.getToken(),basePath:o})),s=m((yield a()).data);try{const e=(e=>{if(void 0===e.name.value)throw new Error("kafkaRequest.name must not be undefined");if(void 0===e.region.value)throw new Error("kafkaRequest.region must not be undefined");if(void 0===e.multi_az.value)throw new Error("kafkaRequest.multi_az must not be undefined");if(void 0===e.cloud_provider.value)throw new Error("kafkaRequest.cloud_provider must not be undefined");return{name:e.name.value,region:e.region.value,multi_az:e.multi_az.value,cloud_provider:e.cloud_provider.value}})({cloud_provider:{value:""},multi_az:{value:!0},region:{value:""},name:{value:""}});e.name=t.name,e.cloud_provider=t.provider,e.region=t.region,e.plan=s+"."+t.sizeId,yield l.createKafka(!0,e),n()}catch(e){if((0,g.G6)(e)){const{code:a}=(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)||{};switch(a){case u.SM.DUPLICATE_INSTANCE_NAME:r("name-taken");break;case u.SM.INSUFFICIENT_QUOTA:r("over-quota");break;case u.SM.REACHED_MAX_LIMIT_ALLOWED_KAFKA:case u.SM.INSTANCE_TYPE_NOT_SUPPORTED:r("trial-unavailable");break;default:console.error("useAvailableProvidersAndDefault","createKafka unknown error",e),r("unknown")}}else console.error("useAvailableProvidersAndDefault","createKafka unexpected error",e)}}))};const f=({hideModal:e,onCreate:a})=>{const o=p(),c=function(){const{kas:e}=(0,s.useAuth)(),{kas:{apiBasePath:a}}=(0,s.useConfig)();return(o,t)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,n,r,l,s;const c=new d.DefaultApi(new d.Configuration({accessToken:e.getToken(),basePath:a})),v=yield c.getInstanceTypesByCloudProviderAndRegion(o,t);if(!(null===(i=null==v?void 0:v.data)||void 0===i?void 0:i.instance_types))throw new Error("No instance_types from backend");const m=null===(r=null===(n=null==v?void 0:v.data)||void 0===n?void 0:n.instance_types.find((e=>e.id===u.ik.standard)))||void 0===r?void 0:r.sizes,p=((null===(s=null===(l=null==v?void 0:v.data)||void 0===l?void 0:l.instance_types.find((e=>e.id===u.ik.developer)))||void 0===s?void 0:s.sizes)||[])[0];if(!m||!p)throw new Error(`No standard sizes or trial size: ${m} ${p}`);return{standard:m.map((e=>{const a=e;return{id:a.id,displayName:a.display_name,quota:a.quota_consumed,ingress:(a.ingress_throughput_per_sec.bytes||0)/1048576,egress:(a.egress_throughput_per_sec.bytes||0)/1048576,storage:Math.round((a.max_data_retention_size.bytes||0)/1073741824),connections:a.total_max_connections,connectionRate:a.max_connection_attempts_per_sec,maxPartitions:a.max_partitions,messageSize:(a.max_message_size.bytes||0)/1048576,status:"stable"===a.maturity_status?"stable":"preview",trialDurationHours:void 0}})),trial:{id:p.id,displayName:p.display_name,quota:0,ingress:(p.ingress_throughput_per_sec.bytes||0)/1048576,egress:(p.egress_throughput_per_sec.bytes||0)/1048576,storage:Math.round((p.max_data_retention_size.bytes||0)/1073741824),connections:p.total_max_connections,connectionRate:p.max_connection_attempts_per_sec,maxPartitions:p.max_partitions,messageSize:(p.max_message_size.bytes||0)/1048576,status:"stable"===p.maturity_status?"stable":"preview",trialDurationHours:p.lifespan_seconds?p.lifespan_seconds/60/60:void 0}}}))}(),v=_(),m=(0,l.useContext)(r.QuickStartContext),g=(0,l.useCallback)((()=>{m.setActiveQuickStart&&m.setActiveQuickStart("getting-started")}),[m]),f=(0,l.useCallback)((function(o,i,t){v(o,(()=>{i(),a&&a(),e()}),t)}),[e,a,v]),k=(0,l.useCallback)((()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return o()}))),[o]),b=(0,l.useCallback)(c,[c]);return(0,t.jsx)(n.CreateKafkaInstanceWithSizes,{isModalOpen:!0,onClickQuickStart:g,onCancel:e,getAvailableProvidersAndDefaults:k,onCreate:f,onClickContactUs:()=>console.log(""),onClickLearnMoreAboutRegions:()=>console.log(""),onLearnHowToAddStreamingUnits:()=>console.log(""),onLearnMoreAboutSizes:()=>console.log(""),onClickKafkaOverview:()=>console.log(""),getSizes:b})},k=f},78261:(e,a,o)=>{o.d(a,{G6:()=>i.isServiceApiError,SM:()=>t});var i=o(99137);const t={UNAUTHORIZED_USER:i.APIErrorCodes.ERROR_4,DUPLICATE_INSTANCE_NAME:i.APIErrorCodes.ERROR_36,REACHED_MAX_LIMIT_ALLOWED_KAFKA:i.APIErrorCodes.ERROR_24,INSUFFICIENT_QUOTA:i.APIErrorCodes.ERROR_120,FAILED_TO_CHECK_QUOTA:i.APIErrorCodes.ERROR_121,OWNER_DOES_NOT_EXIST:i.APIErrorCodes.ERROR_21,INSTANCE_TYPE_NOT_SUPPORTED:i.APIErrorCodes.ERROR_41}},75381:(e,a,o)=>{o.d(a,{Bh:()=>i.Bh,G6:()=>t.G6,JB:()=>i.JB,L0:()=>i.L0,Nw:()=>i.Nw,Od:()=>i.Od,Qw:()=>i.Qw,SM:()=>t.SM,bv:()=>i.bv,hm:()=>i.hm,ik:()=>i.ik,md:()=>i.md,o8:()=>i.o8,pf:()=>i.pf,vK:()=>i.vK,wx:()=>i.wx});var i=o(52648),t=(o(82519),o(78261))},82519:(e,a,o)=>{o.d(a,{j:()=>t});var i=o(75418);function t(e){(0,i.useEffect)((()=>{const a=document.title;return document.title=e,()=>{document.title=a}}),[e])}},52648:(e,a,o)=>{o.d(a,{Bh:()=>s,JB:()=>d,L0:()=>p,Nw:()=>c,Od:()=>i,Qw:()=>_,bv:()=>r,hm:()=>l,ik:()=>t,md:()=>v,o8:()=>m,pf:()=>u,vK:()=>f,wx:()=>g});var i,t,n=o(31803);!function(e){e.READY="ready",e.ACCEPTED="accepted",e.PREPARING="preparing",e.PROVISIONING="provisioning",e.FAILED="failed",e.DEPROVISION="deprovision",e.DELETED="deleting"}(i||(i={})),function(e){e.eval="eval",e.standard="standard",e.developer="developer"}(t||(t={}));const r=[{value:"aws",label:"Amazon Web Services"}],l=[{value:"ready",label:"Ready"},{value:"failed",label:"Failed"},{value:"accepted",label:"Creation pending"},{value:"provisioning",label:"Creation in progress"},{value:"preparing",label:"Creation in progress"},{value:"deprovision",label:"Deletion in progress"},{value:"deleting",label:"Deletion in progress"}],s=[{value:"us-east-1",label:"US East, N. Virginia"},{value:"eu-west-1",label:"EU, Ireland"}],d=32,u=10,c=50,v=5e3,m=(e,a,o)=>{let i=a;if(o&&o>0){e===(o%a!=0?Math.floor(o/a)+1:Math.floor(o/a))&&(i=o>a?o%a==0?a:o%a:o)}return 0!==i?i:a},p=(e,a)=>(e="string"==typeof e?new Date(e):e,(0,n.formatDistance)(e,new Date)+" "+a),g=()=>document.getElementById("chrome-app-render-root")||document.body,_=()=>{let e=!1;var a;return a=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(e=!0),e},f=({loadingCount:e,skeleton:a,length:o})=>{const i=[],t=[];for(let e=0;e<o;e++)t.push({title:a});for(let a=0;a<e;a++)i.push({cells:t});return i}}}]);
//# sourceMappingURL=1914.2b33008a.js.map