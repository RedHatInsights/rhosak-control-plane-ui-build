"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[7415],{27081:()=>{},88601:(e,t,a)=>{a.d(t,{c:()=>u,d:()=>c});var i=a(52212),n=a(8764),r=a(18423),l=a(22178),o=a(9669),s=a.n(o);const d=(0,l.createCacheAdapter)({debug:null!==localStorage.getItem("log-axios")}),c=()=>{const e=(0,i.useAuth)(),{kas:{apiBasePath:t}}=(0,i.useConfig)();return()=>new r.DefaultApi(new r.Configuration({accessToken:e.kas.getToken(),basePath:t}),void 0,s().create({adapter:d,cache:15e3}))},u=()=>{const e=(0,i.useAuth)(),{ams:{apiBasePath:t}}=(0,i.useConfig)();return()=>new n.AppServicesApi(new r.Configuration({accessToken:e.ams.getToken(),basePath:t}),void 0,s().create({adapter:d,cache:15e3}))}},94622:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(85893),n=a(93264),r=a(98743),l=a(52212);const o=()=>{const{registerModals:e}=(0,l.useModal)();return e((()=>{const{t:e}=(0,r.useTranslation)(["kasTemporaryFixMe"]);return{[l.ModalType.KasCreateInstance]:{lazyComponent:(0,n.lazy)((()=>Promise.all([a.e(7196),a.e(9669),a.e(9922),a.e(8199),a.e(8423),a.e(2557),a.e(69),a.e(4372)]).then(a.bind(a,74372)))),variant:"medium",title:e("create_a_kafka_instance")},[l.ModalType.KasDeleteInstance]:{lazyComponent:(0,n.lazy)((()=>Promise.all([a.e(7196),a.e(9669),a.e(9922),a.e(8408),a.e(8199),a.e(8423),a.e(8251),a.e(5626),a.e(2557),a.e(524)]).then(a.bind(a,78578)))),variant:"small"},[l.ModalType.KasTransferOwnership]:{lazyComponent:(0,n.lazy)((()=>Promise.all([a.e(9669),a.e(9922),a.e(8408),a.e(8423),a.e(2557),a.e(8512)]).then(a.bind(a,98512)))),variant:"medium",title:e("change_owner")},[l.ModalType.KasCreateServiceAccount]:{lazyComponent:(0,n.lazy)((()=>Promise.all([a.e(7196),a.e(9922),a.e(8408),a.e(8199),a.e(8423),a.e(8251),a.e(5626),a.e(8752)]).then(a.bind(a,45587)))),variant:"medium",title:e("serviceAccount.create_a_service_account")},[l.ModalType.KasDeleteServiceAccount]:{lazyComponent:(0,n.lazy)((()=>Promise.all([a.e(7196),a.e(9922),a.e(8408),a.e(8199),a.e(8423),a.e(8251),a.e(5626),a.e(645)]).then(a.bind(a,88372)))),title:e("serviceAccount.delete_service_account")+"?",variant:"small"},[l.ModalType.KasResetServiceAccountCredentials]:{lazyComponent:(0,n.lazy)((()=>Promise.all([a.e(7196),a.e(9922),a.e(8408),a.e(8199),a.e(8423),a.e(8251),a.e(5626),a.e(4410)]).then(a.bind(a,99240)))),title:`${e("serviceAccount.reset_service_account_credentials")}?`,variant:"medium"}}})()),(0,i.jsx)(i.Fragment,{})}},63286:(e,t,a)=>{var i;a.d(t,{Z:()=>i}),function(e){e.DETAILS="details",e.CONNECTION="connection"}(i||(i={}))},51622:(e,t,a)=>{a.d(t,{G:()=>_});var i=a(9922),n=a(85893),r=a(93264),l=a(98743),o=a(28251),s=a(75381),d=a(99922),c=a(68199),u=a(11228),v=a(3433);const p=({total:e,page:t,perPage:a})=>{const{t:i}=(0,l.useTranslation)(["kasTemporaryFixMe"]);return e>0?(0,n.jsx)(v.wu,{widgetId:"pagination-cloudProviderOptions-menu-bottom",itemCount:e,variant:d.PaginationVariant.bottom,page:t,perPage:a,titles:{paginationTitle:i("full_pagination"),perPageSuffix:i("per_page_suffix"),toFirstPage:i("to_first_page"),toPreviousPage:i("to_previous_page"),toLastPage:i("to_last_page"),toNextPage:i("to_next_page"),optionsToggle:i("options_toggle"),currPage:i("curr_page")}}):(0,n.jsx)(n.Fragment,{})},m=({count:e,dataLoaded:t})=>{const{t:a}=(0,l.useTranslation)(["kasTemporaryFixMe"]);return e<1&&t?(0,n.jsx)(v.C0,{emptyStateProps:{variant:v.jU.NoResult},titleProps:{title:a("no_results_found")},emptyStateBodyProps:{body:a("adjust_your_filters_and_try_again")}}):(0,n.jsx)(n.Fragment,{})};var g=a(31571),f=a(29422);const _=({onDeleteInstance:e,onChangeOwner:t,onViewInstance:a,onViewConnection:_,loggedInUser:h,page:b,perPage:x,total:S,expectedTotal:k,kafkaDataLoaded:y,kafkaInstanceItems:j,isOrgAdmin:F,setOrderBy:w,orderBy:O,filterSelected:C,setFilterSelected:I,filteredValue:T,setFilteredValue:D,onCreate:P,refresh:M,handleCreateInstanceModal:V,selectedInstanceName:E})=>{const{t:A}=(0,l.useTranslation)(["kasTemporaryFixMe"]),N=[{title:A("name"),transforms:[o.sortable]},{title:A("cloud_provider"),transforms:[o.sortable]},{title:A("region"),transforms:[o.sortable]},{title:A("owner"),transforms:[o.sortable]},{title:A("status"),transforms:[o.sortable]},{title:A("time_created"),transforms:[o.sortable]}],R=(0,r.useMemo)((()=>{const e=e=>{switch(e.toLowerCase()){case"name":return 0;case"cloud_provider":return 1;case"region":return 2;case"owner":return 3;case"status":return 4;case"created_at":return 5;default:return}},t=(null==O?void 0:O.split(" "))||[];if(t.length>1)return{index:e(t[0]),direction:t[1]===o.SortByDirection.asc?o.SortByDirection.asc:o.SortByDirection.desc}}),[O]),L=(0,r.useMemo)((()=>{const e=[],t=(0,s.o8)(b,x,k);return y?(null==j||j.forEach((t=>{const{name:a,cloud_provider:i,region:r,created_at:o,status:v,owner:p,instance_type:m,size:_}=t,h=A(i),b=A(r);e.push({cells:[{title:v===s.Od.DEPROVISION||v!==s.Od.READY?a:(0,n.jsx)(c.Link,Object.assign({to:`kafkas/${null==t?void 0:t.id}/dashboard`,"data-ouia-component-id":"table-link"},{children:a}))},h,b,p,{title:(0,n.jsx)(u.qV,{status:v,instanceName:a})},{title:(0,n.jsxs)(n.Fragment,{children:[(0,s.L0)(o,A("ago")),(0,n.jsx)("br",{}),(m===(null===s.ik||void 0===s.ik?void 0:s.ik.developer)||m===(null===s.ik||void 0===s.ik?void 0:s.ik.eval))&&((null==_?void 0:_.trialDurationHours)?(0,n.jsx)(l.Trans,{i18nKey:"common.expires_in",ns:["kasTemporaryFixMe"],components:{time:(0,n.jsx)(g.FormatDate,{date:(0,f.Z)(new Date(o),{hours:null==_?void 0:_.trialDurationHours}),format:"expiration"})}}):(0,n.jsx)(d.Skeleton,{}))]})}],originalData:t})})),e):(0,s.vK)({loadingCount:t,skeleton:(0,n.jsx)(d.Skeleton,{}),length:N.length})}),[b,x,k,y,j,N.length,A]),K=(e,i,n)=>{var r,l,o;"view-instanceDrawerInstance"===n?a(i):"connect-instanceDrawerInstance"===n?_(i):"change-owner"===n?t(i):"delete-instanceDrawerInstance"===n&&z(i);const s=null===(o=null===(l=null===(r=null==e?void 0:e.target)||void 0===r?void 0:r.parentElement)||void 0===l?void 0:l.parentElement)||void 0===o?void 0:o.previousSibling;null!=s&&s.focus()},z=t=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){yield e(t)}));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.eG,{filterSelected:C,setFilterSelected:I,total:S,page:b,perPage:x,filteredValue:T,setFilteredValue:D,onCreate:P,refresh:M,handleCreateInstanceModal:V}),(0,n.jsx)(v.wR,{tableProps:{cells:N,rows:L,"aria-label":A("cluster_instance_list"),actionResolver:e=>{if(!y)return[];const t=e.originalData;if(t.status===s.Od.DEPROVISION||t.status===s.Od.DELETED)return[];const a=void 0!==h&&t.owner===h||void 0!==F&&!0===F;let i;a||(i={tooltip:!0,isDisabled:!0,style:{pointerEvents:"auto",cursor:"default"}});return[Object.assign(Object.assign({title:A("view_details"),id:"view-instanceDrawerInstance","data-testid":"tableStreams-actionDetails",onClick:e=>K(e,t,"view-instanceDrawerInstance")},i),{tooltipProps:{position:"left",content:A("no_permission_to_view_kafka")}}),Object.assign(Object.assign({title:A("view_connection_information"),id:"connect-instanceDrawerInstance","data-testid":"tableStreams-actionConnection",onClick:e=>K(e,t,"connect-instanceDrawerInstance")},i),{tooltipProps:{position:"left",content:A("no_permission_to_connect_kafka")}}),Object.assign(Object.assign({title:A("change_owner"),id:"change-owner","data-testid":"tableStreams-actionChangeOwner",onClick:e=>a&&K(e,t,"change-owner")},i),{tooltipProps:{position:"left",content:A("no_permission_to_change_owner")}}),Object.assign(Object.assign({title:A("delete_instance"),id:"delete-instanceDrawerInstance","data-testid":"tableStreams-actionDelete",onClick:e=>a&&K(e,t,"delete-instanceDrawerInstance")},i),{tooltipProps:{position:"left",content:A("no_permission_to_delete_kafka")}})]},onSort:(e,t,a,i)=>{let n=a;(null==R?void 0:R.index)!==t&&"time-created"===i.property&&(n=o.SortByDirection.desc),w(`${(e=>{switch(e){case 0:return"name";case 1:return"cloud_provider";case 2:return"region";case 3:return"owner";case 4:return"status";case 5:return"created_at";default:return""}})(t)} ${n}`)},sortBy:R,hasDefaultCustomRowWrapper:!0,ouiaId:"table-kafka-instances"},activeRow:E,onRowClick:(e,t,i)=>{if(e.target instanceof HTMLElement){const t=e.target.tagName.toLowerCase();if("button"===t||"a"===t)return}a(null==i?void 0:i.originalData)},rowDataTestId:"tableStreams-row",loggedInUser:h}),(0,n.jsx)(m,{count:(null==j?void 0:j.length)||0,dataLoaded:y}),(0,n.jsx)(p,{total:S,page:b,perPage:x})]})}},88688:(e,t,a)=>{a.d(t,{V:()=>y});var i=a(9922),n=a(85893),r=a(88601),l=a(3433),o=a(13449),s=a(93264);function d(e,t){const a=(0,s.useRef)();(0,s.useEffect)((()=>{a.current=e}),[e]),(0,s.useEffect)((()=>{if(null!==t){const e=setInterval((function(){a.current&&a.current()}),t);return()=>{clearInterval(e)}}}),[t])}var c=a(81548),u=a(63286),v=a(11228),p=a(51622),m=(a(27081),a(75381)),g=a(99922),f=a(52212),_=a(98743),h=a(68199),b=a(24584);function x(){const e=function(){const e=document;return void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":void 0}();return void 0!==e&&!document[e]}function S(){const[e,t]=(0,s.useState)(x()),a=()=>t(x());return(0,s.useEffect)((()=>{const e=function(){const e=document;return void 0!==e.hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":""}();return document.addEventListener(e,a,!1),()=>{document.removeEventListener(e,a)}}),[]),{isVisible:e,setIsVisible:t}}function k(e){return{name:e.name,status:e.status}}const y=({preCreateInstance:e})=>{var t;const{shouldOpenCreateModal:a}=(0,o.S)()||{},x=(0,f.useAuth)(),y=(0,r.d)(),j=(0,b.AU)("developer"),F=(0,h.useLocation)(),w=(0,s.useMemo)((()=>new URLSearchParams(F.search)),[F.search]),{page:O=1,perPage:C=10,setPage:I}=(0,l.h0)()||{},{t:T}=(0,_.useTranslation)(["kasTemporaryFixMe"]),{addAlert:D}=(0,f.useAlert)()||{},{showModal:P}=(0,f.useModal)(),{showModal:M}=(0,f.useModal)(),{hideModal:V,showModal:E}=(0,f.useModal)(),A=(0,h.useHistory)(),{drawerInstance:N,closeDrawer:R,openDrawer:L,setDrawerActiveTab:K,setDrawerInstance:z}=(0,c.gD)(),[G,B]=(0,s.useState)(),[$,U]=(0,s.useState)(!1),[H,Z]=(0,s.useState)(3),[q,Q]=(0,s.useState)(),[Y,J]=(0,s.useState)("created_at desc"),[W,X]=(0,s.useState)("name"),[ee,te]=(0,s.useState)([]),[ae,ie]=(0,s.useState)(!1),[ne,re]=(0,s.useState)(void 0),[le,oe]=(0,s.useState)(),[se,de]=(0,s.useState)(!1),[ce,ue]=(0,s.useState)(!1);!function(e){const{t}=(0,_.useTranslation)(["kasTemporaryFixMe"]),{addAlert:a}=(0,f.useAlert)()||{},{isVisible:i}=S(),r=(0,s.useRef)(),l=(0,s.useRef)([]),o=(0,s.useRef)([]),c=(0,s.useCallback)((e=>{a({title:t("kafka_successfully_created"),variant:g.AlertVariant.success,description:(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:t("kafka_success_message",{name:e})}}),dataTestId:"toastCreateKafka-success"})}),[a,t]),u=(0,s.useCallback)((e=>{a({title:t("kafka_successfully_deleted",{name:e}),variant:g.AlertVariant.success})}),[a,t]),v=(0,s.useCallback)((e=>{a({title:t("kafka_not_created"),variant:g.AlertVariant.danger,description:(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:t("kafka_failed_message",{name:e})}}),dataTestId:"toastCreateKafka-failed"})}),[a,t]);(0,s.useEffect)((function(){if(e){const t=void 0===r.current,a=r.current||[],i=a.map((e=>`${e.id}:${e.status}`)),n=e.map((e=>`${e.id}:${e.status}`));if(JSON.stringify(i)!==JSON.stringify(n)){const i=(e,i)=>t?[]:e.filter((e=>e.status===i&&!a.find((t=>t.id===e.id&&e.status!==i)))),n=i(e,m.Od.READY),s=i(e,m.Od.FAILED),[d,c]=l.current.reduce((([t,a],i)=>void 0===e.find((e=>e.id===i.id))?[[...t,i],a]:[t,[...a,i]]),[[],[]]),u=e.filter((e=>[m.Od.DELETED,m.Od.DEPROVISION].includes(e.status)&&void 0===c.find((t=>t.id===e.id))));l.current=[...c,...u],o.current=[...o.current,...n.map(k),...s.map(k),...d.map(k)],r.current=e}}}),[e]),d((0,s.useCallback)((function(){if(i)for(;o.current.length>0;){const e=o.current.shift();switch(e.status){case m.Od.READY:c(e.name);break;case m.Od.FAILED:v(e.name);break;case m.Od.DEPROVISION:case m.Od.DELETED:u(e.name)}}}),[i,u,v,c]),1e3)}(null===(t=null==G?void 0:G.items)||void 0===t?void 0:t.filter((e=>e.owner===ne)));const ve=(0,s.useCallback)((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=[];return yield Promise.all(null==e?void 0:e.map((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{instance_type:a,cloud_provider:i,region:n}=e;let r;if("developer"===a&&i&&n){r={trialDurationHours:(yield j(i,n))[0].trialDurationHours}}t.push(Object.assign(Object.assign({},e),{size:r}))}))))),t}))),[j]),pe=()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let t;e&&(t=yield e(!0)),t&&Se()})),me=e=>{z(e.id),K(u.Z.DETAILS),L()},ge=e=>{z(e.id),K(u.Z.CONNECTION),L()},fe=(0,s.useCallback)((()=>{const e=[];return ee.forEach((t=>{const{filterKey:a,filterValue:i}=t;if(i&&i.length>0){let t="(";t+=i.map((e=>{const t=e.value.trim();return t===m.Od.PROVISIONING?`${a} = ${m.Od.PREPARING} or ${a} = ${m.Od.PROVISIONING}`:t===m.Od.DEPROVISION?`${a} = ${m.Od.DEPROVISION} or ${a} = ${m.Od.DELETED}`:""!==t?`${a} ${!0===e.isExact?`= ${t}`:`like %${t}%`}`:""})).join(" or "),t+=")",e.push(t)}})),e.join(" and ")}),[ee]),_e=(0,s.useCallback)(((e=!1)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=fe();try{const a=y();e||U(!1),ue(!1),yield a.getKafkas(null==O?void 0:O.toString(),null==C?void 0:C.toString(),Y,t).then((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.data,a=(null==t?void 0:t.items)||[];B(t);const i=yield ve(a);Q(i),void 0!==(null==G?void 0:G.total)&&G.total>H&&Z(G.total),se&&ee.length<1&&0==(null==a?void 0:a.length)&&de(!1)})))).finally((()=>U(!0)))}catch(e){(e=>{var t,a;let i;(0,m.G6)(e)&&(i=null===(a=null===(t=e.response)||void 0===t?void 0:t.data)||void 0===a?void 0:a.code),i===m.SM.UNAUTHORIZED_USER&&ie(!0)})(e)}}))),[y,H,ee,fe,G,Y,O,C,se,ve]),he=(0,s.useCallback)((e=>{te(e),I&&I(1)}),[I]),be=(0,s.useCallback)((()=>{ue(!0)}),[]),xe=(0,s.useCallback)((()=>{Z((void 0===G?0:G.total)+1)}),[G]),Se=(0,s.useCallback)((()=>{P(f.ModalType.KasCreateInstance,{onCreate:()=>{xe(),be()}})}),[xe,be,P]),ke=()=>{Z((void 0===G?0:G.total)-1)},ye=(0,s.useCallback)(((e,t)=>{w.set(e,t.toString())}),[w]),je=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){M(f.ModalType.KasTransferOwnership,{kafka:e,refreshKafkas:be})})),Fe=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const t=()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){yield we(e),ke()}));e.status===m.Od.FAILED?yield t():E(f.ModalType.KasDeleteInstance,{onDelete:t,kafka:e})})),we=e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var t;if(void 0===e.id)throw new Error("kafka instanceDrawerInstance id is not set");const a=y();ke(),V();try{yield a.deleteKafkaById(e.id,!0).then((()=>{de(!0),be()}))}catch(e){let a;(0,m.G6)(e)&&(a=null===(t=e.response)||void 0===t?void 0:t.data.reason),D&&D({title:T("common.something_went_wrong"),variant:g.AlertVariant.danger,description:a})}}));(0,s.useEffect)((()=>{O>1&&void 0!==(null==G?void 0:G.items)&&0===G.size&&(ye("page",(O-1).toString()),ye("perPage",C.toString()),A.push({search:w.toString()}))}),[A,G,O,C,w,ye]);const Oe=(0,s.useRef)(!1);(0,s.useEffect)((()=>{(!1===Oe.current||ce)&&(Oe.current=!0,_e())}),[_e,ce]),(0,s.useEffect)((()=>{be()}),[O,C,Y,w,be,ee]),(0,s.useEffect)((()=>{var e;if(void 0!==G&&(null==G?void 0:G.size)>0&&N){void 0===(null===(e=G.items)||void 0===e?void 0:e.find((e=>(null==e?void 0:e.id)===(null==N?void 0:N.id))))&&R()}}),[R,N,null==N?void 0:N.id,G,L]),(0,s.useEffect)((()=>{0===(null==G?void 0:G.size)&&R()}),[G,R]),(0,s.useEffect)((()=>{var e,t;null===(e=x.getUsername())||void 0===e||e.then((e=>re(e))),null===(t=x.isOrgAdmin())||void 0===t||t.then((e=>oe(e)))}),[x]),(0,s.useEffect)((()=>{(0,i.__awaiter)(void 0,void 0,void 0,(function*(){a&&(yield a())&&Se()}))}),[Se,a]);if(d((0,s.useCallback)((function(){_e(!0)}),[_e]),m.md),ae)return(0,n.jsx)(v.NI,{});const Ce=$&&ee.length<1&&void 0!==G&&(null==G?void 0:G.total)<1;return Ce?(0,n.jsx)(v.hs,{handleCreateInstanceModal:pe}):void 0!==Ce?(0,n.jsx)(g.PageSection,Object.assign({className:"mk--main-page__page-section--table pf-m-padding-on-xl",variant:g.PageSectionVariants.default,padding:{default:"noPadding"},"data-ouia-component-id":"page-KafkaInstances"},{children:(0,n.jsx)(g.Card,Object.assign({ouiaId:"card-controlplane"},{children:(0,n.jsx)(p.G,{onDeleteInstance:Fe,onViewInstance:me,onViewConnection:ge,onChangeOwner:je,loggedInUser:ne,page:O,perPage:C,total:(null==G?void 0:G.total)||0,isOrgAdmin:le,expectedTotal:H,kafkaDataLoaded:$,kafkaInstanceItems:q,setOrderBy:J,setFilterSelected:X,setFilteredValue:he,filteredValue:ee,handleCreateInstanceModal:pe,orderBy:Y,filterSelected:W,onCreate:xe,refresh:be,selectedInstanceName:null==N?void 0:N.name})}))})):(0,n.jsx)(n.Fragment,{})}},11228:(e,t,a)=>{a.d(t,{hs:()=>D,LF:()=>P,qV:()=>c,eG:()=>O,NI:()=>I});a(51622);var i=a(85893),n=a(98743),r=a(99922),l=a(35451),o=a(41942),s=a(84564),d=a(52648);const c=({status:e,instanceName:t})=>{const{t:a}=(0,n.useTranslation)(["kasTemporaryFixMe"]),c=()=>{switch(null==e?void 0:e.toLowerCase()){case d.hm[0].value:return(0,i.jsx)(l.ZP,{className:"mk--instances__table--icon--completed"});case d.hm[1].value:return(0,i.jsx)(s.ZP,{className:"mk--instances__table--icon--failed"});case d.hm[2].value:return(0,i.jsx)(o.ZP,{});case d.hm[3].value:case d.hm[4].value:return(0,i.jsx)(r.Spinner,{size:"md","aria-label":t,"aria-valuetext":"Creation in progress"});case d.hm[5].value:case d.hm[6].value:return;default:return(0,i.jsx)(o.ZP,{})}};return(0,i.jsxs)(r.Flex,{children:[(0,i.jsx)((()=>{const e=c();return e?(0,i.jsx)(r.FlexItem,Object.assign({spacer:{default:"spacerSm"}},{children:e})):(0,i.jsx)(i.Fragment,{})}),{}),(0,i.jsx)(r.FlexItem,{children:(0,i.jsx)((()=>{const t=d.hm.filter((t=>t.value===(null==e?void 0:e.toLowerCase())));return 1===t.length?a(t[0].value):a("creation_pending")}),{})})]})};var u=a(93264),v=a(8755),p=a(3433),m=a(75381);const g=(e,t)=>{const{t:a}=(0,n.useTranslation)(["kasTemporaryFixMe"]);return e?(0,i.jsx)("div",{children:a("max_filter_message")}):"owner"===t?(0,i.jsx)("div",{children:a("owner_field_invalid_message",{name:t})}):(0,i.jsx)("div",{children:a("input_field_invalid_message",{name:t})})},f=({getSelectionForFilter:e,filterSelected:t,onDeleteChipGroup:a,onDeleteChip:l,updateFilter:o,isMaxFilter:s,removeFilterValue:d,isDisabledSelectOption:c})=>{var u;const{t:v}=(0,n.useTranslation)(["kasTemporaryFixMe"]),p=m.bv.map((e=>({label:v(e.value),value:e.value,disabled:!1})));return(0,i.jsx)(r.ToolbarFilter,Object.assign({chips:null===(u=e("cloud_provider"))||void 0===u?void 0:u.map((e=>v(e))),deleteChip:(e,t)=>l&&l("cloud_provider",t,p),deleteChipGroup:()=>a&&a("cloud_provider"),categoryName:v("cloud_provider"),showToolbarItem:"cloud_provider"===t},{children:(0,i.jsx)(_,{updateFilter:o,isMaxFilter:s,removeFilterValue:d,isDisabledSelectOption:c,options:p,getSelectionForFilter:e,filterSelected:t})}))},_=({updateFilter:e,isMaxFilter:t,removeFilterValue:a,isDisabledSelectOption:l,options:o,getSelectionForFilter:s,filterSelected:d})=>{const{t:c}=(0,n.useTranslation)(["kasTemporaryFixMe"]),v=(0,u.useRef)(null),p=g(t),m=()=>t?(0,i.jsx)(r.Tooltip,{isVisible:t,content:p,reference:v}):(0,i.jsx)(i.Fragment,{}),[f,_]=(0,u.useState)(!1),h=()=>{_((e=>!e))},b=(t,a,i)=>{i&&x(),e("cloud_provider",{value:a.toString(),isExact:!0},!0),o.length<2&&_(!1)},x=()=>{a&&a("cloud_provider"),_(!1)};return"cloud_provider"===d?(0,i.jsx)(r.Select,Object.assign({id:"cloud-provider-select",variant:r.SelectVariant.checkbox,"aria-label":"Select cloud provider",onToggle:h,selections:s("cloud_provider"),isOpen:f,onSelect:b,placeholderText:c("filter_by_cloud_provider"),className:"select-custom-width",ref:v},{children:o.map(((e,a)=>(0,i.jsxs)(r.SelectOption,Object.assign({isDisabled:!!e.disabled||t&&l("cloud_provider",e.value),value:e.value},{children:[(0,i.jsx)(m,{}),e.label]}),a)))})):(0,i.jsx)(i.Fragment,{})};var h=a(71070);const b=({getSelectionForFilter:e,onDeleteChip:t,onDeleteChipGroup:a,filterSelected:l,isMaxFilter:o,updateFilter:s})=>{const{t:d}=(0,n.useTranslation)(["kasTemporaryFixMe"]),[c,v]=(0,u.useState)(!0),[p,m]=(0,u.useState)(),f=(0,u.useRef)(null),_=g(o,"name"),b=e=>{m(e),!c&&v(!0)},x=e=>{"Enter"!==e.key||o||S()},S=()=>{p&&""!=p.trim()&&((e=>!e||/^([a-zA-Z0-9-_%]*[a-zA-Z0-9-_%])?$/.test(e.trim()))(p)?(s("name",{value:p,isExact:!1},!1),m("")):v(!1))};return(0,i.jsx)(r.ToolbarFilter,Object.assign({chips:e("name"),deleteChip:(e,a)=>t("name",a),deleteChipGroup:()=>a("name"),categoryName:d("name"),showToolbarItem:"name"===(null==l?void 0:l.toLowerCase())},{children:(()=>{const e=!c||o,t=()=>e?(0,i.jsx)(r.Tooltip,{isVisible:o||!c,content:_,reference:f}):(0,i.jsx)(i.Fragment,{});return"name"===(null==l?void 0:l.toLowerCase())?(0,i.jsxs)(r.InputGroup,{children:[(0,i.jsx)(r.TextInput,{name:"name",id:"filterText",type:"search","aria-label":"Search filter input",validated:e?r.ValidatedOptions.error:r.ValidatedOptions.default,placeholder:d("filter_by_name_lower"),onChange:b,onKeyPress:x,value:p,ref:f}),(0,i.jsx)(r.Button,Object.assign({variant:r.ButtonVariant.control,isDisabled:!c||o,onClick:()=>S(),"aria-label":"Search instances"},{children:(0,i.jsx)(h.ZP,{})})),(0,i.jsx)(t,{})]}):(0,i.jsx)(i.Fragment,{})})()}))},x=({getSelectionForFilter:e,onDeleteChipGroup:t,onDeleteChip:a,filterSelected:l,isMaxFilter:o,updateFilter:s})=>{const{t:d}=(0,n.useTranslation)(["kasTemporaryFixMe"]),c=(0,u.useRef)(null),v=g(o,"owner"),[p,m]=(0,u.useState)(),[f,_]=(0,u.useState)(!0),b=()=>{p&&""!=p.trim()&&((e=>!e||!/["$^<>|+%/;:,\s*=~#()]/.test(e.trim()))(p)?(s("owner",{value:p,isExact:!1},!1),m("")):_(!1))},x=e=>{"Enter"!==e.key||o||b()},S=e=>{m(e),!f&&_(!0)};return(0,i.jsx)(r.ToolbarFilter,Object.assign({chips:e("owner"),deleteChip:(e,t)=>a("owner",t),deleteChipGroup:()=>t("owner"),categoryName:d("owner"),showToolbarItem:"owner"===(null==l?void 0:l.toLowerCase())},{children:(()=>{if("owner"===(null==l?void 0:l.toLowerCase())){const e=!f||o,t=()=>e?(0,i.jsx)(r.Tooltip,{isVisible:o||!f,content:v,reference:c}):(0,i.jsx)(i.Fragment,{});return(0,i.jsxs)(r.InputGroup,{children:[(0,i.jsx)(r.TextInput,{name:"owner",id:"filterOwners",type:"search","aria-label":"Search filter input",placeholder:d("filter_by_owner"),validated:e?r.ValidatedOptions.error:r.ValidatedOptions.default,onChange:S,onKeyPress:x,value:p,ref:c}),(0,i.jsx)(r.Button,Object.assign({isDisabled:e,variant:r.ButtonVariant.control,onClick:b,"aria-label":"Search owners"},{children:(0,i.jsx)(h.ZP,{})})),(0,i.jsx)(t,{})]})}return(0,i.jsx)(i.Fragment,{})})()}))},S=({getSelectionForFilter:e,onDeleteChip:t,onDeleteChipGroup:a,removeFilterValue:l,isDisabledSelectOption:o,isMaxFilter:s,filterSelected:d,updateFilter:c})=>{var u;const{t:v}=(0,n.useTranslation)(["kasTemporaryFixMe"]),p=m.Bh.map((e=>({label:v(e.value),value:e.value,disabled:!1})));return(0,i.jsx)(r.ToolbarFilter,Object.assign({chips:null===(u=e("region"))||void 0===u?void 0:u.map((e=>v(e))),deleteChip:(e,a)=>t("region",a,p),deleteChipGroup:()=>a("region"),categoryName:v("region"),showToolbarItem:"region"===d},{children:(0,i.jsx)(k,{updateFilter:c,isMaxFilter:s,removeFilterValue:l,isDisabledSelectOption:o,options:p,getSelectionForFilter:e,filterSelected:d})}))},k=({updateFilter:e,isMaxFilter:t,removeFilterValue:a,isDisabledSelectOption:l,options:o,getSelectionForFilter:s,filterSelected:d})=>{const{t:c}=(0,n.useTranslation)(["kasTemporaryFixMe"]),v=(0,u.useRef)(null),p=g(t),[m,f]=(0,u.useState)(!1),_=()=>t?(0,i.jsx)(r.Tooltip,{isVisible:t,content:p,reference:v}):(0,i.jsx)(i.Fragment,{}),h=()=>{f(!m)},b=(t,a,i)=>{i&&x(),e("region",{value:a.toString(),isExact:!0},!0),o.length<2&&f(!1)},x=()=>{a("region"),f(!1)};return"region"===d?(0,i.jsx)(r.Select,Object.assign({id:"region-select",variant:r.SelectVariant.checkbox,"aria-label":"Select region",onToggle:h,selections:s("region"),isOpen:m,onSelect:b,placeholderText:c("filter_by_region"),className:"select-custom-width",ref:v},{children:o.map(((e,a)=>(0,i.jsxs)(r.SelectOption,Object.assign({isDisabled:!!e.disabled||t&&l("region",e.value),value:e.value},{children:[(0,i.jsx)(_,{}),e.label]}),a)))})):(0,i.jsx)(i.Fragment,{})},y=({setFilterSelected:e,filterSelected:t})=>{const{t:a}=(0,n.useTranslation)(["kasTemporaryFixMe"]),[l,o]=(0,u.useState)(!1),s=[{label:a("name"),value:"name",disabled:!1},{label:a("cloud_provider"),value:"cloud_provider",disabled:!1},{label:a("region"),value:"region",disabled:!1},{label:a("owner"),value:"owner",disabled:!1},{label:a("status"),value:"status",disabled:!1}];return(0,i.jsx)(r.ToolbarItem,{children:(0,i.jsx)(r.Select,Object.assign({variant:r.SelectVariant.single,"aria-label":"Select filter",onToggle:()=>{o(!l)},selections:t,isOpen:l,onSelect:(t,a)=>{o(!l),e(null==a?void 0:a.toString())}},{children:s.map(((e,t)=>(0,i.jsx)(r.SelectOption,Object.assign({isDisabled:e.disabled,value:e.value},{children:e.label}),t)))}))})},j=({getSelectionForFilter:e,onDeleteChip:t,onDeleteChipGroup:a,isMaxFilter:l,filterSelected:o,updateFilter:s,removeFilterValue:d,isDisabledSelectOption:c})=>{var u;const{t:v}=(0,n.useTranslation)(["kasTemporaryFixMe"]),p=m.hm.filter((e=>e.value!==m.Od.PREPARING&&e.value!==m.Od.DELETED)).map((e=>({label:v(e.value),value:e.value,disabled:!1})));return(0,i.jsx)(r.ToolbarFilter,Object.assign({chips:null===(u=e("status"))||void 0===u?void 0:u.map((e=>v(e))),deleteChip:(e,a)=>t("status",a,p),deleteChipGroup:()=>a("status"),categoryName:v("status"),showToolbarItem:"status"===o},{children:(0,i.jsx)(F,{updateFilter:s,isMaxFilter:l,removeFilterValue:d,isDisabledSelectOption:c,statusFilterOptions:p,getSelectionForFilter:e,filterSelected:o})}))},F=({updateFilter:e,isMaxFilter:t,removeFilterValue:a,isDisabledSelectOption:l,statusFilterOptions:o,getSelectionForFilter:s,filterSelected:d})=>{const{t:c}=(0,n.useTranslation)(["kasTemporaryFixMe"]),v=g(t),p=(0,u.useRef)(null),[m,f]=(0,u.useState)(!1),_=()=>t?(0,i.jsx)(r.Tooltip,{isVisible:t,content:v,reference:p}):(0,i.jsx)(i.Fragment,{}),h=()=>{f(!m)},b=(t,a,i)=>{i&&x(),e("status",{value:a.toString(),isExact:!0},!0)},x=()=>{a("status"),f(!1)};return"status"===d?(0,i.jsx)(r.Select,Object.assign({id:"status-select",variant:r.SelectVariant.checkbox,"aria-label":"Select status",onToggle:h,selections:s("status"),isOpen:m,onSelect:b,placeholderText:c("filter_by_status"),className:"select-custom-width",ref:p},{children:o.map(((e,a)=>(0,i.jsxs)(r.SelectOption,Object.assign({isDisabled:!!e.disabled||t&&l("status",e.value),value:e.value},{children:[(0,i.jsx)(_,{}),e.label]}),a)))})):(0,i.jsx)(i.Fragment,{})},w=({isMaxFilter:e,filteredValue:t,setFilteredValue:a,filterSelected:n,setFilterSelected:l})=>{const o=(e,a)=>{let i;const n=null==t?void 0:t.filter((({filterKey:t})=>t===e));if(n&&(null==n?void 0:n.length)>0){const{filterValue:e}=n[0];i=null==e?void 0:e.find((({value:e})=>e===a))}return!i},s=(e,i,n)=>{const r=Object.assign([],t),l=r.findIndex((t=>t.filterKey===e));if(l>-1){const e=r[l];if(e.filterValue&&e.filterValue.length>0){const t=e.filterValue.findIndex((e=>e.value===i.value));if(t>-1){if(!n)return;e.filterValue.splice(t,1)}else r[l].filterValue.push(i)}else r[l].filterValue=[i]}else r.push({filterKey:e,filterValue:[i]});a(r)},d=e=>{const a=t.filter((t=>t.filterKey===e));if(a.length>0)return a[0].filterValue.map((e=>e.value))},c=(e,i,n)=>{var r,l;const o=Object.assign([],t),s=o.findIndex((t=>t.filterKey===e)),d=Object.assign([],null===(r=o[s])||void 0===r?void 0:r.filterValue);let c=i.toString();n&&(null==n?void 0:n.length)>0&&(c=null===(l=null==n?void 0:n.find((e=>e.label===i.toString())))||void 0===l?void 0:l.value);const u=d.findIndex((e=>e.value===c));u>=0&&(o[s].filterValue.splice(u,1),a(o))},u=e=>{const i=Object.assign([],t),n=i.findIndex((t=>t.filterKey===e));n>=0&&(i.splice(n,1),a(i))},v=e=>{const i=Object.assign([],t),n=i.findIndex((t=>t.filterKey===e));n>=0&&i.splice(n,1),a(i)};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(r.ToolbarGroup,Object.assign({variant:"filter-group"},{children:[(0,i.jsx)(y,{setFilterSelected:l,filterSelected:n}),(0,i.jsx)(b,{isMaxFilter:e,filterSelected:n,getSelectionForFilter:d,updateFilter:s,onDeleteChip:c,onDeleteChipGroup:u,removeFilterValue:v,isDisabledSelectOption:o}),(0,i.jsx)(f,{isMaxFilter:e,filterSelected:n,getSelectionForFilter:d,updateFilter:s,onDeleteChip:c,onDeleteChipGroup:u,removeFilterValue:v,isDisabledSelectOption:o}),(0,i.jsx)(S,{isMaxFilter:e,filterSelected:n,getSelectionForFilter:d,updateFilter:s,onDeleteChip:c,onDeleteChipGroup:u,removeFilterValue:v,isDisabledSelectOption:o}),(0,i.jsx)(x,{isMaxFilter:e,filterSelected:n,getSelectionForFilter:d,updateFilter:s,onDeleteChip:c,onDeleteChipGroup:u,removeFilterValue:v,isDisabledSelectOption:o}),(0,i.jsx)(j,{isMaxFilter:e,filterSelected:n,getSelectionForFilter:d,updateFilter:s,onDeleteChip:c,onDeleteChipGroup:u,removeFilterValue:v,isDisabledSelectOption:o})]}))})},O=({setFilterSelected:e,filterSelected:t="name",total:a,page:l,perPage:o,filteredValue:s,setFilteredValue:d,handleCreateInstanceModal:c})=>{const{t:g}=(0,n.useTranslation)(["kasTemporaryFixMe"]),[f,_]=(0,u.useState)(!1),h=(0,u.useCallback)((()=>{let e=0;null==s||s.forEach((t=>{const{filterValue:a,filterKey:i}=t,n="status"===i?null==a?void 0:a.filter((({value:e})=>e===m.Od.PROVISIONING)):[],r="status"===i?null==a?void 0:a.filter((({value:e})=>e===m.Od.DEPROVISION)):[];(null==n?void 0:n.length)>0&&(null==r?void 0:r.length)>0?e+=(null==a?void 0:a.length)+2:(null==n?void 0:n.length)>0||(null==r?void 0:r.length)>0?e+=(null==a?void 0:a.length)+1:e+=null==a?void 0:a.length})),e>=m.pf?_(!0):_(!1)}),[s]);(0,u.useEffect)((()=>{h()}),[h]);const b=[{item:(0,i.jsx)(r.Button,Object.assign({variant:"primary",onClick:c,"data-testid":"tableStreams-buttonCreateKafka",ouiaId:"button-create"},{children:g("create_kafka_instance")}))}];return a&&a>0&&b.push({item:(0,i.jsx)(p.wu,{widgetId:"pagination-cloudProviderOptions-menu-top",itemCount:a,page:l,perPage:o,isCompact:!0,titles:{paginationTitle:g("minimal_pagination"),perPageSuffix:g("per_page_suffix"),toFirstPage:g("to_first_page"),toPreviousPage:g("to_previous_page"),toLastPage:g("to_last_page"),toNextPage:g("to_next_page"),optionsToggle:g("options_toggle"),currPage:g("curr_page")}}),variant:"pagination",alignment:{default:"alignRight"}}),(0,i.jsx)(p.L5,{toolbarProps:{id:"instanceDrawerInstance-toolbar",clearAllFilters:()=>{d([]),_(!1)},collapseListedFiltersBreakpoint:"md",inset:{xl:"insetLg"}},toggleGroupProps:{toggleIcon:(0,i.jsx)(v.ZP,{}),breakpoint:"md"},toggleGroupItems:(0,i.jsx)(w,{isMaxFilter:f,filteredValue:s,setFilteredValue:d,setFilterSelected:e,filterSelected:t}),toolbarItems:b})};var C=a(5569);const I=()=>{const{t:e}=(0,n.useTranslation)(["kasTemporaryFixMe"]);return(0,i.jsx)(r.PageSection,Object.assign({variant:r.PageSectionVariants.default,padding:{default:"noPadding"},isFilled:!0},{children:(0,i.jsx)(p.C0,{titleProps:{title:e("access_permissions_needed"),headingLevel:"h2"},emptyStateIconProps:{icon:C.ZP},emptyStateBodyProps:{body:e("to_access_kafka_instances_contact_your_organization_administrators")}})}))};var T=a(10069);const D=({handleCreateInstanceModal:e})=>{const{t}=(0,n.useTranslation)(["kasTemporaryFixMe"]),a=(0,u.useContext)(T.QuickStartContext);return(0,i.jsx)(r.PageSection,Object.assign({padding:{default:"noPadding"},isFilled:!0},{children:(0,i.jsx)(p.C0,Object.assign({emptyStateProps:{variant:p.jU.NoItems},emptyStateBodyProps:{body:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(n.Trans,{i18nKey:"create_a_kafka_instance_to_get_started",ns:["kasTemporaryFixMe"],components:[(0,i.jsx)(r.Button,{variant:r.ButtonVariant.link,isSmall:!0,isInline:!0,onClick:()=>a.setActiveQuickStart&&a.setActiveQuickStart("getting-started")},"btn-quick-start")]})})},titleProps:{title:t("no_kafka_instances_yet")}},{children:(0,i.jsx)(r.Button,Object.assign({"data-testid":"emptyStateStreams-buttonCreateKafka",variant:r.ButtonVariant.primary,onClick:()=>e&&e(),ouiaId:"button-create"},{children:t("create_kafka_instance")}))}))}))},P=({children:e})=>{const{t}=(0,n.useTranslation)(["kasTemporaryFixMe"]),[a,l]=(0,u.useState)(!1);(0,u.useEffect)((()=>{if((0,m.Qw)()){const e=window.localStorage;if(e){const t=parseInt(e.getItem("openSessions")||"0"),a=t+1;t<1&&(e.setItem("openSessions",`${a}`),l(!0))}}}),[]);const o=()=>{l(!a)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("main",Object.assign({className:"pf-c-page__main"},{children:[(0,i.jsx)(r.PageSection,Object.assign({variant:r.PageSectionVariants.light},{children:(0,i.jsx)(r.Level,{children:(0,i.jsx)(r.LevelItem,{children:(0,i.jsx)(r.TextContent,{children:(0,i.jsx)(r.Text,Object.assign({component:"h1"},{children:t("kafka_instances")}))})})})})),e]})),(0,i.jsx)(r.Modal,Object.assign({variant:r.ModalVariant.small,title:"Mobile experience",isOpen:a,onClose:()=>o(),actions:[(0,i.jsx)(r.Button,Object.assign({variant:"primary",onClick:()=>o()},{children:"Ok"}),"confirm")]},{children:"The mobile experience isn't fully optimized yet, so some items might not appear correctly."}))]})}},24584:(e,t,a)=>{a.d(t,{b4:()=>d,qT:()=>s,DO:()=>_,TM:()=>c,AU:()=>v,dt:()=>p,df:()=>m});var i=a(9922),n=a(88601),r=a(75381),l=a(52212);const o="rhosak",s=()=>{const e=(0,n.c)();return({onNoQuotaAvailable:t,onOutOfQuota:a,onQuotaAvailable:n})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,r,l,s;try{const d=e(),c=yield d.apiAccountsMgmtV1CurrentAccountGet(),u=null===(r=null===(i=null==c?void 0:c.data)||void 0===i?void 0:i.organization)||void 0===r?void 0:r.id;if(!u)throw new Error("User has no organization id");const v=yield d.apiAccountsMgmtV1OrganizationsOrgIdQuotaCostGet(u,void 0,!0,void 0,!0);if(200!==v.status)throw new Error(v.statusText);const p=null===(l=v.data.items)||void 0===l?void 0:l.filter((e=>{var t;return null===(t=e.related_resources)||void 0===t?void 0:t.find((e=>e.resource_name===o&&"RHOSAK"===e.product))})),m=null==p?void 0:p.find((e=>{var t;return null===(t=e.related_resources)||void 0===t?void 0:t.find((e=>"standard"===e.billing_model))})),g=null==p?void 0:p.filter((e=>{var t;return null===(t=e.related_resources)||void 0===t?void 0:t.find((e=>"marketplace"===e.billing_model))})),f=(null===(s=v.data.items)||void 0===s?void 0:s.some((e=>{var t;return null===(t=e.related_resources)||void 0===t?void 0:t.find((e=>e.resource_name===o&&"RHOSAKTrial"===e.product))})))||!1,_=m?m.allowed-m.consumed:void 0,h=null==g?void 0:g.reduce(((e,t)=>t.allowed-t.consumed+e),0),b=null==g?void 0:g.filter((e=>void 0!==e.cloud_accounts)).flatMap((e=>e.cloud_accounts)),x=Array.from(new Set(null==b?void 0:b.map((e=>e.cloud_provider_id)))),S=b?x.map((e=>({marketplace:e,subscriptions:b.filter((t=>t.cloud_provider_id===e)).map((e=>e.cloud_account_id))}))):[];h||_?h&&0===h&&_&&0===_?a({quota:{marketplaceSubscriptions:S}}):n({quota:{remainingPrepaidQuota:_,remainingMarketplaceQuota:h,marketplaceSubscriptions:S}}):t({hasTrialQuota:f})}catch(e){t({hasTrialQuota:!1})}}))},d=()=>{const e=(0,l.useAuth)(),t=(0,n.d)();return({onAvailable:a,onUnavailable:n,onUsed:l})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const i=t(),n=`owner = ${yield e.getUsername()}`,o=yield i.getKafkas("","","",n);if(o.data.items){o.data.items.some((e=>(null==e?void 0:e.instance_type)===(null===r.ik||void 0===r.ik?void 0:r.ik.eval)||(null==e?void 0:e.instance_type)===(null===r.ik||void 0===r.ik?void 0:r.ik.developer)))?l():a()}}catch(e){n()}}))},c=()=>{const e=(0,n.d)(),t=u();return(a,{onAvailable:n,onUnavailable:r})=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var l;try{const r=e(),o=yield r.getCloudProviders(),s=(null===(l=null==o?void 0:o.data)||void 0===l?void 0:l.items)||[],d=yield Promise.all(s.filter((e=>e.enabled)).map((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const i=yield t(e.id,a);return{id:e.id,displayName:e.display_name,regions:i}}))))),c=d[0];n({providers:d,defaultProvider:null==c?void 0:c.id})}catch(e){r()}}))},u=()=>{const e=(0,n.d)();return function(t,a){var n;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e(),r=yield i.getCloudProviderRegions(t);if(!(null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.items))return[];return r.data.items.filter((e=>e.enabled&&e.capacity.some((e=>e.instance_type===a)))).map((e=>{var t;const i=null===(t=e.capacity)||void 0===t?void 0:t.some((e=>{var t;return e.instance_type===a&&0===(null===(t=e.available_sizes)||void 0===t?void 0:t.length)}));return{id:e.id,displayName:e.display_name,isDisabled:i,capacity:e.capacity}}))}))}},v=e=>{const t=(0,n.d)(),a=u();return(n,r)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,l,o;const s=t(),d=(yield a(n,e)).find((e=>e.id===r)),c=(null==d?void 0:d.capacity.flatMap((e=>e.available_sizes.map((t=>`${e.instance_type}.${t}`)))))||[],u=yield s.getInstanceTypesByCloudProviderAndRegion(n,r);if(!(null===(i=null==u?void 0:u.data)||void 0===i?void 0:i.instance_types))throw new Error("No instance_types from backend");return((null===(o=null===(l=null==u?void 0:u.data)||void 0===l?void 0:l.instance_types.find((t=>t.id===e)))||void 0===o?void 0:o.sizes)||[]).map(g.bind(void 0,(t=>!c.includes(`${e}.${t}`))))}))},p=()=>v("standard"),m=()=>{const e=v("standard"),t=v("developer");return(a,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){let i;try{i=yield e(a,n)}catch(e){i=[{id:"1",displayName:"1"},{id:"2",displayName:"2"}]}return{standard:i,trial:(yield t(a,n))[0]}}))};function g(e,t){const a=t;return{id:a.id,displayName:a.display_name,quota:a.quota_consumed,ingress:(a.ingress_throughput_per_sec.bytes||0)/1048576,egress:(a.egress_throughput_per_sec.bytes||0)/1048576,storage:Math.round((a.max_data_retention_size.bytes||0)/1073741824),connections:a.total_max_connections,connectionRate:a.max_connection_attempts_per_sec,maxPartitions:a.max_partitions,messageSize:(a.max_message_size.bytes||0)/1048576,status:"stable"===a.maturity_status?"stable":"preview",trialDurationHours:a.lifespan_seconds?a.lifespan_seconds/60/60:0,isDisabled:e(a.id)}}var f=a(78261);const _=()=>{const e=(0,n.d)();return(t,a,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i;const l=e();try{const e=(e=>{if(void 0===e.name.value)throw new Error("kafkaRequest.name must not be undefined");if(void 0===e.region.value)throw new Error("kafkaRequest.region must not be undefined");if(void 0===e.multi_az.value)throw new Error("kafkaRequest.multi_az must not be undefined");if(void 0===e.cloud_provider.value)throw new Error("kafkaRequest.cloud_provider must not be undefined");return{name:e.name.value,region:e.region.value,cloud_provider:e.cloud_provider.value}})({cloud_provider:{value:""},multi_az:{value:!0},region:{value:""},name:{value:""}});e.name=t.name,e.cloud_provider=t.provider,e.region=t.region,e.plan=t.plan+"."+t.sizeId,e.billing_model="prepaid"===t.billing?"prepaid":void 0!==t.billing?"marketplace":null,e.billing_cloud_account_id=t.billing&&"prepaid"!==t.billing?t.billing.subscription:null,yield l.createKafka(!0,e),a()}catch(e){if((0,f.G6)(e)){const{code:a}=(null===(i=null==e?void 0:e.response)||void 0===i?void 0:i.data)||{};switch(t.plan){case"developer":if(a===r.SM.DUPLICATE_INSTANCE_NAME)n("name-taken");else n("developer-unavailable");break;case"standard":switch(a){case r.SM.DUPLICATE_INSTANCE_NAME:n("name-taken");break;case r.SM.INTERNAL_CAPACITY_ERROR:n("region-unavailable");break;case r.SM.INSUFFICIENT_QUOTA:n("insufficient-quota");break;default:console.error("useAvailableProvidersAndDefault","createKafka unknown error",e),n("unknown")}}}else console.error("useAvailableProvidersAndDefault","createKafka unexpected error",e)}}))}}}]);
//# sourceMappingURL=7415.39b06602.js.map