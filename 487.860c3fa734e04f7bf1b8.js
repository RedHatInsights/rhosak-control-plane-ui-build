(self.webpackChunkmk_ui_frontend=self.webpackChunkmk_ui_frontend||[]).push([[487],{13487:(e,t,n)=>{"use strict";n.d(t,{L:()=>K});var a,r=n(70655),i=n(15691),o=n.n(i),s=n(91995),c=n(17751),l=n(55459),u=function(e){var t=e.createStreamsInstance,n=e.setCreateStreamsInstance,a=(e.mainToggle,(0,c.useTranslation)().t);return o().createElement(o().Fragment,null,o().createElement(s.EmptyState,null,o().createElement(s.EmptyStateIcon,{icon:l.PlusCircleIcon}),o().createElement(s.Title,{headingLevel:"h4",size:"lg"},a("You don't have any Streams instances yet")),o().createElement(s.EmptyStateBody,null,a("Create a Streams instance to get started")),o().createElement(s.Button,{variant:"primary",onClick:function(){return n(!t)}},a("Create a Streams Instance"))))},d=n(42953),f=n(8575),m=n(69104),p=n.n(m),h="http://localhost:8000".replace(/\/+$/,""),v=function(e,t,n){void 0===t&&(t=h),void 0===n&&(n=p()),this.basePath=t,this.axios=n,e&&(this.configuration=e,this.basePath=e.basePath||this.basePath)},g=function(e){function t(t,n){var a=e.call(this,n)||this;return a.field=t,a.name="RequiredError",a}return(0,r.ZT)(t,e),t}(Error),k=function(e){var t=this;return{createKafka:function(n,a,i){return void 0===i&&(i={}),(0,r.mG)(t,void 0,Promise,(function(){var t,o,s,c,l,u,d,m;return(0,r.Jh)(this,(function(p){if(null==n)throw new g("async","Required parameter async was null or undefined when calling createKafka.");if(null==a)throw new g("kafkaRequest","Required parameter kafkaRequest was null or undefined when calling createKafka.");return"/api/managed-services-api/v1/kafkas",t=f.Qc("/api/managed-services-api/v1/kafkas",!0),e&&(o=e.baseOptions),s=(0,r.pi)((0,r.pi)({method:"POST"},o),i),c={},l={},e&&e.accessToken&&(u="function"==typeof e.accessToken?e.accessToken():e.accessToken,c.Authorization="Bearer "+u),void 0!==n&&(l.async=n),c["Content-Type"]="application/json",t.query=(0,r.pi)((0,r.pi)((0,r.pi)({},t.query),l),i.query),delete t.search,d=o&&o.headers?o.headers:{},s.headers=(0,r.pi)((0,r.pi)((0,r.pi)({},c),d),i.headers),m="string"!=typeof a||"application/json"===s.headers["Content-Type"],s.data=m?JSON.stringify(void 0!==a?a:{}):a||"",[2,{url:f.WU(t),options:s}]}))}))},createServiceAccount:function(n){return void 0===n&&(n={}),(0,r.mG)(t,void 0,Promise,(function(){var t,a,i,o,s,c,l;return(0,r.Jh)(this,(function(u){return"/api/managed-services-api/v1/serviceAccount",t=f.Qc("/api/managed-services-api/v1/serviceAccount",!0),e&&(a=e.baseOptions),i=(0,r.pi)((0,r.pi)({method:"GET"},a),n),o={},s={},e&&e.accessToken&&(c="function"==typeof e.accessToken?e.accessToken():e.accessToken,o.Authorization="Bearer "+c),t.query=(0,r.pi)((0,r.pi)((0,r.pi)({},t.query),s),n.query),delete t.search,l=a&&a.headers?a.headers:{},i.headers=(0,r.pi)((0,r.pi)((0,r.pi)({},o),l),n.headers),[2,{url:f.WU(t),options:i}]}))}))},deleteKafkaById:function(n,a){return void 0===a&&(a={}),(0,r.mG)(t,void 0,Promise,(function(){var t,i,o,s,c,l,u,d;return(0,r.Jh)(this,(function(m){if(null==n)throw new g("id","Required parameter id was null or undefined when calling deleteKafkaById.");return t="/api/managed-services-api/v1/kafkas/{id}".replace("{id}",encodeURIComponent(String(n))),i=f.Qc(t,!0),e&&(o=e.baseOptions),s=(0,r.pi)((0,r.pi)({method:"DELETE"},o),a),c={},l={},e&&e.accessToken&&(u="function"==typeof e.accessToken?e.accessToken():e.accessToken,c.Authorization="Bearer "+u),i.query=(0,r.pi)((0,r.pi)((0,r.pi)({},i.query),l),a.query),delete i.search,d=o&&o.headers?o.headers:{},s.headers=(0,r.pi)((0,r.pi)((0,r.pi)({},c),d),a.headers),[2,{url:f.WU(i),options:s}]}))}))},getKafkaById:function(n,a){return void 0===a&&(a={}),(0,r.mG)(t,void 0,Promise,(function(){var t,i,o,s,c,l,u,d;return(0,r.Jh)(this,(function(m){if(null==n)throw new g("id","Required parameter id was null or undefined when calling getKafkaById.");return t="/api/managed-services-api/v1/kafkas/{id}".replace("{id}",encodeURIComponent(String(n))),i=f.Qc(t,!0),e&&(o=e.baseOptions),s=(0,r.pi)((0,r.pi)({method:"GET"},o),a),c={},l={},e&&e.accessToken&&(u="function"==typeof e.accessToken?e.accessToken():e.accessToken,c.Authorization="Bearer "+u),i.query=(0,r.pi)((0,r.pi)((0,r.pi)({},i.query),l),a.query),delete i.search,d=o&&o.headers?o.headers:{},s.headers=(0,r.pi)((0,r.pi)((0,r.pi)({},c),d),a.headers),[2,{url:f.WU(i),options:s}]}))}))},listKafkas:function(n,a,i){return void 0===i&&(i={}),(0,r.mG)(t,void 0,Promise,(function(){var t,o,s,c,l,u,d;return(0,r.Jh)(this,(function(m){return"/api/managed-services-api/v1/kafkas",t=f.Qc("/api/managed-services-api/v1/kafkas",!0),e&&(o=e.baseOptions),s=(0,r.pi)((0,r.pi)({method:"GET"},o),i),c={},l={},e&&e.accessToken&&(u="function"==typeof e.accessToken?e.accessToken():e.accessToken,c.Authorization="Bearer "+u),void 0!==n&&(l.page=n),void 0!==a&&(l.size=a),t.query=(0,r.pi)((0,r.pi)((0,r.pi)({},t.query),l),i.query),delete t.search,d=o&&o.headers?o.headers:{},s.headers=(0,r.pi)((0,r.pi)((0,r.pi)({},c),d),i.headers),[2,{url:f.WU(t),options:s}]}))}))}}},E=function(e){return{createKafka:function(t,n,a){return(0,r.mG)(this,void 0,Promise,(function(){var i;return(0,r.Jh)(this,(function(o){switch(o.label){case 0:return[4,k(e).createKafka(t,n,a)];case 1:return i=o.sent(),[2,function(e,t){void 0===e&&(e=p()),void 0===t&&(t=h);var n=(0,r.pi)((0,r.pi)({},i.options),{url:t+i.url});return e.request(n)}]}}))}))},createServiceAccount:function(t){return(0,r.mG)(this,void 0,Promise,(function(){var n;return(0,r.Jh)(this,(function(a){switch(a.label){case 0:return[4,k(e).createServiceAccount(t)];case 1:return n=a.sent(),[2,function(e,t){void 0===e&&(e=p()),void 0===t&&(t=h);var a=(0,r.pi)((0,r.pi)({},n.options),{url:t+n.url});return e.request(a)}]}}))}))},deleteKafkaById:function(t,n){return(0,r.mG)(this,void 0,Promise,(function(){var a;return(0,r.Jh)(this,(function(i){switch(i.label){case 0:return[4,k(e).deleteKafkaById(t,n)];case 1:return a=i.sent(),[2,function(e,t){void 0===e&&(e=p()),void 0===t&&(t=h);var n=(0,r.pi)((0,r.pi)({},a.options),{url:t+a.url});return e.request(n)}]}}))}))},getKafkaById:function(t,n){return(0,r.mG)(this,void 0,Promise,(function(){var a;return(0,r.Jh)(this,(function(i){switch(i.label){case 0:return[4,k(e).getKafkaById(t,n)];case 1:return a=i.sent(),[2,function(e,t){void 0===e&&(e=p()),void 0===t&&(t=h);var n=(0,r.pi)((0,r.pi)({},a.options),{url:t+a.url});return e.request(n)}]}}))}))},listKafkas:function(t,n,a){return(0,r.mG)(this,void 0,Promise,(function(){var i;return(0,r.Jh)(this,(function(o){switch(o.label){case 0:return[4,k(e).listKafkas(t,n,a)];case 1:return i=o.sent(),[2,function(e,t){void 0===e&&(e=p()),void 0===t&&(t=h);var n=(0,r.pi)((0,r.pi)({},i.options),{url:t+i.url});return e.request(n)}]}}))}))}}},I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.prototype.createKafka=function(e,t,n){var a=this;return E(this.configuration).createKafka(e,t,n).then((function(e){return e(a.axios,a.basePath)}))},t.prototype.createServiceAccount=function(e){var t=this;return E(this.configuration).createServiceAccount(e).then((function(e){return e(t.axios,t.basePath)}))},t.prototype.deleteKafkaById=function(e,t){var n=this;return E(this.configuration).deleteKafkaById(e,t).then((function(e){return e(n.axios,n.basePath)}))},t.prototype.getKafkaById=function(e,t){var n=this;return E(this.configuration).getKafkaById(e,t).then((function(e){return e(n.axios,n.basePath)}))},t.prototype.listKafkas=function(e,t,n){var a=this;return E(this.configuration).listKafkas(e,t,n).then((function(e){return e(a.axios,a.basePath)}))},t}(v);!function(e){e.COMPLETED="complete",e.ACCEPTED="accepted",e.PROVISIONING="provisioning",e.FAILED="failed"}(a||(a={}));var y=n(52648),S=(n(82519),function(e){var t=e.status,n=t===a.ACCEPTED?"pending case":t;return o().createElement(s.Flex,null,o().createElement(s.FlexItem,{spacer:{default:"spacerSm"}},function(){switch(null==t?void 0:t.toLowerCase()){case a.COMPLETED:return o().createElement(l.CheckCircleIcon,{className:"check-circle-icon-color"});case a.FAILED:return o().createElement(l.ExclamationCircleIcon,{className:"exclamation-circle-icon-color"});case a.PROVISIONING:return o().createElement(s.Spinner,{size:l.IconSize.md});case a.ACCEPTED:default:return o().createElement(l.PendingIcon,null)}}()),o().createElement(s.FlexItem,null,(0,y.kC)(n)))}),T="https://api.stage.openshift.com",b=(function(){function e(){this.apiService=new I}e.getInstance=function(){return void 0===e.singleton&&(e.singleton=new e),e.singleton}}(),n(42603)),C=function(e){e.mainToggle;var t,n=e.kafkaInstanceItems,c=e.onConnectToInstance,l=(0,i.useContext)(b.V).token,u=new I({accessToken:l,basePath:T}),f=function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:if(void 0===e.id)throw new Error("kafka id is not set");n.label=1;case 1:return n.trys.push([1,3,,4]),[4,u.deleteKafkaById(e.id).then((function(e){console.info("Kafka successfully deleted")}))];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),console.log(t),[3,4];case 4:return[2]}}))}))};return o().createElement(s.Card,null,o().createElement(d.Table,{cells:["Name","Cloud provider","Region","Status"],rows:(t=[],n.forEach((function(e){var n=e.name,a=e.cloud_provider,r=e.region,i=e.status,s=(0,y.Or)(a),c=(0,y.KD)(r);t.push({cells:[n,s,c,{title:o().createElement(S,{status:i})}],originalData:e})})),t),"aria-label":"cluster instance list",actionResolver:function(e){return function(e,t,n){var r=e.originalData;return[{title:(null==r?void 0:r.status)===a.ACCEPTED?"Cancel instance":"Delete instance",id:"delete-instance",onClick:function(){return t(r)}},{title:"Connect to instance",id:"connect-instance",onClick:function(){return n(r)}}]}(e,f,c)}},o().createElement(d.TableHeader,null),o().createElement(d.TableBody,null)))},w=function(){this.cloud_provider="",this.multi_az=!1,this.region="",this.name=""},P=n(18324),q=(0,r.pr)([{value:"",label:"Please select ",disabled:!1}],y.Bh),A=function(e){var t=e.createStreamsInstance,n=e.setCreateStreamsInstance,a=new w;a.name="",a.cloud_provider="aws",a.region="us-east-1",a.multi_az=!0;var c=(0,i.useState)(a),u=c[0],d=c[1],f=(0,i.useState)({fieldState:"default"}),m=f[0],p=f[1],h=(0,i.useState)({fieldState:"default"}),v=h[0],g=h[1],k=(0,i.useContext)(b.V).token,E=new I({accessToken:k,basePath:T}),S=(0,P.Z7)().addAlert,C=function(){n(!t)},A="error"!==m.fieldState&&"error"!==v.fieldState,K=function(e){switch(e.toLowerCase()){case"aws":default:return o().createElement(l.AwsIcon,{size:"lg",color:"black",className:"cloud-region-icon"})}};return o().createElement(o().Fragment,null,o().createElement(s.Modal,{variant:s.ModalVariant.medium,title:"Create a Streams instance",isOpen:t,onClose:C,actions:[o().createElement(s.Button,{key:"create",variant:"primary",onClick:function(e){return(0,r.mG)(void 0,void 0,void 0,(function(){var e,t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:if(e=!0,void 0===u.name||""===u.name.trim()?(e=!1,p({fieldState:"error",message:"This is a required field"})):/^[a-zA-Z0-9][a-zA-Z0-9 ]*$/.test(u.name.trim())||(e=!1,p({fieldState:"error",message:"Valid characters for instance name are letters from a to z and numbers from 0 to 9."})),void 0!==u.region&&""!==u.region.trim()||(e=!1,g({fieldState:"error",message:"This is a required field"})),!e)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,E.createKafka(!0,u).then((function(e){S("Kafka successfully created",s.AlertVariant.success),C()}))];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),S(t,s.AlertVariant.danger),[3,4];case 4:return[2]}}))}))},isDisabled:!A},"Create instance"),o().createElement(s.Button,{key:"cancel",variant:"link",onClick:C},"Cancel")]},o().createElement(s.Form,null,("error"===m.fieldState||"error"===v.fieldState)&&o().createElement(s.FormAlert,null,o().createElement(s.Alert,{variant:"danger",title:"You must fill out all required fields before you can proceed.","aria-live":"polite",isInline:!0})),o().createElement(s.FormGroup,{label:"Instance name",helperTextInvalid:m.message,helperTextInvalidIcon:o().createElement(l.ExclamationCircleIcon,null),isRequired:!0,validated:m.fieldState,fieldId:"form-instance-name"},o().createElement(s.TextInput,{isRequired:!0,validated:m.fieldState,type:"text",id:"form-instance-name",name:"instance-name",value:null==u?void 0:u.name,onChange:function(e){d((0,r.pi)((0,r.pi)({},u),{name:e||""})),p(void 0===e||""===e.trim()?{fieldState:"error",message:"This is a required field"}:/^[a-zA-Z0-9][a-zA-Z0-9 ]*$/.test(e.trim())?{fieldState:"success",message:""}:{fieldState:"error",message:"Valid characters for instance name are letters from a to z and numbers from 0 to 9."})}})),o().createElement(s.FormGroup,{label:"Cloud provider",fieldId:"form-cloud-provider-name"},y.bv.map((function(e){return o().createElement(s.Tile,{key:"tile-"+e.value,title:e.label,icon:K(e.value),isSelected:u.cloud_provider===e.value,onClick:function(){return d((0,r.pi)((0,r.pi)({},u),{cloud_provider:e.value}))}})}))),o().createElement(s.FormGroup,{label:"Cloud region",helperTextInvalid:v.message,helperTextInvalidIcon:o().createElement(l.ExclamationCircleIcon,null),validated:v.fieldState,fieldId:"form-cloud-region-option"},o().createElement(s.FormSelect,{validated:v.fieldState,value:u.region,onChange:function(e){g(void 0===e||""===e?{fieldState:"error",message:"This is a required field"}:{fieldState:"default",message:""}),d((0,r.pi)((0,r.pi)({},u),{region:e}))},id:"cloud-region-select",name:"cloud-region","aria-label":"Cloud region"},q.map((function(e,t){return o().createElement(s.FormSelectOption,{key:t,value:e.value,label:e.label})})))),o().createElement(s.FormGroup,{label:"Availabilty zones",fieldId:"availability-zones"},o().createElement(s.ToggleGroup,{"aria-label":"Availability zone selection"},o().createElement(s.ToggleGroupItem,{text:"Single",buttonId:"single",isDisabled:!0,isSelected:!1===u.multi_az}),o().createElement(s.ToggleGroupItem,{text:"Multi",buttonId:"multi",isSelected:!0===u.multi_az})))),o().createElement("br",null),o().createElement("br",null)))},K=function(e){var t=e.onConnectToInstance,n=(0,i.useContext)(b.V).token,a=(0,c.useTranslation)().t,l=(0,i.useState)(!1),d=l[0],f=l[1],m=(0,i.useState)(!1),p=m[0],h=m[1],v=(0,i.useState)({}),g=(v[0],v[1]),k=(0,i.useState)([]),E=k[0],y=k[1],S=(0,i.useState)(!1),w=S[0],P=S[1],q=new I({accessToken:n,basePath:T}),K=function(){return(0,r.mG)(void 0,void 0,void 0,(function(){var e;return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,q.listKafkas().then((function(e){var t=e.data;console.log("what is res"+JSON.stringify(t)),g(t),y(t.items)})).then((function(){return setTimeout(K,2e3)}))];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),console.log(e),[3,3];case 3:return[2]}}))}))};if((0,i.useEffect)((function(){""!==n&&(h(!1),K().then((function(){return h(!0)})))}),[n]),""===n)return o().createElement(s.Spinner,null);if(!p)return o().createElement(s.Spinner,null);return o().createElement(o().Fragment,null,o().createElement(s.PageSection,{variant:s.PageSectionVariants.light},o().createElement(s.Level,null,o().createElement(s.LevelItem,null,o().createElement(s.Title,{headingLevel:"h1",size:"lg"},a("OpenshiftStreams"))),o().createElement(s.LevelItem,null,o().createElement(s.Switch,{id:"simple-switch",label:a("Mock UI"),labelOff:a("Currently supported UI"),isChecked:w,onChange:function(){P(!w)}})))),o().createElement(s.PageSection,null,E.length>0?o().createElement(C,{kafkaInstanceItems:E,mainToggle:w,onConnectToInstance:t}):o().createElement(u,{createStreamsInstance:d,setCreateStreamsInstance:f,mainToggle:w}),d&&o().createElement(A,{createStreamsInstance:d,setCreateStreamsInstance:f,mainToggle:w})))}},42603:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var a=n(15691),r=n.n(a)().createContext({token:void 0})}}]);
//# sourceMappingURL=487.860c3fa734e04f7bf1b8.js.map