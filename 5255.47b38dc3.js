"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[5255],{73171:(e,t,a)=>{t.qw={name:"AwsIcon",height:512,width:640,svgPath:"M180.41 203.01c-.72 22.65 10.6 32.68 10.88 39.05a8.164 8.164 0 0 1-4.1 6.27l-12.8 8.96a10.66 10.66 0 0 1-5.63 1.92c-.43-.02-8.19 1.83-20.48-25.61a78.608 78.608 0 0 1-62.61 29.45c-16.28.89-60.4-9.24-58.13-56.21-1.59-38.28 34.06-62.06 70.93-60.05 7.1.02 21.6.37 46.99 6.27v-15.62c2.69-26.46-14.7-46.99-44.81-43.91-2.4.01-19.4-.5-45.84 10.11-7.36 3.38-8.3 2.82-10.75 2.82-7.41 0-4.36-21.48-2.94-24.2 5.21-6.4 35.86-18.35 65.94-18.18a76.857 76.857 0 0 1 55.69 17.28 70.285 70.285 0 0 1 17.67 52.36l-.01 69.29zM93.99 235.4c32.43-.47 46.16-19.97 49.29-30.47 2.46-10.05 2.05-16.41 2.05-27.4-9.67-2.32-23.59-4.85-39.56-4.87-15.15-1.14-42.82 5.63-41.74 32.26-1.24 16.79 11.12 31.4 29.96 30.48zm170.92 23.05c-7.86.72-11.52-4.86-12.68-10.37l-49.8-164.65c-.97-2.78-1.61-5.65-1.92-8.58a4.61 4.61 0 0 1 3.86-5.25c.24-.04-2.13 0 22.25 0 8.78-.88 11.64 6.03 12.55 10.37l35.72 140.83 33.16-140.83c.53-3.22 2.94-11.07 12.8-10.24h17.16c2.17-.18 11.11-.5 12.68 10.37l33.42 142.63L420.98 80.1c.48-2.18 2.72-11.37 12.68-10.37h19.72c.85-.13 6.15-.81 5.25 8.58-.43 1.85 3.41-10.66-52.75 169.9-1.15 5.51-4.82 11.09-12.68 10.37h-18.69c-10.94 1.15-12.51-9.66-12.68-10.75L328.67 110.7l-32.78 136.99c-.16 1.09-1.73 11.9-12.68 10.75h-18.3zm273.48 5.63c-5.88.01-33.92-.3-57.36-12.29a12.802 12.802 0 0 1-7.81-11.91v-10.75c0-8.45 6.2-6.9 8.83-5.89 10.04 4.06 16.48 7.14 28.81 9.6 36.65 7.53 52.77-2.3 56.72-4.48 13.15-7.81 14.19-25.68 5.25-34.95-10.48-8.79-15.48-9.12-53.13-21-4.64-1.29-43.7-13.61-43.79-52.36-.61-28.24 25.05-56.18 69.52-55.95 12.67-.01 46.43 4.13 55.57 15.62 1.35 2.09 2.02 4.55 1.92 7.04v10.11c0 4.44-1.62 6.66-4.87 6.66-7.71-.86-21.39-11.17-49.16-10.75-6.89-.36-39.89.91-38.41 24.97-.43 18.96 26.61 26.07 29.7 26.89 36.46 10.97 48.65 12.79 63.12 29.58 17.14 22.25 7.9 48.3 4.35 55.44-19.08 37.49-68.42 34.44-69.26 34.42zm40.2 104.86c-70.03 51.72-171.69 79.25-258.49 79.25A469.127 469.127 0 0 1 2.83 327.46c-6.53-5.89-.77-13.96 7.17-9.47a637.37 637.37 0 0 0 316.88 84.12 630.22 630.22 0 0 0 241.59-49.55c11.78-5 21.77 7.8 10.12 16.38zm29.19-33.29c-8.96-11.52-59.28-5.38-81.81-2.69-6.79.77-7.94-5.12-1.79-9.47 40.07-28.17 105.88-20.1 113.44-10.63 7.55 9.47-2.05 75.41-39.56 106.91-5.76 4.87-11.27 2.3-8.71-4.1 8.44-21.25 27.39-68.49 18.43-80.02z",yOffset:0,xOffset:0},t.er=a(35183).createIcon(t.qw),t.ZP=t.er},35255:(e,t,a)=>{a.r(t),a.d(t,{CreateInstance:()=>I,default:()=>h});var n=a(70655),i=a(75418),r=a.n(i),l=a(11593),o=a(84669),s=a(78261),u=a(92550),c=a(75381),m=a(55277),d=a(10069),v=function(e){var t=e.isKasTrial,a=(0,l.useTranslation)().t,n=r().useContext(d.QuickStartContext);return r().createElement(o.TextContent,null,r().createElement(o.Text,{component:o.TextVariants.h3},a("common.instance_information")),r().createElement(o.TextList,{component:o.TextListVariants.dl},r().createElement(o.Grid,{sm:6,lg:12,hasGutter:!0},t&&r().createElement(o.GridItem,null,r().createElement(o.TextListItem,{component:o.TextListItemVariants.dt},a("common.duration")),r().createElement(o.TextListItem,{component:o.TextListItemVariants.dd},a("common.duration_value"))),r().createElement(o.GridItem,null,r().createElement(o.TextListItem,{component:o.TextListItemVariants.dt},a("common.ingress_egress")),r().createElement(o.TextListItem,{component:o.TextListItemVariants.dd},a("common.ingress_egress_value"))),r().createElement(o.GridItem,null,r().createElement(o.TextListItem,{component:o.TextListItemVariants.dt},a("common.storage")),r().createElement(o.TextListItem,{component:o.TextListItemVariants.dd},a("common.storage_value"))),r().createElement(o.GridItem,null,r().createElement(o.TextListItem,{component:o.TextListItemVariants.dt},a("common.partitions")),r().createElement(o.TextListItem,{component:o.TextListItemVariants.dd},a("common.partitions_value"))),r().createElement(o.GridItem,null,r().createElement(o.TextListItem,{component:o.TextListItemVariants.dt},a("common.client_connections")),r().createElement(o.TextListItem,{component:o.TextListItemVariants.dd},a("common.client_connections_value"))),r().createElement(o.GridItem,null,r().createElement(o.TextListItem,{component:o.TextListItemVariants.dt},a("common.connection_rate")),r().createElement(o.TextListItem,{component:o.TextListItemVariants.dd},a("common.connection_rate_value"))),r().createElement(o.GridItem,null,r().createElement(o.TextListItem,{component:o.TextListItemVariants.dt},a("common.message_size")),r().createElement(o.TextListItem,{component:o.TextListItemVariants.dd},a("common.message_size_value")))),r().createElement(o.Button,{isSmall:!0,isInline:!0,variant:o.ButtonVariant.link,style:{marginTop:"20px"},onClick:function(){return n.setActiveQuickStart&&n.setActiveQuickStart("getting-started")}},a("common.quick_start_guide_message"))))},_=a(62308),f=function(e){var t=e.quota,a=e.hasKafkaCreationFailed,n=e.hasUserTrialKafka,i=(0,l.useTranslation)().t;if(void 0===t||t.loading)return r().createElement(o.Alert,{className:"pf-u-mb-md",variant:o.AlertVariant.info,title:i("instance_checking_message"),"aria-live":"polite",isInline:!0,customIcon:r().createElement(o.Spinner,{size:"md","aria-valuetext":"Checking kafka availability"})});var s=function(){var e,i,r=null===(e=t.data)||void 0===e?void 0:e.get(null===_.QuotaType||void 0===_.QuotaType?void 0:_.QuotaType.kas),l=null===(i=t.data)||void 0===i?void 0:i.get(null===_.QuotaType||void 0===_.QuotaType?void 0:_.QuotaType.kasTrial);return!r&&l&&n?{titleKey:"trial_kafka_title",variant:o.AlertVariant.warning,messageKey:"deploy_one_instance_alert_message"}:r||l?r||!l||n?r&&0===(null==r?void 0:r.remaining)?{variant:o.AlertVariant.warning,titleKey:"standard_kafka_alert_title",messageKey:"standard_kafka_alert_message"}:r&&(null==r?void 0:r.remaining)>0?void 0:a?{variant:o.AlertVariant.danger,titleKey:"kafka_creation_failed_alert_title",messageKey:r?"standard_kafka_creation_failed_alert_message":"trial_kafka_creation_failed_alert_message"}:(t.isServiceDown,{titleKey:"something_went_wrong",variant:o.AlertVariant.danger,messageKey:"ams_service_down_message"}):{variant:o.AlertVariant.info,titleKey:"trial_quota_kafka_title",messageKey:""}:{variant:o.AlertVariant.warning,titleKey:"no_quota_kafka_alert_title",messageKey:"no_quota_kafka_alert_message"}}();return void 0===s?r().createElement(r().Fragment,null):r().createElement(o.Alert,{className:"pf-u-mb-md",variant:s.variant,title:i(s.titleKey),"aria-live":"polite",isInline:!0},i(s.messageKey))},g=function(e){if(void 0===e.name.value)throw new Error("kafkaRequest.name must not be undefined");if(void 0===e.region.value)throw new Error("kafkaRequest.region must not be undefined");if(void 0===e.multi_az.value)throw new Error("kafkaRequest.multi_az must not be undefined");if(void 0===e.cloud_provider.value)throw new Error("kafkaRequest.cloud_provider must not be undefined");return{name:e.name.value,region:e.region.value,multi_az:e.multi_az.value,cloud_provider:e.cloud_provider.value}},p=function(e){return"error"===e.name.validated||"error"===e.region.validated||"error"===e.cloud_provider.validated||"error"===e.multi_az.validated},T=a(73171),k=function(e){var t=e.createInstance,a=e.kafkaRequest,s=e.setKafkaRequest,u=e.cloudProviders,m=e.getCloudRegions,d=e.id,v=(0,l.useTranslation)().t,_=(0,i.useState)(!1),f=_[0],g=_[1],k=(0,i.useState)(),E=k[0],I=k[1],h=function(e){return void 0===e.name.value||""===e.name.value.trim()?(e.name.validated="error",e.name.errorMessage=v("common.this_is_a_required_field")):/^[a-z]([-a-z0-9]*[a-z0-9])?$/.test(e.name.value.trim())?e.name.value.length>c.JB&&(e.name.validated="error",e.name.errorMessage=v("length_is_greater_than_expected",{maxLength:c.JB})):(e.name.validated="error",e.name.errorMessage=v("common.input_filed_invalid_helper_text")),e},x=function(e){return void 0!==e.region.value&&""!==e.region.value.trim()||(e.region.validated="error",e.region.errorMessage=v("common.this_is_a_required_field")),e},y=function(){g(!1),s({cloud_provider:{value:""},multi_az:{value:!0},region:{value:""},name:{value:""}})},b=function(e){s((function(t){return(0,n.__assign)((0,n.__assign)({},t),{cloud_provider:{value:e.name||""}})}))},w=function(e){s((function(t){var a=(0,n.__assign)((0,n.__assign)({},t),{region:{value:e||""}});return x(a)}))},L=function(e){s((function(t){return(0,n.__assign)((0,n.__assign)({},t),{multi_az:{value:e}})}))};(0,i.useEffect)((function(){(null==u?void 0:u.length)>0&&u[0].name&&b(u[0])}),[u]),(0,i.useEffect)((function(){L(!0)}),[]),(0,i.useEffect)((function(){var e;void 0!==a.cloud_provider.value&&(e=a.cloud_provider.value,(0,n.__awaiter)(void 0,void 0,void 0,(function(){var t;return(0,n.__generator)(this,(function(a){switch(a.label){case 0:return[4,m(e)];case 1:return void 0!==(t=a.sent())&&1===t.length&&void 0!==t[0].id&&w(t[0].id),I(t),[2]}}))})))}),[a.cloud_provider]);var C=function(e){if("aws"===(null==e?void 0:e.toLowerCase()))return r().createElement(T.ZP,{size:"lg",color:"black",className:"mk--create-instance__tile--icon"})};return r().createElement(o.Form,{onSubmit:function(e){e.preventDefault(),g(!0);var i=x(h(a));s((0,n.__assign)({},i)),p(i)||t().then((function(){return y()}))},id:d},r().createElement((function(){return f&&p(a)?r().createElement(o.FormAlert,null,r().createElement(o.Alert,{variant:"danger",title:v("common.form_invalid_alert"),"aria-live":"polite",isInline:!0})):r().createElement(r().Fragment,null)}),null),r().createElement(o.FormGroup,{label:v("instance_name"),helperText:v("create_instance_name_helper_text"),helperTextInvalid:a.name.errorMessage,isRequired:!0,validated:a.name.validated,fieldId:"form-instance-name"},r().createElement(o.TextInput,{isRequired:!0,validated:a.name.validated,type:"text",id:"form-instance-name",name:"instance-name",value:a.name.value,onChange:function(e){s((function(t){var a=(0,n.__assign)((0,n.__assign)({},t),{name:{value:e}});return h(a)}))},autoFocus:!0})),r().createElement(o.FormGroup,{label:v("cloud_provider"),fieldId:"form-cloud-provider-name"},null==u?void 0:u.map((function(e){return r().createElement(o.Tile,{key:"tile-"+e.name,title:e.display_name||"",icon:C(e.name),isSelected:a.cloud_provider.value===e.name,onClick:function(){return b(e)}})}))),r().createElement(o.FormGroup,{label:v("cloud_region"),helperTextInvalid:a.region.errorMessage,validated:a.region.validated,fieldId:"form-cloud-region-option",isRequired:!0},r().createElement(o.FormSelect,{validated:a.region.validated,value:a.region.value,onChange:w,id:"cloud-region-select",name:"cloud-region","aria-label":v("cloud_region"),isDisabled:void 0===E},[r().createElement(o.FormSelectOption,{value:"",key:"placeholder",label:v("please_select")}),(E||[]).map((function(e,t){var a=e.id,n=e.display_name,i=void 0===n?"":n;return r().createElement(o.FormSelectOption,{key:t,value:a,label:a?v(a):i})}))])),r().createElement(o.FormGroup,{label:v("availabilty_zones"),fieldId:"availability-zones"},r().createElement(o.ToggleGroup,{"aria-label":v("availability_zone_selection")},r().createElement(o.Tooltip,{content:v("kafkaInstance.availabilty_zones_tooltip_message")},r().createElement(o.ToggleGroupItem,{text:v("single"),value:"single",isDisabled:!0,buttonId:"single",onChange:L})),r().createElement(o.ToggleGroupItem,{text:v("multi"),value:"multi",buttonId:"multi",isSelected:a.multi_az.value||!1,onChange:L}),r().createElement(o.Tooltip,{content:v("kafkaInstance.availabilty_zones_tooltip_message"),reference:function(){return document.getElementById("multi")||document.createElement("span")}}))))},E="create_instance_-form",I=function(){var e,t,a=(0,l.useTranslation)().t,d=(0,u.QK)(),T=d.store,I=d.hideModal,h=(null==T?void 0:T.modalProps)||{},x=h.onCreate,y=h.refresh,b=h.cloudProviders,w=h.hasUserTrialKafka,L=(0,_.useAuth)(),C=(((0,_.useConfig)()||{}).kas||{}).apiBasePath,K=((0,_.useAlert)()||{}).addAlert,A=((0,_.useQuota)()||{}).getQuota,V=(0,i.useState)({cloud_provider:{value:""},multi_az:{value:!0},region:{value:""},name:{value:""}}),S=V[0],z=V[1],F=(0,i.useState)(!1),q=F[0],Q=F[1],G=(0,i.useState)(),M=G[0],R=G[1],P=(0,i.useState)(!1),N=P[0],D=P[1],B=null===(e=null==M?void 0:M.data)||void 0===e?void 0:e.get(null===_.QuotaType||void 0===_.QuotaType?void 0:_.QuotaType.kas),O=null===(t=null==M?void 0:M.data)||void 0===t?void 0:t.get(null===_.QuotaType||void 0===_.QuotaType?void 0:_.QuotaType.kasTrial),U=void 0===(null==M?void 0:M.loading)||(null==M?void 0:M.loading),J=O&&!B;(0,i.useEffect)((function(){(0,n.__awaiter)(void 0,void 0,void 0,(function(){return(0,n.__generator)(this,(function(e){switch(e.label){case 0:return A?[4,A().then((function(e){R(e)}))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}),[]);return r().createElement(u.a$,{isModalOpen:!0,title:a("create_a_kafka_instance"),handleModalToggle:function(){I()},isFormValid:!p(S),primaryButtonTitle:a("create_instance"),isCreationInProgress:q,dataTestIdSubmit:"modalCreateKafka-buttonSubmit",dataTestIdCancel:"modalCreateKafka-buttonCancel",formId:E,isDisabledButton:U||w||N||B&&0===(null==B?void 0:B.remaining)||!B&&!O},r().createElement(r().Fragment,null,r().createElement(f,{quota:M,hasKafkaCreationFailed:N,loadingQuota:U,hasUserTrialKafka:w,isKasTrial:J}),r().createElement(o.Flex,{direction:{default:"column",lg:"row"}},r().createElement(o.FlexItem,{flex:{default:"flex_2"}},r().createElement(k,{kafkaRequest:S,setKafkaRequest:z,createInstance:function(){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var e,t,i,r,l,u,d;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==L?void 0:L.kas.getToken()];case 1:if(!(e=n.sent()))return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),t=new m.DefaultApi(new m.Configuration({accessToken:e,basePath:C})),Q(!0),x(),[4,t.createKafka(!0,g(S))];case 3:return n.sent(),I(),y(),[3,5];case 4:return i=n.sent(),(0,s.G)(i)&&(r=(null===(d=null==i?void 0:i.response)||void 0===d?void 0:d.data)||{},l=r.code,u=r.reason,l===c.SM.DUPLICATE_INSTANCE_NAME?(S.name.validated="error",S.name.errorMessage=a("the_name_already_exists_please_enter_a_unique_name",{name:S.name.value})):l===c.SM.PREVIEW_KAFKA_INSTANCE_EXIST||l===c.SM.INSUFFICIENT_QUOTA||l===c.SM.FAILED_TO_CHECK_QUOTA?D(!0):K&&K({title:a("common.something_went_wrong"),variant:o.AlertVariant.danger,description:u,dataTestId:"toastCreateKafka-failed"})),Q(!1),[3,5];case 5:return[2]}}))}))},cloudProviders:b,getCloudRegions:function(e){return(0,n.__awaiter)(void 0,void 0,void 0,(function(){var t,i,r,l,u,c;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==L?void 0:L.kas.getToken()];case 1:if(!(t=n.sent())||!e)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new m.DefaultApi(new m.Configuration({accessToken:t,basePath:C})).getCloudProviderRegions(e)];case 3:return i=n.sent(),[2,null===(u=i.data.items)||void 0===u?void 0:u.filter((function(e){return e.enabled}))];case 4:return r=n.sent(),l=void 0,(0,s.G)(r)&&(l=null===(c=r.response)||void 0===c?void 0:c.data.reason),K&&K({title:a("common.something_went_wrong"),variant:o.AlertVariant.danger,description:l}),[3,5];case 5:return[2,void 0]}}))}))},id:E})),r().createElement(o.Divider,{isVertical:!0}),r().createElement(o.FlexItem,{flex:{default:"flex_1"},className:"mk--create-instance-modal__sidebar--content"},r().createElement(v,{isKasTrial:J})))))};const h=I}}]);
//# sourceMappingURL=5255.47b38dc3.js.map