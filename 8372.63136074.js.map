{"version":3,"file":"8372.63136074.js","mappings":"+PAYMA,EAAgD,WAC5C,IAAAC,GAAM,IAAAC,kBAAgB,EACxBC,GAAO,IAAAC,WAESC,GAClB,IAAAC,aAAW,gBACPC,GAAa,IAAAC,YAAU,SACzB,GAAuB,UAArBC,EAAK,QAAEC,EAAS,YAClB,GACJD,MAAAA,OAAK,EAALA,EAAOE,aAAc,GADfC,EAAoB,uBAAEC,EAAsB,yBAG9C,GAA4B,IAAAC,WAAkB,GAA7CC,EAAS,KAAEC,EAAY,KAExBC,EAAoB,WACxBP,KAmDF,OACE,kBAAC,KAAc,CACbQ,aAAa,EACbD,kBAAmBA,EACnBE,MAAOlB,EAAE,yCAA2C,IACpDmB,mBAAoB,CAClBC,QAAS,WAAM,OArDnBC,EAqDwCT,GArDU,gD,iFAGlD,QAAyBU,KADnBC,EAAmBF,MAAAA,OAAc,EAAdA,EAAgBG,IAEvC,MAAM,IAAIC,MAAM,kCAEE,SAAMvB,MAAAA,OAAI,EAAJA,EAAMwB,IAAIC,Y,YAA9BC,EAAc,UAChB,YACIC,EAAc,IAAI,EAAAC,YACtB,IAAI,EAAAC,cAAc,CAChBH,YAAW,EACXxB,SAAQ,KAGZW,GAAa,G,iBAGX,O,sBAAA,GAAMc,EACHG,yBAAyBT,GACzBU,MAAK,WACJjB,IACAD,GAAa,GACbT,EAAS,CACPY,MAAOlB,EAAE,sDAAuD,CAC9DkC,KAAMb,MAAAA,OAAc,EAAdA,EAAgBa,OAExBC,QAAS,EAAAC,aAAA,UAEXzB,Q,cAXJ,S,+BAcI0B,OAAM,GACN,QAAkB,KACpBA,EAAuB,QAAd,IAAMC,gBAAQ,eAAEC,KAAKF,QAGhCrB,IACAD,GAAa,GACbT,EAAS,CACPY,MAAOlB,EAAE,+BACTmC,QAAS,EAAAC,aAAA,OACTI,YAAaH,I,8BA1CQ,IAC3BhB,GAsDIoB,MAAO,SACP3B,UAAS,IAGX,2BACE,2BAAIF,MAAAA,OAAsB,EAAtBA,EAAwBsB,MAAU,IACrClC,EAAE,qCAOX","sources":["webpack://kas-ui/./src/app/modules/ServiceAccounts/dialogs/DeleteServiceAccount/DeleteServiceAccount.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { AlertVariant } from '@patternfly/react-core';\nimport { MASDeleteModal, useRootModalContext } from '@app/common';\nimport { isServiceApiError } from '@app/utils';\nimport {\n  Configuration,\n  SecurityApi,\n  ServiceAccountListItem,\n} from '@rhoas/kafka-management-sdk';\nimport { useAlert, useAuth, useConfig } from '@rhoas/app-services-ui-shared';\n\nconst DeleteServiceAccount: React.FunctionComponent = () => {\n  const { t } = useTranslation();\n  const auth = useAuth();\n  const {\n    kas: { apiBasePath: basePath },\n  } = useConfig();\n  const { addAlert } = useAlert();\n  const { store, hideModal } = useRootModalContext();\n  const { fetchServiceAccounts, serviceAccountToDelete } =\n    store?.modalProps || {};\n\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n\n  const handleModalToggle = () => {\n    hideModal();\n  };\n\n  const deleteServiceAccount = async (\n    serviceAccount: ServiceAccountListItem | undefined\n  ) => {\n    const serviceAccountId = serviceAccount?.id;\n    if (serviceAccountId === undefined) {\n      throw new Error('service account id not defined');\n    }\n    const accessToken = await auth?.kas.getToken();\n    if (accessToken) {\n      const apisService = new SecurityApi(\n        new Configuration({\n          accessToken,\n          basePath,\n        })\n      );\n      setIsLoading(true);\n\n      try {\n        await apisService\n          .deleteServiceAccountById(serviceAccountId)\n          .then(() => {\n            handleModalToggle();\n            setIsLoading(false);\n            addAlert({\n              title: t('serviceAccount.service_account_successfully_deleted', {\n                name: serviceAccount?.name,\n              }),\n              variant: AlertVariant.success,\n            });\n            fetchServiceAccounts();\n          });\n      } catch (error) {\n        let reason: string | undefined;\n        if (isServiceApiError(error)) {\n          reason = error.response?.data.reason;\n        }\n\n        handleModalToggle();\n        setIsLoading(false);\n        addAlert({\n          title: t('common.something_went_wrong'),\n          variant: AlertVariant.danger,\n          description: reason,\n        });\n      }\n    }\n  };\n\n  return (\n    <MASDeleteModal\n      isModalOpen={true}\n      handleModalToggle={handleModalToggle}\n      title={t('serviceAccount.delete_service_account') + '?'}\n      confirmButtonProps={{\n        onClick: () => deleteServiceAccount(serviceAccountToDelete),\n        label: 'Delete',\n        isLoading,\n      }}\n    >\n      <p>\n        <b>{serviceAccountToDelete?.name}</b>{' '}\n        {t('serviceAccount.will_be_deleted')}\n      </p>\n    </MASDeleteModal>\n  );\n};\n\nexport { DeleteServiceAccount };\nexport default DeleteServiceAccount;\n"],"names":["DeleteServiceAccount","t","useTranslation","auth","useAuth","basePath","useConfig","addAlert","useAlert","store","hideModal","modalProps","fetchServiceAccounts","serviceAccountToDelete","useState","isLoading","setIsLoading","handleModalToggle","isModalOpen","title","confirmButtonProps","onClick","serviceAccount","undefined","serviceAccountId","id","Error","kas","getToken","accessToken","apisService","SecurityApi","Configuration","deleteServiceAccountById","then","name","variant","AlertVariant","reason","response","data","description","label"],"sourceRoot":""}