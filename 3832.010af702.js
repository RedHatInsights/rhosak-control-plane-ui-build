"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[3832],{53832:(e,t,n)=>{n.d(t,{C:()=>pe});var a=n(84669),i=n(55795),r=n(75418),c=n.n(r),o=function(e){var t=e.title,n=e.description;return c().createElement(a.Popover,{"aria-label":"Basic popover",headerContent:c().createElement("div",null,t),bodyContent:c().createElement("div",null,n)},c().createElement(i.ZP,null))},l=n(28962),s=function(){return c().createElement(a.EmptyState,{variant:a.EmptyStateVariant.xs},c().createElement(a.EmptyStateBody,null,c().createElement(l.yR,null)))},u=n(70251),m=n(75205),d=function(){var e=(0,m.useTranslation)().t;return c().createElement(a.EmptyState,{variant:a.EmptyStateVariant.xs},c().createElement(a.EmptyStateIcon,{icon:u.TachometerAltIcon}),c().createElement(a.Title,{headingLevel:"h3",size:"lg"},e("metrics.empty_state_no_data_title")),c().createElement(a.EmptyStateBody,null,e("metrics.empty_state_no_data_body")))},f=function(){var e=(0,m.useTranslation)().t;return c().createElement(a.EmptyState,{variant:a.EmptyStateVariant.xs},c().createElement(a.EmptyStateIcon,{icon:u.SearchIcon}),c().createElement(a.Title,{headingLevel:"h3",size:"lg"},e("metrics.empty_state_no_topic_data_title")),c().createElement(a.EmptyStateBody,null,e("metrics.empty_state_no_topic_data_body")))},h=function(e){var t=e.onCreateTopic,n=(0,m.useTranslation)().t;return c().createElement(a.EmptyState,{variant:a.EmptyStateVariant.xs},c().createElement(a.EmptyStateIcon,{icon:u.WrenchIcon}),c().createElement(a.Title,{headingLevel:"h3",size:"lg"},n("metrics.empty_state_no_topics_title")),c().createElement(a.EmptyStateBody,null,n("metrics.empty_state_no_topics_body")),c().createElement(a.Button,{variant:"primary",onClick:t},n("metrics.empty_state_no_topics_create_topic")))},p=function(){var e=(0,m.useTranslation)().t;return c().createElement(a.EmptyState,{variant:a.EmptyStateVariant.xs},c().createElement(a.EmptyStateIcon,{icon:u.FilterIcon}),c().createElement(a.Title,{headingLevel:"h3",size:"lg"},e("metrics.empty_state_no_filter_title")),c().createElement(a.EmptyStateBody,null,e("metrics.empty_state_no_filter_body")))},g={5:"Last 5 minutes",15:"Last 15 minutes",30:"Last 30 minutes",60:"Last 1 hour",180:"Last 3 hours",360:"Last 6 hours",720:"Last 12 hours",1400:"Last 24 hours",2800:"Last 2 days",100080:"Last 7 days"},E=function(e){var t=e.timeDuration,n=e.keyText,i=e.disableToolbar,o=e.onDurationChange,l=(0,r.useState)(!1),s=l[0],u=l[1];return c().createElement(a.ToolbarItem,null,c().createElement(a.Select,{variant:a.SelectVariant.single,"aria-label":"Select Input",onToggle:function(e){u(e)},onSelect:function(e,t){var n=Object.entries(g).find((function(e){e[0];return e[1]===t}));n&&o(parseInt(n[0],10)),u(!1)},selections:g[t],isOpen:s,isDisabled:i,placeholderText:"Last 6 hours"},function(e){return[c().createElement(a.SelectGroup,{label:"Relative time ranges",key:"".concat(e,"-group")},Object.values(g).map((function(t,n){return c().createElement(a.SelectOption,{key:"".concat(e,"-").concat(n),value:t})})))]}(n)))},v=n(8755),T={default:"100px",sm:"80px",md:"150px",lg:"200px",xl:"250px","2xl":"300px"},y=function(e){var t=e.selectedTopic,n=e.topicList,i=void 0===n?[]:n,o=e.disableToolbar,l=e.onSetSelectedTopic,s=(0,m.useTranslation)().t,u=(0,r.useState)(!1),d=u[0],f=u[1],h=s("All topics"),p=function(e){return[c().createElement(a.SelectOption,{key:"topic-filter-0",value:h}),c().createElement(a.SelectGroup,{label:"Filter by topic",key:"topic-filter-group"},e.map((function(e,t){return c().createElement(a.SelectOption,{key:"topic-filter-".concat(t+1),value:e})})))]},g=o||0===i.length;return c().createElement(a.ToolbarItem,{widths:T},c().createElement(a.Select,{variant:a.SelectVariant.single,onToggle:function(e){f(e)},onSelect:function(e,t){l("All topics"!==t?t:void 0)},selections:t||h,isOpen:d,placeholderText:c().createElement(c().Fragment,null,c().createElement(v.ZP,null)," All topics"),"aria-label":s("Select a topic"),onFilter:function(e,t){var n=i.filter((function(e){return-1!=e.indexOf(t)}))||[];return p(n)},isGrouped:!0,hasInlineFilter:!0,isDisabled:g,style:{width:"100%"}},p(i)))},D=n(84103),b=n.n(D),C=function(e,t){var n="B";return e=e&&(e.sortedData?e.sortedData:e.data),t=t&&(t.sortedData?t.sortedData:t.data),e&&e.map((function(e){e.bytes.forEach((function(e){var t=b()(e).unit;"kiB"===t&&"B"===n&&(n="kiB"),"MiB"===t&&("B"!==n&&"kiB"!==n||(n="MiB")),"GiB"===t&&("B"!==n&&"kiB"!==n&&"MiB"!==n||(n="GiB"))}))})),t&&t.map((function(e){e.bytes.forEach((function(e){var t=b()(e).unit;"kiB"===t&&"B"===n&&(n="kiB"),"MiB"===t&&("B"!==n&&"kiB"!==n||(n="MiB")),"GiB"===t&&("B"!==n&&"kiB"!==n&&"MiB"!==n||(n="GiB"))}))})),n},k=function(e,t){return"B"===t?Math.round(10*e)/10:"kiB"===t?Math.round(e/1024*10)/10:"MiB"===t?Math.round(e/1024/1024*10)/10:"GiB"===t?Math.round(e/1024/1024/1024*10)/10:e},S=function(e){return e>=24},_=function(e,t){var n=t.showDate,a=e.toISOString().split("T"),i=a[0],r=a[1];return n?r.slice(0,5)+"\n"+i:r.slice(0,5)},B={5:60,15:180,30:300,60:600,180:1800,360:3600,720:7200,1400:14400,2800:28800,100080:86400},F=n(34391),w=n(84076),x=[n(72021).ZP.value,w.ZP.value],L=function(e){var t=e.partitions,n=e.timeDuration,a=(0,m.useTranslation)().t,i=(0,r.useRef)(null),o=(0,r.useState)(),l=o[0],s=o[1],u=function(){return i.current&&s(i.current.clientWidth)},d=l&&l>650?6:3;(0,r.useEffect)((function(){u(),window.addEventListener("resize",u)}),[l]);var f=function(e,t){var n=[],a=[],i=C(e,void 0);return Object.entries(e).map((function(e,r){var c=e[0],o=e[1],l=Object.keys(o).map((function(e){return parseInt(e,10)})),s=x[r];n.push({name:c});var u=[],m=function(){return(l[l.length-1]-l[0])/1e3/60},d=360-m(),f=(360-m())/5;if(d<=360&&t>=6)for(var h=0;h<f;h+=1){var p=l[0]-3e5*(f-h),g=new Date(p),E=_(g,{showDate:S(t)});u.push({name:c,x:E,y:0})}Object.entries(o).map((function(e){var n=e[0],a=e[1],r=new Date(parseInt(n,10)),o=_(r,{showDate:S(t)}),l=k(a,i);u.push({name:c,x:o,y:l})})),a.push({color:s,area:u})})),{legendData:n,chartData:a,largestByteSize:i}}(t,n),h=f.chartData,p=f.largestByteSize,g=f.legendData;return c().createElement("div",{ref:i},c().createElement(F.Chart,{ariaTitle:a("metrics.log_size_per_partition"),containerComponent:c().createElement(F.ChartVoronoiContainer,{labels:function(e){var t=e.datum;return"".concat(t.name,": ").concat(t.y)},constrainToVisibleArea:!0}),legendPosition:"bottom-left",legendComponent:c().createElement(F.ChartLegend,{data:g,itemsPerRow:d}),height:350,padding:{bottom:110,left:90,right:30,top:25},themeColor:F.ChartThemeColor.multiUnordered,width:l,legendAllowWrap:!0},c().createElement(F.ChartAxis,{label:"\nTime",tickCount:6}),c().createElement(F.ChartAxis,{dependentAxis:!0,tickFormat:function(e){return"".concat(Math.round(e)," ").concat(p)}}),c().createElement(F.ChartGroup,null,h.map((function(e,t){return c().createElement(F.ChartArea,{key:"chart-area-".concat(t),data:e.area,interpolation:"monotoneX"})})))))};var I=function(e){var t=e.diskSpaceMetrics,n=e.topicMetrics;return c().createElement(a.PageSection,null,c().createElement(a.Grid,{hasGutter:!0},c().createElement(a.GridItem,{lg:6},t),c().createElement(a.GridItem,{lg:6},n)))},R=n(66095),M=function(e){var t=e.title,n=e.selectedTopic,i=e.topicList,r=e.timeDuration,o=e.isDisabled,l=e.isRefreshing,s=e.onSetTimeDuration,u=e.onRefresh,m=e.onSetSelectedTopic;return c().createElement(c().Fragment,null,c().createElement(a.CardHeader,null,c().createElement(a.CardTitle,{component:"h2"},t),c().createElement(a.CardActions,null,c().createElement(a.Toolbar,null,c().createElement(a.ToolbarContent,null,c().createElement(y,{selectedTopic:n,onSetSelectedTopic:m,topicList:i,disableToolbar:o}),c().createElement(E,{timeDuration:r,onDurationChange:s,disableToolbar:o,keyText:"topic-metrics-time-filter"}),c().createElement(a.ToolbarItem,null,c().createElement(a.Button,{isLoading:l,variant:"plain","aria-label":"sync",onClick:u},!l&&c().createElement(R.ZP,null))))))),c().createElement(a.Divider,null))},P=function(){return c().createElement(a.CardBody,null,c().createElement(a.Bullseye,null,c().createElement(a.Spinner,{isSVG:!0})))},A=function(e){var t=e.topics,n=e.incomingTopicsData,i=e.outgoingTopicsData,r=e.selectedTopic,o=e.timeDuration,l=e.partitions,s=e.backendUnavailable,u=e.metricsDataUnavailable,g=e.isLoading,E=e.isRefreshing,v=e.onCreateTopic,T=e.onRefresh,y=e.onSelectedTopic,D=e.onTimeDuration,b=(0,m.useTranslation)().t,C=0===t.length;return c().createElement(a.Card,null,c().createElement(M,{title:b("metrics.topic_metrics"),timeDuration:o,onSetTimeDuration:D,isDisabled:s||C,isRefreshing:E,selectedTopic:r,onSetSelectedTopic:y,onRefresh:T,topicList:t}),function(){switch(!0){case g&&void 0===r:return c().createElement(a.CardBody,null,c().createElement(a.Bullseye,null,c().createElement(a.Spinner,{isSVG:!0})));case g:return c().createElement(c().Fragment,null,c().createElement(O,null),c().createElement(P,null),c().createElement(a.Divider,null),c().createElement(G,null),c().createElement(P,null));case s:return c().createElement(a.CardBody,null,c().createElement(d,null));case u:return c().createElement(a.CardBody,null,c().createElement(f,null));case C:return c().createElement(a.CardBody,null,c().createElement(h,{onCreateTopic:v}));case void 0!==r:return c().createElement(c().Fragment,null,c().createElement(O,null),c().createElement(a.CardBody,null,c().createElement(z,{incomingTopicsData:n,outgoingTopicsData:i,selectedTopic:r,timeDuration:o})),c().createElement(a.Divider,null),c().createElement(G,null),c().createElement(a.CardBody,null,c().createElement(L,{partitions:l,timeDuration:o})));default:return c().createElement(c().Fragment,null,c().createElement(O,null),c().createElement(a.CardBody,null,c().createElement(z,{incomingTopicsData:n,outgoingTopicsData:i,selectedTopic:r,timeDuration:o})),c().createElement(a.Divider,null),c().createElement(G,null),c().createElement(a.CardBody,null,c().createElement(p,null)))}}())},O=function(){var e=(0,m.useTranslation)().t;return c().createElement(a.CardTitle,{component:"h3"},e("metrics.total_bytes")," ",c().createElement(o,{title:e("metrics.total_bytes"),description:e("metrics.topic_metrics_help_text")}))},G=function(){var e=(0,m.useTranslation)().t;return c().createElement(a.CardTitle,{component:"h3"},e("metrics.topic_partition_size"))},U=n(82874),z=function(e){var t=e.incomingTopicsData,n=e.outgoingTopicsData,a=e.selectedTopic,i=e.timeDuration,o=(0,m.useTranslation)().t,l=(0,r.useRef)(null),s=(0,r.useState)(),u=s[0],d=s[1],f=function(){return l.current&&d(l.current.clientWidth)},h=u&&u>650?6:3;(0,r.useEffect)((function(){f(),window.addEventListener("resize",f)}),[u]);var p=function(e,t,n,a,i){var r=[],c=[],o=C(e,t),l=V(e,n,a,o);if(l){var s=w.ZP.value;c.push({color:s,line:l}),r.push({name:a,symbol:{fill:s}})}var u=V(t,n,i,o);if(u){s=U.ZP.value;c.push({color:s,line:u}),r.push({name:i,symbol:{fill:s}})}return{legendData:r,chartData:c,largestByteSize:o}}(t,n,i,o("{{topic}} incoming bytes",{topic:a||o("Total")}),o("{{topic}} outgoing bytes",{topic:a||o("Total")})),g=p.chartData,E=p.legendData,v=p.largestByteSize;return c().createElement("div",{ref:l},c().createElement(F.Chart,{ariaTitle:o("metrics.total_bytes"),containerComponent:c().createElement(F.ChartVoronoiContainer,{labels:function(e){var t=e.datum;return"".concat(t.name,": ").concat(t.y)},constrainToVisibleArea:!0}),legendAllowWrap:!0,legendPosition:"bottom-left",legendComponent:c().createElement(F.ChartLegend,{data:E,itemsPerRow:h}),height:300,padding:{bottom:110,left:90,right:30,top:25},themeColor:F.ChartThemeColor.multiUnordered,width:u},c().createElement(F.ChartAxis,{label:"\nTime",tickCount:6}),c().createElement(F.ChartAxis,{dependentAxis:!0,tickFormat:function(e){return"".concat(Math.round(e)," ").concat(v)},tickCount:4,minDomain:{y:0}}),c().createElement(F.ChartGroup,null,g.map((function(e,t){return c().createElement(F.ChartLine,{key:"chart-line-".concat(t),data:e.line,style:{data:{stroke:e.color}}})})))))};function V(e,t,n,a){var i=Object.keys(e).map((function(e){return parseInt(e,10)}));if(i.length>0){var r=[],c=(i[i.length-1]-i[0])/1e3/60,o=(360-c)/5;if(360-c<=360&&t>=6)for(var l=0;l<o;l+=1){var s=i[0]-3e5*(o-l),u=new Date(s),m=_(u,{showDate:S(t)});r.push({name:n,x:m,y:0})}return Object.entries(e).map((function(e){var i=e[0],c=e[1],o=new Date(parseInt(i,10)),l=_(o,{showDate:S(t)}),s=k(c,a);r.push({name:n,x:l,y:s})})),r}}var j=n(9914),Z=function(e){var t=e.metrics,n=e.timeDuration,a=(0,r.useRef)(null),i=(0,m.useTranslation)().t,o=(0,r.useState)(),l=o[0],s=o[1],u=function(){return a.current&&s(a.current.clientWidth)},d=l&&l>650?6:3;(0,r.useEffect)((function(){u(),window.addEventListener("resize",u)}),[l]);var f=W(t,n,1e3,i("Used disk space"),i("Limit")),h=f.chartData,p=f.legendData,g=f.largestByteSize;return c().createElement("div",{ref:a},c().createElement(F.Chart,{ariaTitle:i("metrics.used_disk_space"),containerComponent:c().createElement(F.ChartVoronoiContainer,{labels:function(e){var t=e.datum;return"".concat(t.name,": ").concat(t.y)},constrainToVisibleArea:!0}),legendPosition:"bottom-left",legendComponent:c().createElement(F.ChartLegend,{orientation:"horizontal",data:p,itemsPerRow:d}),height:350,padding:{bottom:110,left:90,right:60,top:25},themeColor:F.ChartThemeColor.multiUnordered,width:l,minDomain:{y:0},legendAllowWrap:!0},c().createElement(F.ChartAxis,{label:"\nTime",tickCount:6}),c().createElement(F.ChartAxis,{dependentAxis:!0,tickFormat:function(e){return"".concat(Math.round(e)," ").concat(g)},tickCount:4}),c().createElement(F.ChartGroup,null,h.map((function(e,t){return c().createElement(F.ChartArea,{key:"chart-area-".concat(t),data:e.area,interpolation:"monotoneX",style:{data:{}}})}))),c().createElement(F.ChartThreshold,{key:"chart-softlimit",data:h[0].softLimit,style:{data:{stroke:h[0].softLimitColor}}})))},W=function(e,t,n,a,i){var r=[{name:i,symbol:{fill:j.ZP.value,type:"threshold"}},{name:a,symbol:{fill:w.ZP.value}}],c=w.ZP.value,o=j.ZP.value,l=[],s=[],u=[],m=Object.keys(e).map((function(e){return parseInt(e,10)})),d=(m[m.length-1]-m[0])/1e3/60,f=(360-d)/5;if(360-d<=360&&t>=6)for(var h=0;h<f;h+=1){var p=m[0]-3e5*(f-h),g=new Date(p),E=_(g,{showDate:S(t)});s.push({name:a,x:E,y:0}),u.push({name:i,x:E,y:n})}return Object.entries(e).map((function(e){var r=e[0],c=e[1],o=new Date(parseInt(r)),l=_(o,{showDate:S(t)}),m=k(c,"GiB");s.push({name:a,x:l,y:m}),u.push({name:i,x:l,y:n})})),l.push({areaColor:c,softLimitColor:o,area:s,softLimit:u}),{legendData:r,chartData:l,largestByteSize:"GiB"}},X=function(e){var t=e.title,n=e.isDisabled,i=e.isRefreshing,r=e.timeDuration,o=e.onSetTimeDuration,l=e.onRefresh;return c().createElement(c().Fragment,null,c().createElement(a.CardHeader,null,c().createElement(a.CardTitle,{component:"h2"},t),c().createElement(a.CardActions,null,c().createElement(a.Toolbar,null,c().createElement(a.ToolbarContent,null,c().createElement(E,{timeDuration:r,onDurationChange:o,keyText:"kafka-metrics-time-filter",disableToolbar:n}),c().createElement(a.ToolbarItem,null,c().createElement(a.Button,{isLoading:i,variant:"plain","aria-label":"sync",onClick:l},!i&&c().createElement(R.ZP,null))))))),c().createElement(a.Divider,null))},H=function(e){var t=e.metrics,n=e.timeDuration,i=e.metricsDataUnavailable,r=e.isLoading,o=e.isRefreshing,l=e.onRefresh,s=e.onTimeDuration,u=(0,m.useTranslation)().t;return c().createElement(a.Card,null,c().createElement(X,{title:u("metrics.kafka_instance_metrics"),timeDuration:n,onSetTimeDuration:s,isDisabled:i,isRefreshing:o,onRefresh:l}),function(){switch(!0){case r:return c().createElement(c().Fragment,null,c().createElement(q,null),c().createElement(P,null));case i:return c().createElement(a.CardBody,null,c().createElement(d,null));default:return c().createElement(c().Fragment,null,c().createElement(q,null),c().createElement(a.CardBody,null,c().createElement(Z,{metrics:t,timeDuration:n})))}}())},q=function(){var e=(0,m.useTranslation)().t;return c().createElement(a.CardTitle,{component:"h3"},e("metrics.used_disk_space")," ",c().createElement(o,{title:e("metrics.used_disk_space"),description:e("metrics.used_disk_space_help_text")}))},J=n(46332),K=n(51782),N=n(70655),Q=n(66310),Y=(0,Q.createModel)({timeDuration:60,metrics:{},fetchFailures:0},{events:{fetch:function(){return{}},fetchSuccess:function(e){return(0,N.__assign)({},e)},fetchFail:function(){return{}},refresh:function(){return{}},selectTopic:function(e){return{selectedTopic:e}},selectDuration:function(e){return{timeDuration:e}}}}),$=Y.assign((function(e,t){return{metrics:t.metrics}}),"fetchSuccess"),ee=Y.assign({fetchFailures:function(e){return e.fetchFailures+1}},"fetchFail"),te=Y.assign({fetchFailures:function(){return 0}},"refresh"),ne=Y.assign({timeDuration:function(e,t){return t.timeDuration}},"selectDuration"),ae=Y.createMachine({id:"diskSpace",context:Y.initialContext,initial:"callApi",states:{callApi:{tags:"loading",initial:"loading",states:{loading:{invoke:{src:"api"},on:{fetchSuccess:{actions:$,target:"#diskSpace.verifyData"},fetchFail:{actions:ee,target:"failure"}}},failure:{after:{1e3:[{cond:"canRetryFetching",target:"loading"},{target:"#diskSpace.criticalFail"}]}}}},criticalFail:{tags:"failed",on:{refresh:{actions:te,target:"callApi"}}},verifyData:{always:[{cond:"hasMetrics",target:"withMetrics"},{target:"noData"}]},noData:{tags:"no-data",on:{refresh:{actions:te,target:"callApi"},selectDuration:{actions:ne,target:"refreshing"}}},withMetrics:{on:{refresh:{target:"refreshing"},selectDuration:{actions:ne,target:"refreshing"}}},refreshing:{tags:"refreshing",invoke:{src:"api"},on:{fetchSuccess:{actions:$,target:"verifyData"},fetchFail:{target:"verifyData"}}}}},{guards:{canRetryFetching:function(e){return e.fetchFailures<3},hasMetrics:function(e){return Object.keys(e.metrics).length>0}}}),ie=(0,Q.createModel)({selectedTopic:void 0,timeDuration:60,kafkaTopics:[],metricsTopics:[],bytesOutgoing:{},bytesIncoming:{},bytesPerPartition:{},fetchFailures:0},{events:{fetch:function(){return{}},fetchSuccess:function(e){return(0,N.__assign)({},e)},fetchFail:function(){return{}},refresh:function(){return{}},selectTopic:function(e){return{selectedTopic:e}},selectDuration:function(e){return{timeDuration:e}}}}),re=ie.assign((function(e,t){return{kafkaTopics:t.kafkaTopics,metricsTopics:t.metricsTopics,bytesPerPartition:t.bytesPerPartition,bytesIncoming:t.bytesIncoming,bytesOutgoing:t.bytesOutgoing}}),"fetchSuccess"),ce=ie.assign({fetchFailures:function(e){return e.fetchFailures+1}},"fetchFail"),oe=ie.assign({fetchFailures:function(){return 0}},"refresh"),le=ie.assign({selectedTopic:function(e,t){return t.selectedTopic}},"selectTopic"),se=ie.assign({timeDuration:function(e,t){return t.timeDuration}},"selectDuration"),ue=ie.createMachine({id:"topics",context:ie.initialContext,initial:"callApi",states:{callApi:{tags:"loading",initial:"loading",states:{loading:{invoke:{src:"api"},on:{fetchSuccess:{actions:re,target:"#topics.verifyData"},fetchFail:{actions:ce,target:"failure"}}},failure:{after:{1e3:[{cond:"canRetryFetching",target:"loading"},{target:"#topics.criticalFail"}]}}}},criticalFail:{tags:"failed",on:{refresh:{actions:oe,target:"callApi"}}},verifyData:{always:[{cond:"hasMetrics",target:"withTopics"},{target:"noData"}]},noData:{tags:"no-data",initial:"idle",states:{idle:{},refreshing:{tags:"refreshing",invoke:{src:"api"},on:{fetchSuccess:{actions:re,target:"#topics.verifyData"},fetchFail:{target:"#topics.noData"}}}},on:{refresh:{target:"#topics.noData.refreshing"},selectTopic:{actions:le,target:"#topics.noData.refreshing"},selectDuration:{actions:se,target:"#topics.noData.refreshing"}}},withTopics:{initial:"idle",states:{idle:{},refreshing:{tags:"refreshing",invoke:{src:"api"},on:{fetchSuccess:{actions:re,target:"#topics.verifyData"},fetchFail:{target:"#topics.withTopics"}}}},on:{refresh:{target:"#topics.withTopics.refreshing"},selectTopic:{actions:le,target:"#topics.withTopics.refreshing"},selectDuration:{actions:se,target:"#topics.withTopics.refreshing"}}}}},{guards:{canRetryFetching:function(e){return e.fetchFailures<3},hasMetrics:function(e){var t=e.kafkaTopics.length>0||e.metricsTopics.length>0,n=Object.keys(e.bytesIncoming).length>0||Object.keys(e.bytesOutgoing).length>0;return t&&n}}}),me=n(36953),de=(0,r.createContext)(null),fe=function(e){var t=e.kafkaId,n=e.children,a=function(e){var t=(0,J.useAuth)(),n=(((0,J.useConfig)()||{}).kas||{}).apiBasePath;return(0,K.useInterpret)(ue.withConfig({services:{api:function(a){return function(i){(0,me.cW)({kafkaId:e,selectedTopic:a.selectedTopic,timeDuration:a.timeDuration,timeInterval:B[a.timeDuration],accessToken:t.kas.getToken(),basePath:n}).then((function(e){return i(ie.events.fetchSuccess(e))})).catch((function(e){console.error("Failed fetching data",e),i(ie.events.fetchFail())}))}}}}),{devTools:!0})}(t),i=function(e){var t=(0,J.useAuth)(),n=(((0,J.useConfig)()||{}).kas||{}).apiBasePath;return(0,K.useInterpret)(ae.withConfig({services:{api:function(a){return function(i){(0,me.GX)({kafkaId:e,timeDuration:a.timeDuration,timeInterval:B[a.timeDuration],accessToken:t.kas.getToken(),basePath:n}).then((function(e){return i(Y.events.fetchSuccess({metrics:e}))})).catch((function(e){console.error("Failed fetching data",e),i(Y.events.fetchFail())}))}}}}),{devTools:!0})}(t);return c().createElement(de.Provider,{value:{kafkaId:t,diskSpaceMetricsMachineService:i,topicsMetricsMachineService:a}},n)};function he(){var e=(0,r.useContext)(de).diskSpaceMetricsMachineService,t=(0,r.useCallback)((function(e){return(0,N.__assign)((0,N.__assign)({},e.context),{isRefreshing:e.hasTag("refreshing"),isLoading:e.hasTag("loading"),isFailed:e.hasTag("failed"),isDataUnavailable:e.hasTag("no-data")})}),[]),n=(0,K.useSelector)(e,t),a=n.metrics,i=n.timeDuration,c=n.isLoading,o=n.isRefreshing,l=n.isDataUnavailable;return{metrics:a,isLoading:c,isRefreshing:o,isFailed:n.isFailed,isDataUnavailable:l,timeDuration:i,onDurationChange:(0,r.useCallback)((function(t){return e.send(Y.events.selectDuration(t))}),[e]),onRefresh:(0,r.useCallback)((function(){return e.send(Y.events.refresh())}),[e])}}var pe=function(e){var t=e.kafkaId,n=e.onCreateTopic;return c().createElement(fe,{kafkaId:t},c().createElement(ge,{onCreateTopic:n}))},ge=function(e){var t=e.onCreateTopic,n=he(),a=n.isLoading,i=n.isFailed;switch(!0){case a:return c().createElement(s,null);case i:return c().createElement(d,null)}return c().createElement(I,{diskSpaceMetrics:c().createElement(Ee,null),topicMetrics:c().createElement(ve,{onCreateTopic:t})})},Ee=function(){var e=he(),t=e.isLoading,n=e.isRefreshing,a=e.isDataUnavailable,i=e.isFailed,r=e.timeDuration,o=e.metrics,l=e.onDurationChange,s=e.onRefresh;return c().createElement(H,{metrics:o,timeDuration:r,metricsDataUnavailable:a||i,isLoading:t,isRefreshing:n,onRefresh:s,onTimeDuration:l})},ve=function(e){var t=e.onCreateTopic,n=function(){var e=(0,r.useContext)(de).topicsMetricsMachineService,t=(0,r.useCallback)((function(e){return(0,N.__assign)((0,N.__assign)({},e.context),{isRefreshing:e.hasTag("refreshing"),isLoading:e.hasTag("loading"),isFailed:e.hasTag("failed"),isDataUnavailable:e.hasTag("no-data")})}),[]),n=(0,K.useSelector)(e,t),a=n.selectedTopic,i=n.timeDuration,c=n.kafkaTopics,o=n.metricsTopics,l=n.bytesIncoming,s=n.bytesOutgoing,u=n.bytesPerPartition,m=n.isLoading,d=n.isRefreshing,f=n.isDataUnavailable,h=n.isFailed,p=(0,r.useCallback)((function(t){return e.send(ie.events.selectTopic(t))}),[e]),g=(0,r.useCallback)((function(t){return e.send(ie.events.selectDuration(t))}),[e]),E=(0,r.useCallback)((function(){return e.send(ie.events.refresh())}),[e]);return{isLoading:m,isRefreshing:d,isFailed:h,isDataUnavailable:f,topics:(0,r.useMemo)((function(){var e=Array.from(new Set((0,N.__spreadArray)((0,N.__spreadArray)([],c,!0),o,!0)));return e.sort((function(e,t){return e.localeCompare(t)})),e}),[c,o]),selectedTopic:a,timeDuration:i,bytesIncoming:l,bytesOutgoing:s,bytesPerPartition:u,onTopicChange:p,onDurationChange:g,onRefresh:E}}(),a=n.isLoading,i=n.isRefreshing,o=n.isFailed,l=n.isDataUnavailable,s=n.selectedTopic,u=n.timeDuration,m=n.topics,d=n.bytesIncoming,f=n.bytesOutgoing,h=n.bytesPerPartition,p=n.onDurationChange,g=n.onTopicChange,E=n.onRefresh;return c().createElement(A,{backendUnavailable:o,metricsDataUnavailable:l,topics:m,incomingTopicsData:d,outgoingTopicsData:f,partitions:h,timeDuration:u,isLoading:a,isRefreshing:i,selectedTopic:s,onRefresh:E,onSelectedTopic:g,onTimeDuration:p,onCreateTopic:t})}}}]);
//# sourceMappingURL=3832.010af702.js.map