(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[992],{26992:(e,t,n)=>{"use strict";n.d(t,{s:()=>v});var r=n(70655),l=n(48121),a=n.n(l),i=n(37539),o=n(94550),c=n(58788),u=n(45024),s=n(75381),d=n(71070),f=function(e){var t=e.filterSelected,n=e.setFilterSelected,r=e.filteredValue,o=e.setFilteredValue,s=e.handleCreateModal,f=(0,i.useTranslation)().t,m=(0,l.useRef)(),v=(0,l.useRef)(),p=(0,l.useState)(!1),_=p[0],b=p[1],g=(0,l.useState)(!0),E=g[0],h=g[1],S=(0,l.useState)(!0),w=S[0],y=S[1],V=(0,l.useState)(!1),C=V[0],k=(V[1],(0,l.useState)()),A=k[0],T=k[1],x=(0,l.useState)(),I=x[0],B=x[1],D=[{label:f("name"),value:"name",disabled:!1},{label:f("owner"),value:"owner",disabled:!1}],P=function(e){return!e||/^([a-zA-Z0-9-_%]*[a-zA-Z0-9-_%])?$/.test(e.trim())},F=function(e,t,n){var l=Object.assign([],r),a=l.findIndex((function(t){return t.filterKey===e}));if(a>-1){var i=l[a];if(i.filterValue&&i.filterValue.length>0){var c=i.filterValue.findIndex((function(e){return e.value===t.value}));if(c>-1){if(!n)return;i.filterValue.splice(c,1)}else l[a].filterValue.push(t)}else l[a].filterValue=[t]}else l.push({filterKey:e,filterValue:[t]});o(l)},O=function(e){"name"===e&&A&&""!=A.trim()?P(A)?(F("name",{value:A,isExact:!1},!1),T("")):h(!1):"owner"===e&&I&&""!=I.trim()&&(P(I)?(F("owner",{value:I,isExact:!1},!1),B("")):y(!1))},K=function(e){var t;if("Enter"===e.key&&!C){var n=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.name;O(n)}},L=function(e){return C?a().createElement("div",null,f("max_filter_message")):a().createElement("div",null,f("input_field_invalid_message",{name:e}))},R=function(e){var t=r.filter((function(t){return t.filterKey===e}));return t.length>0?t[0].filterValue.map((function(e){return e.value})):[]},j=function(e,t,n){var l,a,i=Object.assign([],r),c=i.findIndex((function(t){return t.filterKey===e})),u=Object.assign([],null===(l=i[c])||void 0===l?void 0:l.filterValue),s=t.toString();n&&(null==n?void 0:n.length)>0&&(s=null===(a=null==n?void 0:n.find((function(e){return e.label===t.toString()})))||void 0===a?void 0:a.value);var d=u.findIndex((function(e){return e.value===s}));d>=0&&(i[c].filterValue.splice(d,1),o(i))},G=function(e){var t=Object.assign([],r),n=t.findIndex((function(t){return t.filterKey===e}));n>=0&&(t.splice(n,1),o(t))},N=(a().createElement(a().Fragment,null,a().createElement(c.ToolbarGroup,{variant:"filter-group"},a().createElement(c.ToolbarItem,null,a().createElement(c.Select,{variant:c.SelectVariant.single,"aria-label":"Select filter",onToggle:function(){b(!_)},selections:t,isOpen:_,onSelect:function(e,t){b(!_),n(null==t?void 0:t.toString())}},D.map((function(e,t){return a().createElement(c.SelectOption,{isDisabled:e.disabled,key:t,value:e.value},e.label)})))),a().createElement(c.ToolbarFilter,{chips:R("name"),deleteChip:function(e,t){return j("name",t)},deleteChipGroup:function(){return G("name")},categoryName:f("name")},"name"===(null==t?void 0:t.toLowerCase())&&a().createElement(c.ToolbarItem,null,a().createElement(c.InputGroup,{className:"mk--filter-instances__toolbar--text-input"},a().createElement(c.TextInput,{name:"name",id:"name-input",type:"search","aria-label":f("filter_by_name_lower"),validated:!E||C?c.ValidatedOptions.error:c.ValidatedOptions.default,placeholder:f("filter_by_name_lower"),onChange:function(e){T(e),!E&&h(!0)},onKeyPress:K,value:A,ref:m}),a().createElement(c.Button,{variant:c.ButtonVariant.control,isDisabled:!E||C,onClick:function(){return O("name")},"aria-label":f("filter_by_name_lower")},a().createElement(d.ZP,null)),(!E||C)&&a().createElement(c.Tooltip,{isVisible:C||!E,content:L("name"),reference:m})))),a().createElement(c.ToolbarFilter,{chips:R("owner"),deleteChip:function(e,t){return j("owner",t)},deleteChipGroup:function(){return G("owner")},categoryName:f("owner")},"owner"===(null==t?void 0:t.toLowerCase())&&a().createElement(c.ToolbarItem,null,a().createElement(c.InputGroup,{className:"mk--filter-instances__toolbar--text-input"},a().createElement(c.TextInput,{name:"owner",id:"owner-input",type:"search","aria-label":f("filter_by_owner"),placeholder:f("filter_by_owner"),validated:!w||C?c.ValidatedOptions.error:c.ValidatedOptions.default,onChange:function(e){B(e),!w&&y(!0)},onKeyPress:K,value:I,ref:v}),a().createElement(c.Button,{isDisabled:!w||C,variant:c.ButtonVariant.control,onClick:function(){return O("owner")},"aria-label":f("filter_by_owner")},a().createElement(d.ZP,null)),(!w||C)&&a().createElement(c.Tooltip,{isVisible:C||!w,content:L("owner"),reference:v})))))),[{item:a().createElement(c.Button,{variant:"primary",onClick:s,"data-testid":"tableServiceAccounts-buttonCreateServiceAccount"},f("serviceAccount.create_service_account"))}]);return a().createElement(u.L5,{toolbarProps:{id:"instance-toolbar",clearAllFilters:function(){o([])},collapseListedFiltersBreakpoint:"md",inset:{xl:"insetLg"}},toolbarItems:N})},m=n(46748),v=function(e){var t=e.page,n=e.perPage,d=e.expectedTotal,v=e.total,p=e.serviceAccountsDataLoaded,_=e.serviceAccountItems,b=e.onResetCredentials,g=e.onDeleteServiceAccount,E=e.orderBy,h=e.setOrderBy,S=e.filteredValue,w=e.setFilteredValue,y=e.filterSelected,V=e.setFilterSelected,C=e.handleCreateModal,k=e.mainToggle,A=(0,i.useTranslation)().t,T=(0,m.useAuth)(),x=(0,l.useState)(void 0),I=x[0],B=x[1],D=(0,l.useState)(),P=D[0],F=D[1];(0,l.useEffect)((function(){null==T||T.getUsername().then((function(e){return B(e)}))}),[]),(0,l.useEffect)((function(){null==T||T.isOrgAdmin().then((function(e){return F(e)}))}),[T]);var O,K,L=[{title:A("common.name")},{title:A("common.clientID")},{title:A("common.owner"),transforms:[(0,o.cellWidth)(20)]},{title:A("common.description")},{title:A("time_created")}],R=function(e,t,n){var r,l,a,i;"reset-credentials"===n?b&&b(t):"delete-account"===n&&g&&g(t),null===(i=null===(a=null===(l=null===(r=null==e?void 0:e.target)||void 0===r?void 0:r.parentElement)||void 0===l?void 0:l.parentElement)||void 0===a?void 0:a.previousSibling)||void 0===i||i.focus()},j=function(e){switch(e.toLowerCase()){case"name":return 0;case"client_id":return 1;case"owner":return 2;case"description":return 3;case"created_at":return 4;default:return}};return a().createElement(a().Fragment,null,a().createElement(f,{filterSelected:y,setFilterSelected:V,total:v,page:t,perPage:n,filteredValue:S,setFilteredValue:w,handleCreateModal:C,mainToggle:k}),a().createElement(u.wR,{tableProps:{cells:L,rows:(O=[],K=(0,s.o8)(t,n,d),p?(null==_||_.forEach((function(e){var t=e.name,n=e.owner,r=e.description,l=e.client_id,a=e.created_at;O.push({cells:[t,l,n,r,{title:(0,s.L0)(a,A("ago"))}],originalData:e})})),O):(0,s.vK)({loadingCount:K,skeleton:a().createElement(c.Skeleton,null),length:L.length})),"aria-label":A("serviceAccount.service_account_list"),actionResolver:function(e,t){return function(e){var t,n;if(!p)return[];var l,a=e.originalData,i=a.owner===I||P;return i||(l={tooltip:!0,isDisabled:!0,style:{pointerEvents:"auto",cursor:"default"}}),[(0,r.__assign)((0,r.__assign)((t={title:A("common.reset_credentials"),id:"reset-credentials"},t["data-testid"]="tableServiceAccounts-actionResetCredentials",t.onClick=function(e){return i&&R(e,a,"reset-credentials")},t),l),{tooltipProps:{position:"left",content:A("serviceAccount.no_permission_to_reset_service_account")}}),(0,r.__assign)((0,r.__assign)((n={title:A("serviceAccount.delete_service_account"),id:"delete-account"},n["data-testid"]="tableServiceAccounts-actionDeleteAccount",n.onClick=function(e){return i&&R(e,a,"delete-account")},n),l),{tooltipProps:{position:"left",content:A("serviceAccount.no_permission_to_delete_service_account")}})]}(e)},onSort:function(e,t,n){h&&h(function(e){switch(e){case 0:return"name";case 1:return"client_id";case 2:return"owner";case 3:return"description";case 4:return"created_at";default:return""}}(t)+" "+n)},sortBy:function(){var e=(null==E?void 0:E.split(" "))||[];if(e.length>1)return{index:j(e[0]),direction:e[1]===o.SortByDirection.asc?o.SortByDirection.asc:o.SortByDirection.desc}}()}}),_&&(null==_?void 0:_.length)<1&&p&&a().createElement(u.C0,{emptyStateProps:{variant:u.jU.NoResult},titleProps:{title:A("no_results_found")},emptyStateBodyProps:{body:A("adjust_your_filters_and_try_again")}}))}}}]);
//# sourceMappingURL=992.b0ab6321.js.map