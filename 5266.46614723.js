"use strict";(self.webpackChunkkas_ui=self.webpackChunkkas_ui||[]).push([[5266],{27081:()=>{},91329:(e,t,n)=>{n.d(t,{d9:()=>i});var a=n(75418);function r(){return!document[(e=document,void 0!==e.hidden?"hidden":void 0!==e.msHidden?"msHidden":void 0!==e.webkitHidden?"webkitHidden":"")];var e}function i(){var e=(0,a.useState)(r()),t=e[0],n=e[1],i=function(){return n(r())};return(0,a.useEffect)((function(){var e,t=void 0!==(e=document).hidden?"visibilitychange":void 0!==e.msHidden?"msvisibilitychange":void 0!==e.webkitHidden?"webkitvisibilitychange":"";return document.addEventListener(t,i,!1),function(){document.removeEventListener(t,i)}}),[]),{isVisible:t,setIsVisible:n}}},61413:(e,t,n)=>{n.d(t,{o:()=>f});var a=n(75418),r=n.n(a),i=n(73394),l=n(86369),o=n.n(l),u=n(56176),s=n.n(u),c=(n(77903),n(71958),n(35946)),d=n(11845),f=function(e){var t=e.initialTab,n=e.onClose,a=e.instanceDetail,l=e.isExpanded,u=e.isLoading,f=e.children,v=e["data-ouia-app-id"],m=e.tokenEndPointUrl,p=e.notRequiredDrawerContentBackground;o().extend(s());var g=(0,i.useTranslation)().t;return r().createElement(c.D5,{isExpanded:l,isLoading:u,onClose:n,panelBodyContent:r().createElement(d.XA,{initialTab:t,instanceDetail:a,tokenEndPointUrl:m}),drawerHeaderProps:{text:{label:g("instance_name")},title:{value:null==a?void 0:a.name,headingLevel:"h1"}},"data-ouia-app-id":v,notRequiredDrawerContentBackground:p},f)}},11845:(e,t,n)=>{n.d(t,{so:()=>a,XA:()=>f});var a,r=n(75418),i=n.n(r),l=n(73394),o=n(75381),u=n(35946),s=n(84669),c=i().lazy((function(){return n.e(3495).then(n.bind(n,43495))})),d=i().lazy((function(){return n.e(4988).then(n.bind(n,44988))}));!function(e){e.DETAILS="details",e.CONNECTION="connection"}(a||(a={}));var f=function(e){var t,n=e.initialTab,f=e.instanceDetail,v=e.tokenEndPointUrl,m=(0,l.useTranslation)().t,p=(0,r.useState)(n||a.DETAILS),g=p[0],E=p[1],_=(null==f?void 0:f.status)===o.Od.ACCEPTED||(null==f?void 0:f.status)===o.Od.PREPARING;return i().createElement(i().Suspense,{fallback:i().createElement(u.yR,null)},i().createElement(s.Tabs,{activeKey:g.toString(),onSelect:function(e,t){return function(e){e===a.CONNECTION?E(a.CONNECTION):E(a.DETAILS)}(t)}},i().createElement(s.Tab,{eventKey:a.DETAILS.toString(),title:i().createElement(s.TabTitleText,null,m("details"))},i().createElement(d,{instanceDetail:f})),i().createElement(s.Tab,{eventKey:a.CONNECTION.toString(),title:i().createElement(s.TabTitleText,null,m("connection")),"data-testid":"drawerStreams-tabConnect"},i().createElement(c,{externalServer:(t=(f||{}).bootstrap_server_host,(null==t?void 0:t.endsWith(":443"))?t:t+":443"),isKafkaPending:_,tokenEndPointUrl:v}))))}},35266:(e,t,n)=>{n.d(t,{L:()=>U});var a=n(70655),r=n(75418),i=n.n(r),l=n(98068),o=n(73394),u=n(56176),s=n.n(u),c=n(86369),d=n.n(c),f=n(84669),v=n(35946);function m(e,t){var n=(0,r.useRef)();(0,r.useEffect)((function(){n.current=e}),[e]),(0,r.useEffect)((function(){if(null!==t){var e=setTimeout((function(){n.current()}),t);return function(){clearInterval(e)}}}),[e,t])}var p=n(75381),g=n(91329),E=n(10069),_=n(27577),h=n(80542),S=n(8755),b=function(e,t){var n=(0,o.useTranslation)().t;return e?i().createElement("div",null,n("max_filter_message")):i().createElement("div",null,n("input_field_invalid_message",{name:t}))},k=function(e){var t,n=e.getSelectionForFilter,a=e.filterSelected,l=e.isMaxFilter,u=e.updateFilter,s=e.removeFilterValue,c=e.isDisabledSelectOption,d=e.onDeleteChipGroup,v=e.onDeleteChip,m=(0,o.useTranslation)().t,g=(0,r.useRef)(null),E=b(l),_=p.bv.map((function(e){return{label:m(e.value),value:e.value,disabled:!1}})),h=function(){return l?i().createElement(f.Tooltip,{isVisible:l,content:E,reference:g}):i().createElement(i().Fragment,null)};return i().createElement(f.ToolbarFilter,{chips:null===(t=n("cloud_provider"))||void 0===t?void 0:t.map((function(e){return m(e)})),deleteChip:function(e,t){return v("cloud_provider",t,_)},deleteChipGroup:function(){return d("cloud_provider")},categoryName:m("cloud_provider"),showToolbarItem:"cloud_provider"===a},i().createElement((function(){var e=(0,r.useState)(!1),t=e[0],o=e[1],d=function(){s("cloud_provider"),o(!1)};return"cloud_provider"===a?i().createElement(f.Select,{id:"cloud-provider-select",variant:f.SelectVariant.checkbox,"aria-label":"Select cloud provider",onToggle:function(){o((function(e){return!e}))},selections:n("cloud_provider"),isOpen:t,onSelect:function(e,t,n){n&&d(),u("cloud_provider",{value:t.toString(),isExact:!0},!0),_.length<2&&o(!1)},placeholderText:m("filter_by_cloud_provider"),className:"select-custom-width",ref:g},_.map((function(e,t){return i().createElement(f.SelectOption,{isDisabled:!!e.disabled||l&&c("cloud_provider",e.value),key:t,value:e.value},i().createElement(h,null),e.label)}))):i().createElement(i().Fragment,null)}),null))},w=n(71070),C=function(e){var t=e.getSelectionForFilter,n=e.onDeleteChip,a=e.onDeleteChipGroup,l=e.filterSelected,u=e.isMaxFilter,s=e.updateFilter,c=(0,o.useTranslation)().t,d=(0,r.useState)(!0),v=d[0],m=d[1],p=(0,r.useState)(),g=p[0],E=p[1],_=(0,r.useRef)(null),h=b(u,"name"),S=function(e){E(e),!v&&m(!0)},k=function(e){"Enter"!==e.key||u||C()},C=function(){g&&""!=g.trim()&&(!function(e){return!e||/^([a-zA-Z0-9-_%]*[a-zA-Z0-9-_%])?$/.test(e.trim())}(g)?m(!1):(s("name",{value:g,isExact:!1},!1),E("")))};return i().createElement(f.ToolbarFilter,{chips:t("name"),deleteChip:function(e,t){return n("name",t)},deleteChipGroup:function(){return a("name")},categoryName:c("name"),showToolbarItem:"name"===(null==l?void 0:l.toLowerCase())},i().createElement((function(){var e=!v||u;return"name"===(null==l?void 0:l.toLowerCase())?i().createElement(f.InputGroup,null,i().createElement(f.TextInput,{name:"name",id:"filterText",type:"search","aria-label":"Search filter input",validated:e?f.ValidatedOptions.error:f.ValidatedOptions.default,placeholder:c("filter_by_name_lower"),onChange:S,onKeyPress:k,value:g,ref:_}),i().createElement(f.Button,{variant:f.ButtonVariant.control,isDisabled:!v||u,onClick:function(){return C()},"aria-label":"Search instances"},i().createElement(w.ZP,null)),i().createElement((function(){return e?i().createElement(f.Tooltip,{isVisible:u||!v,content:h,reference:_}):i().createElement(i().Fragment,null)}),null)):i().createElement(i().Fragment,null)}),null))},F=function(e){var t=e.getSelectionForFilter,n=e.onDeleteChipGroup,a=e.onDeleteChip,l=e.filterSelected,u=e.isMaxFilter,s=e.updateFilter,c=(0,o.useTranslation)().t,d=(0,r.useRef)(null),v=b(u,"owner"),m=(0,r.useState)(),p=m[0],g=m[1],E=(0,r.useState)(!0),_=E[0],h=E[1],S=function(){p&&""!=p.trim()&&(!function(e){return!e||/^([a-zA-Z0-9-_%]*[a-zA-Z0-9-_%])?$/.test(e.trim())}(p)?h(!1):(s("owner",{value:p,isExact:!1},!1),g("")))},k=function(e){"Enter"!==e.key||u||S()},C=function(e){g(e),!_&&h(!0)};return i().createElement(f.ToolbarFilter,{chips:t("owner"),deleteChip:function(e,t){return a("owner",t)},deleteChipGroup:function(){return n("owner")},categoryName:c("owner"),showToolbarItem:"owner"===(null==l?void 0:l.toLowerCase())},i().createElement((function(){if("owner"===(null==l?void 0:l.toLowerCase())){var e=!_||u;return i().createElement(f.InputGroup,null,i().createElement(f.TextInput,{name:"owner",id:"filterOwners",type:"search","aria-label":"Search filter input",placeholder:c("filter_by_owner"),validated:e?f.ValidatedOptions.error:f.ValidatedOptions.default,onChange:C,onKeyPress:k,value:p,ref:d}),i().createElement(f.Button,{isDisabled:e,variant:f.ButtonVariant.control,onClick:S,"aria-label":"Search owners"},i().createElement(w.ZP,null)),i().createElement((function(){return e?i().createElement(f.Tooltip,{isVisible:u||!_,content:v,reference:d}):i().createElement(i().Fragment,null)}),null))}return i().createElement(i().Fragment,null)}),null))},T=function(e){var t,n=e.getSelectionForFilter,a=e.onDeleteChip,l=e.onDeleteChipGroup,u=e.removeFilterValue,s=e.isDisabledSelectOption,c=e.isMaxFilter,d=e.filterSelected,v=e.updateFilter,m=(0,o.useTranslation)().t,g=(0,r.useRef)(null),E=b(c),_=p.Bh.map((function(e){return{label:m(e.value),value:e.value,disabled:!1}})),h=function(){return c?i().createElement(f.Tooltip,{isVisible:c,content:E,reference:g}):i().createElement(i().Fragment,null)};return i().createElement(f.ToolbarFilter,{chips:null===(t=n("region"))||void 0===t?void 0:t.map((function(e){return m(e)})),deleteChip:function(e,t){return a("region",t,_)},deleteChipGroup:function(){return l("region")},categoryName:m("region"),showToolbarItem:"region"===d},i().createElement((function(){var e=(0,r.useState)(!1),t=e[0],a=e[1],l=function(){u("region"),a(!1)};return"region"===d?i().createElement(f.Select,{id:"region-select",variant:f.SelectVariant.checkbox,"aria-label":"Select region",onToggle:function(){a(!t)},selections:n("region"),isOpen:t,onSelect:function(e,t,n){n&&l(),v("region",{value:t.toString(),isExact:!0},!0),_.length<2&&a(!1)},placeholderText:m("filter_by_region"),className:"select-custom-width",ref:g},_.map((function(e,t){return i().createElement(f.SelectOption,{isDisabled:!!e.disabled||c&&s("region",e.value),key:t,value:e.value},i().createElement(h,null),e.label)}))):i().createElement(i().Fragment,null)}),null))},D=function(e){var t=e.setFilterSelected,n=e.filterSelected,a=(0,o.useTranslation)().t,l=(0,r.useState)(!1),u=l[0],s=l[1],c=[{label:a("name"),value:"name",disabled:!1},{label:a("cloud_provider"),value:"cloud_provider",disabled:!1},{label:a("region"),value:"region",disabled:!1},{label:a("owner"),value:"owner",disabled:!1},{label:a("status"),value:"status",disabled:!1}];return i().createElement(f.ToolbarItem,null,i().createElement(f.Select,{variant:f.SelectVariant.single,"aria-label":"Select filter",onToggle:function(){s(!u)},selections:n,isOpen:u,onSelect:function(e,n){s(!u),t(null==n?void 0:n.toString())}},c.map((function(e,t){return i().createElement(f.SelectOption,{isDisabled:e.disabled,key:t,value:e.value},e.label)}))))},I=function(e){var t,n=e.getSelectionForFilter,a=e.onDeleteChip,l=e.onDeleteChipGroup,u=e.isMaxFilter,s=e.filterSelected,c=e.updateFilter,d=e.removeFilterValue,v=e.isDisabledSelectOption,m=(0,o.useTranslation)().t,g=b(u),E=(0,r.useRef)(null),_=p.hm.filter((function(e){return e.value!==p.Od.PREPARING&&e.value!==p.Od.DELETED})).map((function(e){return{label:m(e.value),value:e.value,disabled:!1}})),h=function(){return u?i().createElement(f.Tooltip,{isVisible:u,content:g,reference:E}):i().createElement(i().Fragment,null)};return i().createElement(f.ToolbarFilter,{chips:null===(t=n("status"))||void 0===t?void 0:t.map((function(e){return m(e)})),deleteChip:function(e,t){return a("status",t,_)},deleteChipGroup:function(){return l("status")},categoryName:m("status"),showToolbarItem:"status"===s},i().createElement((function(){var e=(0,r.useState)(!1),t=e[0],a=e[1],l=function(){d("status"),a(!1)};return"status"===s?i().createElement(f.Select,{id:"status-select",variant:f.SelectVariant.checkbox,"aria-label":"Select status",onToggle:function(){a(!t)},selections:n("status"),isOpen:t,onSelect:function(e,t,n){n&&l(),c("status",{value:t.toString(),isExact:!0},!0)},placeholderText:m("filter_by_status"),className:"select-custom-width",ref:E},_.map((function(e,t){return i().createElement(f.SelectOption,{isDisabled:!!e.disabled||u&&v("status",e.value),key:t,value:e.value},i().createElement(h,null),e.label)}))):i().createElement(i().Fragment,null)}),null))},O=function(e){var t=e.isMaxFilter,n=e.filteredValue,a=e.setFilteredValue,r=e.filterSelected,l=e.setFilterSelected,o=function(e,t){var a,r=null==n?void 0:n.filter((function(t){return t.filterKey===e}));if(r&&(null==r?void 0:r.length)>0){var i=r[0].filterValue;a=null==i?void 0:i.find((function(e){return e.value===t}))}return!a},u=function(e,t,r){var i=Object.assign([],n),l=i.findIndex((function(t){return t.filterKey===e}));if(l>-1){var o=i[l];if(o.filterValue&&o.filterValue.length>0){var u=o.filterValue.findIndex((function(e){return e.value===t.value}));if(u>-1){if(!r)return;o.filterValue.splice(u,1)}else i[l].filterValue.push(t)}else i[l].filterValue=[t]}else i.push({filterKey:e,filterValue:[t]});a(i)},s=function(e){var t=n.filter((function(t){return t.filterKey===e}));if(t.length>0)return t[0].filterValue.map((function(e){return e.value}))},c=function(e,t,r){var i,l,o=Object.assign([],n),u=o.findIndex((function(t){return t.filterKey===e})),s=Object.assign([],null===(i=o[u])||void 0===i?void 0:i.filterValue),c=t.toString();r&&(null==r?void 0:r.length)>0&&(c=null===(l=null==r?void 0:r.find((function(e){return e.label===t.toString()})))||void 0===l?void 0:l.value);var d=s.findIndex((function(e){return e.value===c}));d>=0&&(o[u].filterValue.splice(d,1),a(o))},d=function(e){var t=Object.assign([],n),r=t.findIndex((function(t){return t.filterKey===e}));r>=0&&(t.splice(r,1),a(t))},v=function(e){var t=Object.assign([],n),r=t.findIndex((function(t){return t.filterKey===e}));r>=0&&t.splice(r,1),a(t)};return i().createElement(i().Fragment,null,i().createElement(f.ToolbarGroup,{variant:"filter-group"},i().createElement(D,{setFilterSelected:l,filterSelected:r}),i().createElement(C,{isMaxFilter:t,filterSelected:r,getSelectionForFilter:s,updateFilter:u,onDeleteChip:c,onDeleteChipGroup:d,removeFilterValue:v,isDisabledSelectOption:o}),i().createElement(k,{isMaxFilter:t,filterSelected:r,getSelectionForFilter:s,updateFilter:u,onDeleteChip:c,onDeleteChipGroup:d,removeFilterValue:v,isDisabledSelectOption:o}),i().createElement(T,{isMaxFilter:t,filterSelected:r,getSelectionForFilter:s,updateFilter:u,onDeleteChip:c,onDeleteChipGroup:d,removeFilterValue:v,isDisabledSelectOption:o}),i().createElement(F,{isMaxFilter:t,filterSelected:r,getSelectionForFilter:s,updateFilter:u,onDeleteChip:c,onDeleteChipGroup:d,removeFilterValue:v,isDisabledSelectOption:o}),i().createElement(I,{isMaxFilter:t,filterSelected:r,getSelectionForFilter:s,updateFilter:u,onDeleteChip:c,onDeleteChipGroup:d,removeFilterValue:v,isDisabledSelectOption:o})))},P=function(e){var t=e.setFilterSelected,n=e.filterSelected,a=void 0===n?"name":n,l=e.total,u=e.page,s=e.perPage,c=e.filteredValue,d=e.setFilteredValue,m=e.handleCreateInstanceModal,g=(0,o.useTranslation)().t,E=(0,r.useState)(!1),_=E[0],h=E[1];(0,r.useEffect)((function(){b()}),[c]);var b=function(){var e=0;null==c||c.forEach((function(t){var n=t.filterValue,a=t.filterKey,r="status"===a?null==n?void 0:n.filter((function(e){return e.value===p.Od.PROVISIONING})):[],i="status"===a?null==n?void 0:n.filter((function(e){return e.value===p.Od.DEPROVISION})):[];(null==r?void 0:r.length)>0&&(null==i?void 0:i.length)>0?e+=(null==n?void 0:n.length)+2:(null==r?void 0:r.length)>0||(null==i?void 0:i.length)>0?e+=(null==n?void 0:n.length)+1:e+=null==n?void 0:n.length})),e>=p.pf?h(!0):h(!1)},k=[{item:i().createElement(f.Button,{variant:"primary",onClick:m,"data-testid":"tableStreams-buttonCreateKafka"},g("create_kafka_instance"))}];return l&&l>0&&k.push({item:i().createElement(v.wu,{widgetId:"pagination-cloudProviderOptions-menu-top",itemCount:l,page:u,perPage:s,isCompact:!0,titles:{paginationTitle:g("minimal_pagination"),perPageSuffix:g("per_page_suffix"),toFirstPage:g("to_first_page"),toPreviousPage:g("to_previous_page"),toLastPage:g("to_last_page"),toNextPage:g("to_next_page"),optionsToggle:g("options_toggle"),currPage:g("curr_page")}}),variant:"pagination",alignment:{default:"alignRight"}}),i().createElement(v.L5,{toolbarProps:{id:"instance-toolbar",clearAllFilters:function(){d([]),h(!1)},collapseListedFiltersBreakpoint:"md",inset:{xl:"insetLg"}},toggleGroupProps:{toggleIcon:i().createElement(S.ZP,null),breakpoint:"md"},toggleGroupItems:i().createElement(O,{isMaxFilter:_,filteredValue:c,setFilteredValue:d,setFilterSelected:t,filterSelected:a}),toolbarItems:k})},y=n(35451),V=n(41942),x=n(84564),N=n(52648),A=function(e){var t=e.status,n=e.instanceName,a=(0,o.useTranslation)().t,r=function(){switch(null==t?void 0:t.toLowerCase()){case N.hm[0].value:return i().createElement(y.ZP,{className:"mk--instances__table--icon--completed"});case N.hm[1].value:return i().createElement(x.ZP,{className:"mk--instances__table--icon--failed"});case N.hm[2].value:return i().createElement(V.ZP,null);case N.hm[3].value:case N.hm[4].value:return i().createElement(f.Spinner,{size:"md","aria-label":n,"aria-valuetext":"Creation in progress"});case N.hm[5].value:case N.hm[6].value:return;default:return i().createElement(V.ZP,null)}};return i().createElement(f.Flex,null,i().createElement((function(){var e=r();return e?i().createElement(f.FlexItem,{spacer:{default:"spacerSm"}},e):i().createElement(i().Fragment,null)}),null),i().createElement(f.FlexItem,null,i().createElement((function(){var e=N.hm.filter((function(e){return e.value===(null==t?void 0:t.toLowerCase())}));return 1===e.length?a(e[0].value):a("creation_pending")}),null)))},L=n(46332),R=n(13449),M=function(e){var t=e.kafkaInstanceItems,n=e.onViewInstance,u=e.onViewConnection,s=e.refresh,c=e.page,d=e.perPage,m=e.total,g=e.kafkaDataLoaded,E=e.onDelete,S=e.expectedTotal,b=e.filteredValue,k=e.setFilteredValue,w=e.setFilterSelected,C=e.filterSelected,F=e.orderBy,T=e.setOrderBy,D=e.isDrawerOpen,I=e.loggedInUser,O=e.setWaitingForDelete,y=e.currentUserkafkas,V=e.onCreate,x=e.handleCreateInstanceModal,N=(0,L.useAuth)(),M=(((0,L.useConfig)()||{}).kas||{}).apiBasePath,B=(0,o.useTranslation)().t,K=new URLSearchParams(location.search),G=(0,l.useHistory)(),U=((0,L.useAlert)()||{}).addAlert,j=((0,R.S)()||{}).setKafkaInstance,Z=(0,L.useModal)(),H=Z.showModal,z=Z.hideModal,q=(0,r.useState)({}),Q=q[0],W=q[1],Y=(0,r.useState)(),J=Y[0],X=Y[1],$=(0,r.useState)([]),ee=$[0],te=$[1],ne=(0,r.useState)([]),ae=ne[0],re=ne[1],ie=(0,r.useState)(),le=ie[0],oe=ie[1],ue=[{title:B("name"),transforms:[_.sortable]},{title:B("cloud_provider"),transforms:[_.sortable]},{title:B("region"),transforms:[_.sortable]},{title:B("owner"),transforms:[_.sortable]},{title:B("status"),transforms:[_.sortable]},{title:B("time_created"),transforms:[_.sortable]}];(0,r.useEffect)((function(){var e;null===(e=N.isOrgAdmin())||void 0===e||e.then((function(e){return oe(e)}))}),[N]);var se=(0,r.useCallback)((function(e,t){K.set(e,t.toString())}),[K]);(0,r.useEffect)((function(){D||X("")}),[D]);var ce=function(){if(y){var e=y.filter((function(e){return e.status===p.Od.DEPROVISION||e.status===p.Od.DELETED})).filter((function(e){return ee.findIndex((function(t){return t===e.name}))<0})).map((function(e){return e.name||""})),t=(0,a.__spreadArray)((0,a.__spreadArray)([],ee,!0),e,!0);te(t),t.forEach((function(e){(null==y?void 0:y.findIndex((function(t){return t.name===e})))<0&&(!function(e){var t=ee.findIndex((function(t){return t===e}));if(t>-1){var n=Object.assign([],ee);n.splice(t,1),te(n)}}(e),U&&U({title:B("kafka_successfully_deleted",{name:e}),variant:L.AlertVariant.success}))}))}};(0,r.useEffect)((function(){c>1&&0===t.length&&(se("page",(c-1).toString()),se("perPage",d.toString()),G.push({search:K.toString()})),ce(),function(){var e=JSON.parse(JSON.stringify(ae));if(ae&&ae.length>0){var n=Object.assign([],t).filter((function(e){return e.status===p.Od.READY||e.status===p.Od.FAILED}));e.forEach((function(e){var t,a,r=n.filter((function(t){return e.id===t.id}));r&&r.length>0&&(r[0].status===p.Od.READY?U&&U({title:B("kafka_successfully_created"),variant:L.AlertVariant.success,description:i().createElement("span",{dangerouslySetInnerHTML:{__html:B("kafka_success_message",{name:null===(t=r[0])||void 0===t?void 0:t.name})}}),dataTestId:"toastCreateKafka-success"}):r[0].status===p.Od.FAILED&&U&&U({title:B("kafka_not_created"),variant:L.AlertVariant.danger,description:i().createElement("span",{dangerouslySetInnerHTML:{__html:B("kafka_failed_message",{name:null===(a=r[0])||void 0===a?void 0:a.name})}}),dataTestId:"toastCreateKafka-failed"}))}))}var a=Object.assign([],null==t?void 0:t.filter((function(e){return e.status===p.Od.PROVISIONING||e.status===p.Od.ACCEPTED})));re(a)}()}),[c,d,t,y]);var de,fe,ve=function(e,t,a){var r,i,l;"view-instance"===a?(n(t),X(null==t?void 0:t.name)):"connect-instance"===a?(u(t),X(null==t?void 0:t.name)):"change-owner"===a?me(t):"delete-instance"===a&&pe(t);var o=null===(l=null===(i=null===(r=null==e?void 0:e.target)||void 0===r?void 0:r.parentElement)||void 0===i?void 0:i.parentElement)||void 0===l?void 0:l.previousSibling;null!=o&&o.focus()},me=function(e){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){return(0,a.__generator)(this,(function(t){return j&&j(e),W(e),H(L.ModalType.KasTransferOwnership,{kafka:e,refreshKafkas:s}),[2]}))}))},pe=function(e){var t=e.status;W(e),t===p.Od.FAILED?ge(e):H(L.ModalType.KasDeleteInstance,{onDelete:function(){return ge(e)},kafka:e})},ge=function(e){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var t,n,r,i,l,o;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(void 0===(t=(null==Q?void 0:Q.id)||(null==e?void 0:e.id)))throw new Error("kafka instance id is not set");return[4,null==N?void 0:N.kas.getToken()];case 1:n=a.sent(),r=new h.DefaultApi(new h.Configuration({accessToken:n,basePath:M})),E(),z(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,r.deleteKafkaById(t,!0).then((function(){X(void 0),O(!0),s(),W(void 0)}))];case 3:return a.sent(),[3,5];case 4:return i=a.sent(),l=void 0,(0,p.G6)(i)&&(l=null===(o=i.response)||void 0===o?void 0:o.data.reason),U&&U({title:B("common.something_went_wrong"),variant:L.AlertVariant.danger,description:l}),[3,5];case 5:return[2]}}))}))},Ee=function(e){switch(e.toLowerCase()){case"name":return 0;case"cloud_provider":return 1;case"region":return 2;case"owner":return 3;case"status":return 4;case"created_at":return 5;default:return}},_e=function(){var e=(null==F?void 0:F.split(" "))||[];if(e.length>1)return{index:Ee(e[0]),direction:e[1]===_.SortByDirection.asc?_.SortByDirection.asc:_.SortByDirection.desc}};return i().createElement(i().Fragment,null,i().createElement(P,{filterSelected:C,setFilterSelected:w,total:m,page:c,perPage:d,filteredValue:b,setFilteredValue:k,onCreate:V,refresh:s,handleCreateInstanceModal:x}),i().createElement(v.wR,{tableProps:{cells:ue,rows:(de=[],fe=(0,p.o8)(c,d,S),g?(t.forEach((function(e){var t=e.name,n=e.cloud_provider,a=e.region,r=e.created_at,o=e.status,u=e.owner,s=e.instance_type,c=B(n),d=B(a);de.push({cells:[{title:o===p.Od.DEPROVISION||o!==p.Od.READY?t:i().createElement(l.Link,{to:"kafkas/"+(null==e?void 0:e.id)},t)},c,d,u,{title:i().createElement(A,{status:o,instanceName:t})},{title:i().createElement(i().Fragment,null,(0,p.L0)(r,B("ago")),i().createElement("br",null),s===(null===p.ik||void 0===p.ik?void 0:p.ik.eval)&&"48 hours duration")}],originalData:e})})),de):(0,p.vK)({loadingCount:fe,skeleton:i().createElement(f.Skeleton,null),length:ue.length})),"aria-label":B("cluster_instance_list"),actionResolver:function(e){return function(e){var t,n,r,i;if(!g)return[];var l=e.originalData;if(l.status===p.Od.DEPROVISION||l.status===p.Od.DELETED)return[];var o,u=l.owner===I||le;return u||(o={tooltip:!0,isDisabled:!0,style:{pointerEvents:"auto",cursor:"default"}}),[(0,a.__assign)((0,a.__assign)((t={title:B("view_details"),id:"view-instance"},t["data-testid"]="tableStreams-actionDetails",t.onClick=function(e){return u&&ve(e,l,"view-instance")},t),o),{tooltipProps:{position:"left",content:B("no_permission_to_view_kafka")}}),(0,a.__assign)((0,a.__assign)((n={title:B("view_connection_information"),id:"connect-instance"},n["data-testid"]="tableStreams-actionConnection",n.onClick=function(e){return u&&ve(e,l,"connect-instance")},n),o),{tooltipProps:{position:"left",content:B("no_permission_to_connect_kafka")}}),(0,a.__assign)((0,a.__assign)((r={title:B("change_owner"),id:"change-owner"},r["data-testid"]="tableStreams-actionChangeOwner",r.onClick=function(e){return u&&ve(e,l,"change-owner")},r),o),{tooltipProps:{position:"left",content:B("no_permission_to_change_owner")}}),(0,a.__assign)((0,a.__assign)((i={title:B("delete_instance"),id:"delete-instance"},i["data-testid"]="tableStreams-actionDelete",i.onClick=function(e){return u&&ve(e,l,"delete-instance")},i),o),{tooltipProps:{position:"left",content:B("no_permission_to_delete_kafka")}})]}(e)},onSort:function(e,t,n,a){var r,i=n;(null===(r=_e())||void 0===r?void 0:r.index)!==t&&"time-created"===a.property&&(i="desc"),T(function(e){switch(e){case 0:return"name";case 1:return"cloud_provider";case 2:return"region";case 3:return"owner";case 4:return"status";case 5:return"created_at";default:return""}}(t)+" "+i)},sortBy:_e(),hasDefaultCustomRowWrapper:!0},activeRow:J,onRowClick:function(e,t,a){var r,i,l=a.originalData,o=null===(r=null==e?void 0:e.target)||void 0===r?void 0:r.type,u=null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.tagName;"button"!==o&&"a"!==(null==u?void 0:u.toLowerCase())&&(n(l),X(null==l?void 0:l.name))},rowDataTestId:"tableStreams-row",loggedInUser:I}),i().createElement((function(){return t.length<1&&g?i().createElement(v.C0,{emptyStateProps:{variant:v.jU.NoResult},titleProps:{title:B("no_results_found")},emptyStateBodyProps:{body:B("adjust_your_filters_and_try_again")}}):i().createElement(i().Fragment,null)}),null),i().createElement((function(){return m>0?i().createElement(v.wu,{widgetId:"pagination-cloudProviderOptions-menu-bottom",itemCount:m,variant:f.PaginationVariant.bottom,page:c,perPage:d,titles:{paginationTitle:B("full_pagination"),perPageSuffix:B("per_page_suffix"),toFirstPage:B("to_first_page"),toPreviousPage:B("to_previous_page"),toLastPage:B("to_last_page"),toNextPage:B("to_next_page"),optionsToggle:B("options_toggle"),currPage:B("curr_page")}}):i().createElement(i().Fragment,null)}),null))},B=n(61413),K=n(5569),G=n(11845),U=(n(27081),function(e){var t=e.preCreateInstance,n=e.tokenEndPointUrl;d().extend(s());var u=((0,R.S)()||{}).shouldOpenCreateModal,c=(0,L.useAuth)(),_=(((0,L.useConfig)()||{}).kas||{}).apiBasePath,S=(0,g.d9)().isVisible,b=(0,l.useLocation)(),k=new URLSearchParams(b.search),w=(0,v.h0)()||{},C=w.page,F=void 0===C?1:C,T=w.perPage,D=void 0===T?10:T,I=k.has("user-testing"),O=(0,o.useTranslation)().t,P=((0,L.useAlert)()||{}).addAlert,y=(0,L.useModal)().showModal,V=window.localStorage,x=i().useContext(E.QuickStartContext),N=(0,r.useState)(),A=N[0],U=N[1],j=(0,r.useState)({}),Z=j[0],H=j[1],z=(0,r.useState)(!1),q=z[0],Q=z[1],W=(0,r.useState)("created_at desc"),Y=W[0],J=W[1],X=(0,r.useState)(),$=X[0],ee=X[1],te=(0,r.useState)(0),ne=te[0],ae=te[1],re=(0,r.useState)(void 0),ie=re[0],le=re[1],oe=(0,r.useState)("name"),ue=oe[0],se=oe[1],ce=(0,r.useState)([]),de=ce[0],fe=ce[1],ve=(0,r.useState)(!1),me=ve[0],pe=ve[1],ge=(0,r.useState)(!1),Ee=ge[0],_e=ge[1],he=(0,r.useState)(!1),Se=he[0],be=he[1],ke=(0,r.useState)(void 0),we=ke[0],Ce=ke[1],Fe=(0,r.useState)(),Te=Fe[0],De=Fe[1],Ie=$||{},Oe=Ie.activeTab,Pe=Ie.instanceDetail;(0,r.useEffect)((function(){if((0,p.Qw)()&&V){var e=parseInt(V.getItem("openSessions")||"0"),t=e+1;e<1&&(V.setItem("openSessions",""+t),_e(!0))}}),[]);var ye=function(){_e(!Ee)};(0,r.useEffect)((function(){(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return(e=u)?[4,u()]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return e&&Ve(),[2]}}))}))}),[u]);var Ve=function(){y(L.ModalType.KasCreateInstance,{onCreate:function(){Ke(),Be()}})},xe=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return t?[4,t(!0)]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return e&&(Me(),Ve()),[2]}}))}))},Ne=function(e){ee({instanceDetail:e,activeTab:G.so.DETAILS})},Ae=function(e){ee({instanceDetail:e,activeTab:G.so.CONNECTION})},Le=function(e){var t,n,a,r,i;(0,p.G6)(e)&&(r=null===(t=e.response)||void 0===t?void 0:t.data.reason,i=null===(a=null===(n=e.response)||void 0===n?void 0:n.data)||void 0===a?void 0:a.code),i===p.SM.UNAUTHORIZED_USER?pe(!0):P&&P({variant:f.AlertVariant.danger,title:O("common.something_went_wrong"),description:r})},Re=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return r=[],de.forEach((function(e){var t=e.filterKey,n=e.filterValue;if(n&&n.length>0){var a="(";a+=n.map((function(e){var n=e.value.trim();return n===p.Od.PROVISIONING?t+" = "+p.Od.PREPARING+" or "+t+" = "+p.Od.PROVISIONING:n===p.Od.DEPROVISION?t+" = "+p.Od.DEPROVISION+" or "+t+" = "+p.Od.DELETED:""!==n?t+" "+(!0===e.isExact?"= "+n:"like %"+n+"%"):""})).join(" or "),a+=")",r.push(a)}})),e=r.join(" and "),[4,null==c?void 0:c.kas.getToken()];case 1:if(!(t=a.sent())||!S)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new h.DefaultApi(new h.Configuration({accessToken:t,basePath:_})).getKafkas(null==F?void 0:F.toString(),null==D?void 0:D.toString(),Y,e).then((function(e){var t=e.data,n=(null==t?void 0:t.items)||[];H(t),U(n),void 0!==(null==Z?void 0:Z.total)&&Z.total>ne&&ae(Z.total),Se&&de.length<1&&0==(null==n?void 0:n.length)&&(le(!0),be(!1)),Q(!0)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Le(n),[3,5];case 5:return[2]}var r}))}))};(0,r.useEffect)((function(){(!A||(null==A?void 0:A.length)<=1)&&(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==c?void 0:c.kas.getToken()];case 1:if(!(e=n.sent())||!S)return[3,5];n.label=2;case 2:return n.trys.push([2,4,,5]),[4,new h.DefaultApi(new h.Configuration({accessToken:e,basePath:_})).getKafkas("1","1").then((function(e){var t,n,a=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.items)||void 0===n?void 0:n.length;le(!a||a<1)}))];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),Le(t),[3,5];case 5:return[2]}}))}))}),[A]);var Me=function(){return(0,a.__awaiter)(void 0,void 0,void 0,(function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,null==c?void 0:c.kas.getToken()];case 1:if(e=a.sent(),t="owner = "+we,!e||!S)return[3,5];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,new h.DefaultApi(new h.Configuration({accessToken:e,basePath:_})).getKafkas("","","",t).then((function(e){var t=e.data;De(t.items)}))];case 3:return a.sent(),[3,5];case 4:return n=a.sent(),Le(n),[3,5];case 5:return[2]}}))}))};(0,r.useEffect)((function(){we&&Me()}),[we]),m((function(){return Me()}),p.md),(0,r.useEffect)((function(){Q(!1),Re()}),[c,F,D,de,Y]),(0,r.useEffect)((function(){Re()}),[]),(0,r.useEffect)((function(){!function(){if(A&&(null==A?void 0:A.length)>0){var e=null==A?void 0:A.filter((function(e){var t;return(null==e?void 0:e.id)===(null===(t=null==$?void 0:$.instanceDetail)||void 0===t?void 0:t.id)}))[0],t=(0,a.__assign)((0,a.__assign)({},$),{instanceDetail:e});e&&ee(t)}}()}),[A]),(0,r.useEffect)((function(){var e;null===(e=c.getUsername())||void 0===e||e.then((function(e){return Ce(e)}))}),[c]),m((function(){return Re()}),p.md);var Be=function(){A&&1===(null==A?void 0:A.length)?Q(!0):Q(!1),Re()},Ke=function(){ae(Z.total+1)},Ge=function(){Q(!1),ae(Z.total-1)};if(me)return i().createElement(f.PageSection,{variant:f.PageSectionVariants.default,padding:{default:"noPadding"},isFilled:!0},i().createElement(v.C0,{titleProps:{title:O("access_permissions_needed"),headingLevel:"h2"},emptyStateIconProps:{icon:K.ZP},emptyStateBodyProps:{body:O("to_access_kafka_instances_contact_your_organization_administrators")}}));return i().createElement(i().Fragment,null,i().createElement(B.o,{isExpanded:null!=$,initialTab:Oe,isLoading:void 0===Pe,instanceDetail:Pe,onClose:function(){ee(null)},"data-ouia-app-id":"controlPlane-streams",tokenEndPointUrl:n,notRequiredDrawerContentBackground:ie},i().createElement("main",{className:"pf-c-page__main"},i().createElement(f.PageSection,{variant:f.PageSectionVariants.light},i().createElement(f.Level,null,i().createElement(f.LevelItem,null,i().createElement(f.TextContent,null,i().createElement(f.Text,{component:"h1"},O("kafka_instances")))))),void 0===A?i().createElement(f.PageSection,{variant:f.PageSectionVariants.light,padding:{default:"noPadding"}},i().createElement(v.yR,null)):ie?i().createElement(f.PageSection,{padding:{default:"noPadding"},isFilled:!0},i().createElement(v.C0,{emptyStateProps:{variant:v.jU.NoItems},emptyStateBodyProps:{body:i().createElement(i().Fragment,null,i().createElement(o.Trans,{i18nKey:"create_a_kafka_instance_to_get_started",components:[i().createElement(f.Button,{variant:f.ButtonVariant.link,isSmall:!0,isInline:!0,key:"btn-quick-start",onClick:function(){return x.setActiveQuickStart&&x.setActiveQuickStart("getting-started")}})]}))},titleProps:{title:O("no_kafka_instances_yet")}},i().createElement(f.Button,{"data-testid":"emptyStateStreams-buttonCreateKafka",variant:f.ButtonVariant.primary,onClick:function(){return xe()}},O("create_kafka_instance"))),")"):A&&void 0!==ie?i().createElement(f.PageSection,{className:"mk--main-page__page-section--table pf-m-padding-on-xl",variant:f.PageSectionVariants.default,padding:{default:"noPadding"}},i().createElement(f.Card,null,i().createElement(M,{kafkaInstanceItems:A,mainToggle:I,onViewConnection:Ae,onViewInstance:Ne,refresh:Be,kafkaDataLoaded:q,setWaitingForDelete:be,onDelete:Ge,page:F,perPage:D,total:null==Z?void 0:Z.total,expectedTotal:ne,filteredValue:de,setFilteredValue:fe,setFilterSelected:se,filterSelected:ue,orderBy:Y,setOrderBy:J,isDrawerOpen:null!==$,loggedInUser:we,currentUserkafkas:Te,onCreate:Ke,handleCreateInstanceModal:xe}))):i().createElement(i().Fragment,null))),i().createElement(f.Modal,{variant:f.ModalVariant.small,title:"Mobile experience",isOpen:Ee,onClose:function(){return ye()},actions:[i().createElement(f.Button,{key:"confirm",variant:"primary",onClick:function(){return ye()}},"Ok")]},"The mobile experience isn't fully optimized yet, so some items might not appear correctly."))})}}]);
//# sourceMappingURL=5266.46614723.js.map